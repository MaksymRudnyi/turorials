{"ast":null,"code":"// TODO:\n//  * support 1 nested multipart level\n//    (see second multipart example here:\n//     http://www.w3.org/TR/html401/interact/forms.html#didx-multipartform-data)\n//  * support limits.fieldNameSize\n//     -- this will require modifications to utils.parseParams\nvar ReadableStream = require('stream').Readable || require('readable-stream'),\n    inherits = require('util').inherits;\n\nvar Dicer = require('dicer');\n\nvar parseParams = require('../utils').parseParams,\n    decodeText = require('../utils').decodeText,\n    basename = require('../utils').basename;\n\nvar RE_BOUNDARY = /^boundary$/i,\n    RE_FIELD = /^form-data$/i,\n    RE_CHARSET = /^charset$/i,\n    RE_FILENAME = /^filename$/i,\n    RE_NAME = /^name$/i;\nMultipart.detect = /^multipart\\/form-data/i;\n\nfunction Multipart(boy, cfg) {\n  if (!(this instanceof Multipart)) return new Multipart(boy, cfg);\n  var i,\n      len,\n      self = this,\n      boundary,\n      limits = cfg.limits,\n      parsedConType = cfg.parsedConType || [],\n      defCharset = cfg.defCharset || 'utf8',\n      preservePath = cfg.preservePath,\n      fileopts = typeof cfg.fileHwm === 'number' ? {\n    highWaterMark: cfg.fileHwm\n  } : {};\n\n  for (i = 0, len = parsedConType.length; i < len; ++i) {\n    if (Array.isArray(parsedConType[i]) && RE_BOUNDARY.test(parsedConType[i][0])) {\n      boundary = parsedConType[i][1];\n      break;\n    }\n  }\n\n  function checkFinished() {\n    if (nends === 0 && finished && !boy._done) {\n      finished = false;\n      process.nextTick(function () {\n        boy._done = true;\n        boy.emit('finish');\n      });\n    }\n  }\n\n  if (typeof boundary !== 'string') throw new Error('Multipart: Boundary not found');\n  var fieldSizeLimit = limits && typeof limits.fieldSize === 'number' ? limits.fieldSize : 1 * 1024 * 1024,\n      fileSizeLimit = limits && typeof limits.fileSize === 'number' ? limits.fileSize : Infinity,\n      filesLimit = limits && typeof limits.files === 'number' ? limits.files : Infinity,\n      fieldsLimit = limits && typeof limits.fields === 'number' ? limits.fields : Infinity,\n      partsLimit = limits && typeof limits.parts === 'number' ? limits.parts : Infinity;\n  var nfiles = 0,\n      nfields = 0,\n      nends = 0,\n      curFile,\n      curField,\n      finished = false;\n  this._needDrain = false;\n  this._pause = false;\n  this._cb = undefined;\n  this._nparts = 0;\n  this._boy = boy;\n  var parserCfg = {\n    boundary: boundary,\n    maxHeaderPairs: limits && limits.headerPairs\n  };\n  if (fileopts.highWaterMark) parserCfg.partHwm = fileopts.highWaterMark;\n  if (cfg.highWaterMark) parserCfg.highWaterMark = cfg.highWaterMark;\n  this.parser = new Dicer(parserCfg);\n  this.parser.on('drain', function () {\n    self._needDrain = false;\n\n    if (self._cb && !self._pause) {\n      var cb = self._cb;\n      self._cb = undefined;\n      cb();\n    }\n  }).on('part', function onPart(part) {\n    if (++self._nparts > partsLimit) {\n      self.parser.removeListener('part', onPart);\n      self.parser.on('part', skipPart);\n      boy.hitPartsLimit = true;\n      boy.emit('partsLimit');\n      return skipPart(part);\n    } // hack because streams2 _always_ doesn't emit 'end' until nextTick, so let\n    // us emit 'end' early since we know the part has ended if we are already\n    // seeing the next part\n\n\n    if (curField) {\n      var field = curField;\n      field.emit('end');\n      field.removeAllListeners('end');\n    }\n\n    part.on('header', function (header) {\n      var contype,\n          fieldname,\n          parsed,\n          charset,\n          encoding,\n          filename,\n          nsize = 0;\n\n      if (header['content-type']) {\n        parsed = parseParams(header['content-type'][0]);\n\n        if (parsed[0]) {\n          contype = parsed[0].toLowerCase();\n\n          for (i = 0, len = parsed.length; i < len; ++i) {\n            if (RE_CHARSET.test(parsed[i][0])) {\n              charset = parsed[i][1].toLowerCase();\n              break;\n            }\n          }\n        }\n      }\n\n      if (contype === undefined) contype = 'text/plain';\n      if (charset === undefined) charset = defCharset;\n\n      if (header['content-disposition']) {\n        parsed = parseParams(header['content-disposition'][0]);\n        if (!RE_FIELD.test(parsed[0])) return skipPart(part);\n\n        for (i = 0, len = parsed.length; i < len; ++i) {\n          if (RE_NAME.test(parsed[i][0])) {\n            fieldname = decodeText(parsed[i][1], 'binary', 'utf8');\n          } else if (RE_FILENAME.test(parsed[i][0])) {\n            filename = decodeText(parsed[i][1], 'binary', 'utf8');\n            if (!preservePath) filename = basename(filename);\n          }\n        }\n      } else return skipPart(part);\n\n      if (header['content-transfer-encoding']) encoding = header['content-transfer-encoding'][0].toLowerCase();else encoding = '7bit';\n      var onData, onEnd;\n\n      if (contype === 'application/octet-stream' || filename !== undefined) {\n        // file/binary field\n        if (nfiles === filesLimit) {\n          if (!boy.hitFilesLimit) {\n            boy.hitFilesLimit = true;\n            boy.emit('filesLimit');\n          }\n\n          return skipPart(part);\n        }\n\n        ++nfiles;\n\n        if (!boy._events.file) {\n          self.parser._ignore();\n\n          return;\n        }\n\n        ++nends;\n        var file = new FileStream(fileopts);\n        curFile = file;\n        file.on('end', function () {\n          --nends;\n          checkFinished();\n\n          if (self._cb && !self._needDrain) {\n            var cb = self._cb;\n            self._cb = undefined;\n            cb();\n          }\n        });\n\n        file._read = function (n) {\n          if (!self._pause) return;\n          self._pause = false;\n\n          if (self._cb && !self._needDrain) {\n            var cb = self._cb;\n            self._cb = undefined;\n            cb();\n          }\n        };\n\n        boy.emit('file', fieldname, file, filename, encoding, contype);\n\n        onData = function (data) {\n          if ((nsize += data.length) > fileSizeLimit) {\n            var extralen = fileSizeLimit - (nsize - data.length);\n            if (extralen > 0) file.push(data.slice(0, extralen));\n            file.emit('limit');\n            file.truncated = true;\n            part.removeAllListeners('data');\n          } else if (!file.push(data)) self._pause = true;\n        };\n\n        onEnd = function () {\n          curFile = undefined;\n          file.push(null);\n        };\n      } else {\n        // non-file field\n        if (nfields === fieldsLimit) {\n          if (!boy.hitFieldsLimit) {\n            boy.hitFieldsLimit = true;\n            boy.emit('fieldsLimit');\n          }\n\n          return skipPart(part);\n        }\n\n        ++nfields;\n        ++nends;\n        var buffer = '',\n            truncated = false;\n        curField = part;\n\n        onData = function (data) {\n          if ((nsize += data.length) > fieldSizeLimit) {\n            var extralen = fieldSizeLimit - (nsize - data.length);\n            buffer += data.toString('binary', 0, extralen);\n            truncated = true;\n            part.removeAllListeners('data');\n          } else buffer += data.toString('binary');\n        };\n\n        onEnd = function () {\n          curField = undefined;\n          if (buffer.length) buffer = decodeText(buffer, 'binary', charset);\n          boy.emit('field', fieldname, buffer, false, truncated, encoding, contype);\n          --nends;\n          checkFinished();\n        };\n      }\n      /* As of node@2efe4ab761666 (v0.10.29+/v0.11.14+), busboy had become\n         broken. Streams2/streams3 is a huge black box of confusion, but\n         somehow overriding the sync state seems to fix things again (and still\n         seems to work for previous node versions).\n      */\n\n\n      part._readableState.sync = false;\n      part.on('data', onData);\n      part.on('end', onEnd);\n    }).on('error', function (err) {\n      if (curFile) curFile.emit('error', err);\n    });\n  }).on('error', function (err) {\n    boy.emit('error', err);\n  }).on('finish', function () {\n    finished = true;\n    checkFinished();\n  });\n}\n\nMultipart.prototype.write = function (chunk, cb) {\n  var r;\n  if ((r = this.parser.write(chunk)) && !this._pause) cb();else {\n    this._needDrain = !r;\n    this._cb = cb;\n  }\n};\n\nMultipart.prototype.end = function () {\n  var self = this;\n\n  if (this._nparts === 0 && !self._boy._done) {\n    process.nextTick(function () {\n      self._boy._done = true;\n\n      self._boy.emit('finish');\n    });\n  } else if (this.parser.writable) this.parser.end();\n};\n\nfunction skipPart(part) {\n  part.resume();\n}\n\nfunction FileStream(opts) {\n  if (!(this instanceof FileStream)) return new FileStream(opts);\n  ReadableStream.call(this, opts);\n  this.truncated = false;\n}\n\ninherits(FileStream, ReadableStream);\n\nFileStream.prototype._read = function (n) {};\n\nmodule.exports = Multipart;","map":{"version":3,"names":["ReadableStream","require","Readable","inherits","Dicer","parseParams","decodeText","basename","RE_BOUNDARY","RE_FIELD","RE_CHARSET","RE_FILENAME","RE_NAME","Multipart","detect","boy","cfg","i","len","self","boundary","limits","parsedConType","defCharset","preservePath","fileopts","fileHwm","highWaterMark","length","Array","isArray","test","checkFinished","nends","finished","_done","process","nextTick","emit","Error","fieldSizeLimit","fieldSize","fileSizeLimit","fileSize","Infinity","filesLimit","files","fieldsLimit","fields","partsLimit","parts","nfiles","nfields","curFile","curField","_needDrain","_pause","_cb","undefined","_nparts","_boy","parserCfg","maxHeaderPairs","headerPairs","partHwm","parser","on","cb","onPart","part","removeListener","skipPart","hitPartsLimit","field","removeAllListeners","header","contype","fieldname","parsed","charset","encoding","filename","nsize","toLowerCase","onData","onEnd","hitFilesLimit","_events","file","_ignore","FileStream","_read","n","data","extralen","push","slice","truncated","hitFieldsLimit","buffer","toString","_readableState","sync","err","prototype","write","chunk","r","end","writable","resume","opts","call","module","exports"],"sources":["C:/Users/apinto2/Desktop/teswordtomd/12 setembro/UPLOAD 9/turorials/server/node_modules/busboy/lib/types/multipart.js"],"sourcesContent":["// TODO:\n//  * support 1 nested multipart level\n//    (see second multipart example here:\n//     http://www.w3.org/TR/html401/interact/forms.html#didx-multipartform-data)\n//  * support limits.fieldNameSize\n//     -- this will require modifications to utils.parseParams\n\nvar ReadableStream = require('stream').Readable || require('readable-stream'),\n    inherits = require('util').inherits;\n\nvar Dicer = require('dicer');\n\nvar parseParams = require('../utils').parseParams,\n    decodeText = require('../utils').decodeText,\n    basename = require('../utils').basename;\n\nvar RE_BOUNDARY = /^boundary$/i,\n    RE_FIELD = /^form-data$/i,\n    RE_CHARSET = /^charset$/i,\n    RE_FILENAME = /^filename$/i,\n    RE_NAME = /^name$/i;\n\nMultipart.detect = /^multipart\\/form-data/i;\nfunction Multipart(boy, cfg) {\n  if (!(this instanceof Multipart))\n    return new Multipart(boy, cfg);\n  var i,\n      len,\n      self = this,\n      boundary,\n      limits = cfg.limits,\n      parsedConType = cfg.parsedConType || [],\n      defCharset = cfg.defCharset || 'utf8',\n      preservePath = cfg.preservePath,\n      fileopts = (typeof cfg.fileHwm === 'number'\n                  ? { highWaterMark: cfg.fileHwm }\n                  : {});\n\n  for (i = 0, len = parsedConType.length; i < len; ++i) {\n    if (Array.isArray(parsedConType[i])\n        && RE_BOUNDARY.test(parsedConType[i][0])) {\n      boundary = parsedConType[i][1];\n      break;\n    }\n  }\n\n  function checkFinished() {\n    if (nends === 0 && finished && !boy._done) {\n      finished = false;\n      process.nextTick(function() {\n        boy._done = true;\n        boy.emit('finish');\n      });\n    }\n  }\n\n  if (typeof boundary !== 'string')\n    throw new Error('Multipart: Boundary not found');\n\n  var fieldSizeLimit = (limits && typeof limits.fieldSize === 'number'\n                        ? limits.fieldSize\n                        : 1 * 1024 * 1024),\n      fileSizeLimit = (limits && typeof limits.fileSize === 'number'\n                       ? limits.fileSize\n                       : Infinity),\n      filesLimit = (limits && typeof limits.files === 'number'\n                    ? limits.files\n                    : Infinity),\n      fieldsLimit = (limits && typeof limits.fields === 'number'\n                     ? limits.fields\n                     : Infinity),\n      partsLimit = (limits && typeof limits.parts === 'number'\n                    ? limits.parts\n                    : Infinity);\n\n  var nfiles = 0,\n      nfields = 0,\n      nends = 0,\n      curFile,\n      curField,\n      finished = false;\n\n  this._needDrain = false;\n  this._pause = false;\n  this._cb = undefined;\n  this._nparts = 0;\n  this._boy = boy;\n\n  var parserCfg = {\n    boundary: boundary,\n    maxHeaderPairs: (limits && limits.headerPairs)\n  };\n  if (fileopts.highWaterMark)\n    parserCfg.partHwm = fileopts.highWaterMark;\n  if (cfg.highWaterMark)\n    parserCfg.highWaterMark = cfg.highWaterMark;\n\n  this.parser = new Dicer(parserCfg);\n  this.parser.on('drain', function() {\n    self._needDrain = false;\n    if (self._cb && !self._pause) {\n      var cb = self._cb;\n      self._cb = undefined;\n      cb();\n    }\n  }).on('part', function onPart(part) {\n    if (++self._nparts > partsLimit) {\n      self.parser.removeListener('part', onPart);\n      self.parser.on('part', skipPart);\n      boy.hitPartsLimit = true;\n      boy.emit('partsLimit');\n      return skipPart(part);\n    }\n\n    // hack because streams2 _always_ doesn't emit 'end' until nextTick, so let\n    // us emit 'end' early since we know the part has ended if we are already\n    // seeing the next part\n    if (curField) {\n      var field = curField;\n      field.emit('end');\n      field.removeAllListeners('end');\n    }\n\n    part.on('header', function(header) {\n      var contype,\n          fieldname,\n          parsed,\n          charset,\n          encoding,\n          filename,\n          nsize = 0;\n\n      if (header['content-type']) {\n        parsed = parseParams(header['content-type'][0]);\n        if (parsed[0]) {\n          contype = parsed[0].toLowerCase();\n          for (i = 0, len = parsed.length; i < len; ++i) {\n            if (RE_CHARSET.test(parsed[i][0])) {\n              charset = parsed[i][1].toLowerCase();\n              break;\n            }\n          }\n        }\n      }\n\n      if (contype === undefined)\n        contype = 'text/plain';\n      if (charset === undefined)\n        charset = defCharset;\n\n      if (header['content-disposition']) {\n        parsed = parseParams(header['content-disposition'][0]);\n        if (!RE_FIELD.test(parsed[0]))\n          return skipPart(part);\n        for (i = 0, len = parsed.length; i < len; ++i) {\n          if (RE_NAME.test(parsed[i][0])) {\n            fieldname = decodeText(parsed[i][1], 'binary', 'utf8');\n          } else if (RE_FILENAME.test(parsed[i][0])) {\n            filename = decodeText(parsed[i][1], 'binary', 'utf8');\n            if (!preservePath)\n              filename = basename(filename);\n          }\n        }\n      } else\n        return skipPart(part);\n\n      if (header['content-transfer-encoding'])\n        encoding = header['content-transfer-encoding'][0].toLowerCase();\n      else\n        encoding = '7bit';\n\n      var onData,\n          onEnd;\n      if (contype === 'application/octet-stream' || filename !== undefined) {\n        // file/binary field\n        if (nfiles === filesLimit) {\n          if (!boy.hitFilesLimit) {\n            boy.hitFilesLimit = true;\n            boy.emit('filesLimit');\n          }\n          return skipPart(part);\n        }\n\n        ++nfiles;\n\n        if (!boy._events.file) {\n          self.parser._ignore();\n          return;\n        }\n\n        ++nends;\n        var file = new FileStream(fileopts);\n        curFile = file;\n        file.on('end', function() {\n          --nends;\n          checkFinished();\n          if (self._cb && !self._needDrain) {\n            var cb = self._cb;\n            self._cb = undefined;\n            cb();\n          }\n        });\n        file._read = function(n) {\n          if (!self._pause)\n            return;\n          self._pause = false;\n          if (self._cb && !self._needDrain) {\n            var cb = self._cb;\n            self._cb = undefined;\n            cb();\n          }\n        };\n        boy.emit('file', fieldname, file, filename, encoding, contype);\n\n        onData = function(data) {\n          if ((nsize += data.length) > fileSizeLimit) {\n            var extralen = (fileSizeLimit - (nsize - data.length));\n            if (extralen > 0)\n              file.push(data.slice(0, extralen));\n            file.emit('limit');\n            file.truncated = true;\n            part.removeAllListeners('data');\n          } else if (!file.push(data))\n            self._pause = true;\n        };\n\n        onEnd = function() {\n          curFile = undefined;\n          file.push(null);\n        };\n      } else {\n        // non-file field\n        if (nfields === fieldsLimit) {\n          if (!boy.hitFieldsLimit) {\n            boy.hitFieldsLimit = true;\n            boy.emit('fieldsLimit');\n          }\n          return skipPart(part);\n        }\n\n        ++nfields;\n        ++nends;\n        var buffer = '',\n            truncated = false;\n        curField = part;\n\n        onData = function(data) {\n          if ((nsize += data.length) > fieldSizeLimit) {\n            var extralen = (fieldSizeLimit - (nsize - data.length));\n            buffer += data.toString('binary', 0, extralen);\n            truncated = true;\n            part.removeAllListeners('data');\n          } else\n            buffer += data.toString('binary');\n        };\n\n        onEnd = function() {\n          curField = undefined;\n          if (buffer.length)\n            buffer = decodeText(buffer, 'binary', charset);\n          boy.emit('field', fieldname, buffer, false, truncated, encoding, contype);\n          --nends;\n          checkFinished();\n        };\n      }\n\n      /* As of node@2efe4ab761666 (v0.10.29+/v0.11.14+), busboy had become\n         broken. Streams2/streams3 is a huge black box of confusion, but\n         somehow overriding the sync state seems to fix things again (and still\n         seems to work for previous node versions).\n      */\n      part._readableState.sync = false;\n\n      part.on('data', onData);\n      part.on('end', onEnd);\n    }).on('error', function(err) {\n      if (curFile)\n        curFile.emit('error', err);\n    });\n  }).on('error', function(err) {\n    boy.emit('error', err);\n  }).on('finish', function() {\n    finished = true;\n    checkFinished();\n  });\n}\n\nMultipart.prototype.write = function(chunk, cb) {\n  var r;\n  if ((r = this.parser.write(chunk)) && !this._pause)\n    cb();\n  else {\n    this._needDrain = !r;\n    this._cb = cb;\n  }\n};\n\nMultipart.prototype.end = function() {\n  var self = this;\n  if (this._nparts === 0 && !self._boy._done) {\n    process.nextTick(function() {\n      self._boy._done = true;\n      self._boy.emit('finish');\n    });\n  } else if (this.parser.writable)\n    this.parser.end();\n};\n\nfunction skipPart(part) {\n  part.resume();\n}\n\nfunction FileStream(opts) {\n  if (!(this instanceof FileStream))\n    return new FileStream(opts);\n  ReadableStream.call(this, opts);\n\n  this.truncated = false;\n}\ninherits(FileStream, ReadableStream);\n\nFileStream.prototype._read = function(n) {};\n\nmodule.exports = Multipart;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}