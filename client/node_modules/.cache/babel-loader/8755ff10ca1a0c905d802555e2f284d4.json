{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/objectWithoutPropertiesLoose\";\nvar _excluded = [\"prefixCls\", \"className\", \"source\", \"style\", \"disableCopy\", \"onScroll\", \"onMouseOver\", \"pluginsFilter\", \"rehypeRewrite\", \"warpperElement\"];\nimport React, { useImperativeHandle } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport gfm from 'remark-gfm';\nimport slug from 'rehype-slug';\nimport headings from 'rehype-autolink-headings';\nimport rehypeRaw from 'rehype-raw';\nimport rehypeAttrs from 'rehype-attr';\nimport rehypeIgnore from 'rehype-ignore';\nimport rehypePrism from 'rehype-prism-plus';\nimport rehypeRewrite, { getCodeString } from 'rehype-rewrite';\nimport { octiconLink } from './nodes/octiconLink';\nimport { copyElement } from './nodes/copy';\nimport \"./styles/markdown.css\";\nimport { reservedMeta } from './plugins/reservedMeta';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default /*#__PURE__*/React.forwardRef((props, ref) => {\n  var {\n    prefixCls = 'wmde-markdown wmde-markdown-color',\n    className,\n    source,\n    style,\n    disableCopy = false,\n    onScroll,\n    onMouseOver,\n    pluginsFilter,\n    rehypeRewrite: rewrite,\n    warpperElement = {}\n  } = props,\n      other = _objectWithoutPropertiesLoose(props, _excluded);\n\n  var mdp = /*#__PURE__*/React.createRef();\n  useImperativeHandle(ref, () => _extends({}, props, {\n    mdp\n  }), [mdp, props]);\n  var cls = (prefixCls || '') + \" \" + (className || '');\n\n  var rehypeRewriteHandle = (node, index, parent) => {\n    if (node.type === 'element' && parent && parent.type === 'root' && /h(1|2|3|4|5|6)/.test(node.tagName)) {\n      var child = node.children && node.children[0];\n\n      if (child && child.properties && child.properties.ariaHidden === 'true') {\n        child.properties = _extends({\n          class: 'anchor'\n        }, child.properties);\n        child.children = [octiconLink];\n      }\n    }\n\n    if (node.type === 'element' && node.tagName === 'pre' && !disableCopy) {\n      var code = getCodeString(node.children);\n      node.children.push(copyElement(code));\n    }\n\n    rewrite && rewrite(node, index, parent);\n  };\n\n  var rehypePlugins = [reservedMeta, [rehypePrism, {\n    ignoreMissing: true\n  }], rehypeRaw, slug, headings, rehypeIgnore, [rehypeRewrite, {\n    rewrite: rehypeRewriteHandle\n  }], [rehypeAttrs, {\n    properties: 'attr'\n  }], ...(other.rehypePlugins || [])];\n  var customProps = {\n    allowElement: (element, index, parent) => {\n      if (other.allowElement) {\n        return other.allowElement(element, index, parent);\n      }\n\n      return /^[A-Za-z0-9]+$/.test(element.tagName);\n    }\n  };\n  var remarkPlugins = [...(other.remarkPlugins || []), gfm];\n  return /*#__PURE__*/_jsx(\"div\", _extends({\n    ref: mdp,\n    onScroll: onScroll,\n    onMouseOver: onMouseOver\n  }, warpperElement, {\n    className: cls,\n    style: style,\n    children: /*#__PURE__*/_jsx(ReactMarkdown, _extends({}, other, customProps, {\n      rehypePlugins: pluginsFilter ? pluginsFilter('rehype', rehypePlugins) : rehypePlugins,\n      remarkPlugins: pluginsFilter ? pluginsFilter('remark', remarkPlugins) : remarkPlugins,\n      children: source || ''\n    }))\n  }));\n});","map":{"version":3,"sources":["../src/index.tsx"],"names":["prefixCls","disableCopy","rehypeRewrite","warpperElement","other","mdp","React","useImperativeHandle","cls","className","rehypeRewriteHandle","node","parent","child","class","code","getCodeString","copyElement","rewrite","rehypePlugins","ignoreMissing","properties","customProps","allowElement","element","remarkPlugins","onMouseOver","pluginsFilter","source"],"mappings":"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","sourcesContent":["import React, { useImperativeHandle } from 'react';\nimport ReactMarkdown, { Options } from 'react-markdown';\nimport { Element } from 'hast';\nimport { PluggableList } from 'unified';\nimport gfm from 'remark-gfm';\nimport slug from 'rehype-slug';\nimport headings from 'rehype-autolink-headings';\nimport rehypeRaw from 'rehype-raw';\nimport rehypeAttrs from 'rehype-attr';\nimport rehypeIgnore from 'rehype-ignore';\nimport rehypePrism from 'rehype-prism-plus';\nimport rehypeRewrite, { getCodeString, RehypeRewriteOptions } from 'rehype-rewrite';\nimport { octiconLink } from './nodes/octiconLink';\nimport { copyElement } from './nodes/copy';\nimport './styles/markdown.less';\n\nimport { reservedMeta } from './plugins/reservedMeta';\n\nexport interface MarkdownPreviewProps extends Omit<Options, 'children'> {\n  prefixCls?: string;\n  className?: string;\n  source?: string;\n  disableCopy?: boolean;\n  style?: React.CSSProperties;\n  pluginsFilter?: (type: 'rehype' | 'remark', plugin: PluggableList) => PluggableList;\n  warpperElement?: React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement> & {\n    'data-color-mode'?: 'light' | 'dark';\n  };\n  onScroll?: (e: React.UIEvent<HTMLDivElement>) => void;\n  onMouseOver?: (e: React.MouseEvent<HTMLDivElement>) => void;\n  rehypeRewrite?: RehypeRewriteOptions['rewrite'];\n}\n\nexport interface MarkdownPreviewRef extends MarkdownPreviewProps {\n  mdp: React.RefObject<HTMLDivElement>;\n}\n\nexport default React.forwardRef<MarkdownPreviewRef, MarkdownPreviewProps>((props, ref) => {\n  const {\n    prefixCls = 'wmde-markdown wmde-markdown-color',\n    className,\n    source,\n    style,\n    disableCopy = false,\n    onScroll,\n    onMouseOver,\n    pluginsFilter,\n    rehypeRewrite: rewrite,\n    warpperElement = {},\n    ...other\n  } = props;\n  const mdp = React.createRef<HTMLDivElement>();\n  useImperativeHandle(ref, () => ({ ...props, mdp }), [mdp, props]);\n  const cls = `${prefixCls || ''} ${className || ''}`;\n\n  const rehypeRewriteHandle: RehypeRewriteOptions['rewrite'] = (node, index, parent) => {\n    if (node.type === 'element' && parent && parent.type === 'root' && /h(1|2|3|4|5|6)/.test(node.tagName)) {\n      const child = node.children && (node.children[0] as Element);\n      if (child && child.properties && child.properties.ariaHidden === 'true') {\n        child.properties = { class: 'anchor', ...child.properties };\n        child.children = [octiconLink];\n      }\n    }\n    if (node.type === 'element' && node.tagName === 'pre' && !disableCopy) {\n      const code = getCodeString(node.children);\n      node.children.push(copyElement(code));\n    }\n    rewrite && rewrite(node, index, parent);\n  };\n\n  const rehypePlugins: PluggableList = [\n    reservedMeta,\n    [rehypePrism, { ignoreMissing: true }],\n    rehypeRaw,\n    slug,\n    headings,\n    rehypeIgnore,\n    [rehypeRewrite, { rewrite: rehypeRewriteHandle }],\n    [rehypeAttrs, { properties: 'attr' }],\n    ...(other.rehypePlugins || []),\n  ];\n  const customProps: MarkdownPreviewProps = {\n    allowElement: (element, index, parent) => {\n      if (other.allowElement) {\n        return other.allowElement(element, index, parent);\n      }\n      return /^[A-Za-z0-9]+$/.test(element.tagName);\n    },\n  };\n  const remarkPlugins = [...(other.remarkPlugins || []), gfm];\n  return (\n    <div ref={mdp} onScroll={onScroll} onMouseOver={onMouseOver} {...warpperElement} className={cls} style={style}>\n      <ReactMarkdown\n        {...other}\n        {...customProps}\n        rehypePlugins={pluginsFilter ? pluginsFilter('rehype', rehypePlugins) : rehypePlugins}\n        remarkPlugins={pluginsFilter ? pluginsFilter('remark', remarkPlugins) : remarkPlugins}\n        children={source || ''}\n      />\n    </div>\n  );\n});\n"]},"metadata":{},"sourceType":"module"}