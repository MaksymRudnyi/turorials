{"ast":null,"code":"var fs = require('fs');\n\nvar os = require('os');\n\nvar path = require('path');\n\nvar crypto = require('crypto');\n\nvar mkdirp = require('mkdirp');\n\nfunction getFilename(req, file, cb) {\n  crypto.pseudoRandomBytes(16, function (err, raw) {\n    cb(err, err ? undefined : raw.toString('hex'));\n  });\n}\n\nfunction getDestination(req, file, cb) {\n  cb(null, os.tmpdir());\n}\n\nfunction DiskStorage(opts) {\n  this.getFilename = opts.filename || getFilename;\n\n  if (typeof opts.destination === 'string') {\n    mkdirp.sync(opts.destination);\n\n    this.getDestination = function ($0, $1, cb) {\n      cb(null, opts.destination);\n    };\n  } else {\n    this.getDestination = opts.destination || getDestination;\n  }\n}\n\nDiskStorage.prototype._handleFile = function _handleFile(req, file, cb) {\n  var that = this;\n  that.getDestination(req, file, function (err, destination) {\n    if (err) return cb(err);\n    that.getFilename(req, file, function (err, filename) {\n      if (err) return cb(err);\n      var finalPath = path.join(destination, filename);\n      var outStream = fs.createWriteStream(finalPath);\n      file.stream.pipe(outStream);\n      outStream.on('error', cb);\n      outStream.on('finish', function () {\n        cb(null, {\n          destination: destination,\n          filename: filename,\n          path: finalPath,\n          size: outStream.bytesWritten\n        });\n      });\n    });\n  });\n};\n\nDiskStorage.prototype._removeFile = function _removeFile(req, file, cb) {\n  var path = file.path;\n  delete file.destination;\n  delete file.filename;\n  delete file.path;\n  fs.unlink(path, cb);\n};\n\nmodule.exports = function (opts) {\n  return new DiskStorage(opts);\n};","map":{"version":3,"names":["fs","require","os","path","crypto","mkdirp","getFilename","req","file","cb","pseudoRandomBytes","err","raw","undefined","toString","getDestination","tmpdir","DiskStorage","opts","filename","destination","sync","$0","$1","prototype","_handleFile","that","finalPath","join","outStream","createWriteStream","stream","pipe","on","size","bytesWritten","_removeFile","unlink","module","exports"],"sources":["C:/Users/apinto2/Desktop/teswordtomd/12 setembro/UPLOAD 9/turorials/server/node_modules/multer/storage/disk.js"],"sourcesContent":["var fs = require('fs')\nvar os = require('os')\nvar path = require('path')\nvar crypto = require('crypto')\nvar mkdirp = require('mkdirp')\n\nfunction getFilename (req, file, cb) {\n  crypto.pseudoRandomBytes(16, function (err, raw) {\n    cb(err, err ? undefined : raw.toString('hex'))\n  })\n}\n\nfunction getDestination (req, file, cb) {\n  cb(null, os.tmpdir())\n}\n\nfunction DiskStorage (opts) {\n  this.getFilename = (opts.filename || getFilename)\n\n  if (typeof opts.destination === 'string') {\n    mkdirp.sync(opts.destination)\n    this.getDestination = function ($0, $1, cb) { cb(null, opts.destination) }\n  } else {\n    this.getDestination = (opts.destination || getDestination)\n  }\n}\n\nDiskStorage.prototype._handleFile = function _handleFile (req, file, cb) {\n  var that = this\n\n  that.getDestination(req, file, function (err, destination) {\n    if (err) return cb(err)\n\n    that.getFilename(req, file, function (err, filename) {\n      if (err) return cb(err)\n\n      var finalPath = path.join(destination, filename)\n      var outStream = fs.createWriteStream(finalPath)\n\n      file.stream.pipe(outStream)\n      outStream.on('error', cb)\n      outStream.on('finish', function () {\n        cb(null, {\n          destination: destination,\n          filename: filename,\n          path: finalPath,\n          size: outStream.bytesWritten\n        })\n      })\n    })\n  })\n}\n\nDiskStorage.prototype._removeFile = function _removeFile (req, file, cb) {\n  var path = file.path\n\n  delete file.destination\n  delete file.filename\n  delete file.path\n\n  fs.unlink(path, cb)\n}\n\nmodule.exports = function (opts) {\n  return new DiskStorage(opts)\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}