{"ast":null,"code":"'use strict';\n\nconst Tokenizer = require('../tokenizer');\n\nconst OpenElementStack = require('./open-element-stack');\n\nconst FormattingElementList = require('./formatting-element-list');\n\nconst LocationInfoParserMixin = require('../extensions/location-info/parser-mixin');\n\nconst ErrorReportingParserMixin = require('../extensions/error-reporting/parser-mixin');\n\nconst Mixin = require('../utils/mixin');\n\nconst defaultTreeAdapter = require('../tree-adapters/default');\n\nconst mergeOptions = require('../utils/merge-options');\n\nconst doctype = require('../common/doctype');\n\nconst foreignContent = require('../common/foreign-content');\n\nconst ERR = require('../common/error-codes');\n\nconst unicode = require('../common/unicode');\n\nconst HTML = require('../common/html'); //Aliases\n\n\nconst $ = HTML.TAG_NAMES;\nconst NS = HTML.NAMESPACES;\nconst ATTRS = HTML.ATTRS;\nconst DEFAULT_OPTIONS = {\n  scriptingEnabled: true,\n  sourceCodeLocationInfo: false,\n  onParseError: null,\n  treeAdapter: defaultTreeAdapter\n}; //Misc constants\n\nconst HIDDEN_INPUT_TYPE = 'hidden'; //Adoption agency loops iteration count\n\nconst AA_OUTER_LOOP_ITER = 8;\nconst AA_INNER_LOOP_ITER = 3; //Insertion modes\n\nconst INITIAL_MODE = 'INITIAL_MODE';\nconst BEFORE_HTML_MODE = 'BEFORE_HTML_MODE';\nconst BEFORE_HEAD_MODE = 'BEFORE_HEAD_MODE';\nconst IN_HEAD_MODE = 'IN_HEAD_MODE';\nconst IN_HEAD_NO_SCRIPT_MODE = 'IN_HEAD_NO_SCRIPT_MODE';\nconst AFTER_HEAD_MODE = 'AFTER_HEAD_MODE';\nconst IN_BODY_MODE = 'IN_BODY_MODE';\nconst TEXT_MODE = 'TEXT_MODE';\nconst IN_TABLE_MODE = 'IN_TABLE_MODE';\nconst IN_TABLE_TEXT_MODE = 'IN_TABLE_TEXT_MODE';\nconst IN_CAPTION_MODE = 'IN_CAPTION_MODE';\nconst IN_COLUMN_GROUP_MODE = 'IN_COLUMN_GROUP_MODE';\nconst IN_TABLE_BODY_MODE = 'IN_TABLE_BODY_MODE';\nconst IN_ROW_MODE = 'IN_ROW_MODE';\nconst IN_CELL_MODE = 'IN_CELL_MODE';\nconst IN_SELECT_MODE = 'IN_SELECT_MODE';\nconst IN_SELECT_IN_TABLE_MODE = 'IN_SELECT_IN_TABLE_MODE';\nconst IN_TEMPLATE_MODE = 'IN_TEMPLATE_MODE';\nconst AFTER_BODY_MODE = 'AFTER_BODY_MODE';\nconst IN_FRAMESET_MODE = 'IN_FRAMESET_MODE';\nconst AFTER_FRAMESET_MODE = 'AFTER_FRAMESET_MODE';\nconst AFTER_AFTER_BODY_MODE = 'AFTER_AFTER_BODY_MODE';\nconst AFTER_AFTER_FRAMESET_MODE = 'AFTER_AFTER_FRAMESET_MODE'; //Insertion mode reset map\n\nconst INSERTION_MODE_RESET_MAP = {\n  [$.TR]: IN_ROW_MODE,\n  [$.TBODY]: IN_TABLE_BODY_MODE,\n  [$.THEAD]: IN_TABLE_BODY_MODE,\n  [$.TFOOT]: IN_TABLE_BODY_MODE,\n  [$.CAPTION]: IN_CAPTION_MODE,\n  [$.COLGROUP]: IN_COLUMN_GROUP_MODE,\n  [$.TABLE]: IN_TABLE_MODE,\n  [$.BODY]: IN_BODY_MODE,\n  [$.FRAMESET]: IN_FRAMESET_MODE\n}; //Template insertion mode switch map\n\nconst TEMPLATE_INSERTION_MODE_SWITCH_MAP = {\n  [$.CAPTION]: IN_TABLE_MODE,\n  [$.COLGROUP]: IN_TABLE_MODE,\n  [$.TBODY]: IN_TABLE_MODE,\n  [$.TFOOT]: IN_TABLE_MODE,\n  [$.THEAD]: IN_TABLE_MODE,\n  [$.COL]: IN_COLUMN_GROUP_MODE,\n  [$.TR]: IN_TABLE_BODY_MODE,\n  [$.TD]: IN_ROW_MODE,\n  [$.TH]: IN_ROW_MODE\n}; //Token handlers map for insertion modes\n\nconst TOKEN_HANDLERS = {\n  [INITIAL_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInInitialMode,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInInitialMode,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: doctypeInInitialMode,\n    [Tokenizer.START_TAG_TOKEN]: tokenInInitialMode,\n    [Tokenizer.END_TAG_TOKEN]: tokenInInitialMode,\n    [Tokenizer.EOF_TOKEN]: tokenInInitialMode\n  },\n  [BEFORE_HTML_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHtml,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHtml,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagBeforeHtml,\n    [Tokenizer.END_TAG_TOKEN]: endTagBeforeHtml,\n    [Tokenizer.EOF_TOKEN]: tokenBeforeHtml\n  },\n  [BEFORE_HEAD_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHead,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHead,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagBeforeHead,\n    [Tokenizer.END_TAG_TOKEN]: endTagBeforeHead,\n    [Tokenizer.EOF_TOKEN]: tokenBeforeHead\n  },\n  [IN_HEAD_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInHead,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHead,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagInHead,\n    [Tokenizer.END_TAG_TOKEN]: endTagInHead,\n    [Tokenizer.EOF_TOKEN]: tokenInHead\n  },\n  [IN_HEAD_NO_SCRIPT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInHeadNoScript,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHeadNoScript,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagInHeadNoScript,\n    [Tokenizer.END_TAG_TOKEN]: endTagInHeadNoScript,\n    [Tokenizer.EOF_TOKEN]: tokenInHeadNoScript\n  },\n  [AFTER_HEAD_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenAfterHead,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterHead,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterHead,\n    [Tokenizer.END_TAG_TOKEN]: endTagAfterHead,\n    [Tokenizer.EOF_TOKEN]: tokenAfterHead\n  },\n  [IN_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInBody,\n    [Tokenizer.END_TAG_TOKEN]: endTagInBody,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [TEXT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: ignoreToken,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: ignoreToken,\n    [Tokenizer.END_TAG_TOKEN]: endTagInText,\n    [Tokenizer.EOF_TOKEN]: eofInText\n  },\n  [IN_TABLE_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInTable,\n    [Tokenizer.END_TAG_TOKEN]: endTagInTable,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_TABLE_TEXT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTableText,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInTableText,\n    [Tokenizer.COMMENT_TOKEN]: tokenInTableText,\n    [Tokenizer.DOCTYPE_TOKEN]: tokenInTableText,\n    [Tokenizer.START_TAG_TOKEN]: tokenInTableText,\n    [Tokenizer.END_TAG_TOKEN]: tokenInTableText,\n    [Tokenizer.EOF_TOKEN]: tokenInTableText\n  },\n  [IN_CAPTION_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInCaption,\n    [Tokenizer.END_TAG_TOKEN]: endTagInCaption,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_COLUMN_GROUP_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenInColumnGroup,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInColumnGroup,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInColumnGroup,\n    [Tokenizer.END_TAG_TOKEN]: endTagInColumnGroup,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_TABLE_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInTableBody,\n    [Tokenizer.END_TAG_TOKEN]: endTagInTableBody,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_ROW_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInRow,\n    [Tokenizer.END_TAG_TOKEN]: endTagInRow,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_CELL_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInCell,\n    [Tokenizer.END_TAG_TOKEN]: endTagInCell,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_SELECT_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInSelect,\n    [Tokenizer.END_TAG_TOKEN]: endTagInSelect,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_SELECT_IN_TABLE_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInSelectInTable,\n    [Tokenizer.END_TAG_TOKEN]: endTagInSelectInTable,\n    [Tokenizer.EOF_TOKEN]: eofInBody\n  },\n  [IN_TEMPLATE_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInTemplate,\n    [Tokenizer.END_TAG_TOKEN]: endTagInTemplate,\n    [Tokenizer.EOF_TOKEN]: eofInTemplate\n  },\n  [AFTER_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenAfterBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterBody,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendCommentToRootHtmlElement,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterBody,\n    [Tokenizer.END_TAG_TOKEN]: endTagAfterBody,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [IN_FRAMESET_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagInFrameset,\n    [Tokenizer.END_TAG_TOKEN]: endTagInFrameset,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [AFTER_FRAMESET_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n    [Tokenizer.COMMENT_TOKEN]: appendComment,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterFrameset,\n    [Tokenizer.END_TAG_TOKEN]: endTagAfterFrameset,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [AFTER_AFTER_BODY_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: tokenAfterAfterBody,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterAfterBody,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterBody,\n    [Tokenizer.END_TAG_TOKEN]: tokenAfterAfterBody,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  },\n  [AFTER_AFTER_FRAMESET_MODE]: {\n    [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n    [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n    [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n    [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n    [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterFrameset,\n    [Tokenizer.END_TAG_TOKEN]: ignoreToken,\n    [Tokenizer.EOF_TOKEN]: stopParsing\n  }\n}; //Parser\n\nclass Parser {\n  constructor(options) {\n    this.options = mergeOptions(DEFAULT_OPTIONS, options);\n    this.treeAdapter = this.options.treeAdapter;\n    this.pendingScript = null;\n\n    if (this.options.sourceCodeLocationInfo) {\n      Mixin.install(this, LocationInfoParserMixin);\n    }\n\n    if (this.options.onParseError) {\n      Mixin.install(this, ErrorReportingParserMixin, {\n        onParseError: this.options.onParseError\n      });\n    }\n  } // API\n\n\n  parse(html) {\n    const document = this.treeAdapter.createDocument();\n\n    this._bootstrap(document, null);\n\n    this.tokenizer.write(html, true);\n\n    this._runParsingLoop(null);\n\n    return document;\n  }\n\n  parseFragment(html, fragmentContext) {\n    //NOTE: use <template> element as a fragment context if context element was not provided,\n    //so we will parse in \"forgiving\" manner\n    if (!fragmentContext) {\n      fragmentContext = this.treeAdapter.createElement($.TEMPLATE, NS.HTML, []);\n    } //NOTE: create fake element which will be used as 'document' for fragment parsing.\n    //This is important for jsdom there 'document' can't be recreated, therefore\n    //fragment parsing causes messing of the main `document`.\n\n\n    const documentMock = this.treeAdapter.createElement('documentmock', NS.HTML, []);\n\n    this._bootstrap(documentMock, fragmentContext);\n\n    if (this.treeAdapter.getTagName(fragmentContext) === $.TEMPLATE) {\n      this._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n    }\n\n    this._initTokenizerForFragmentParsing();\n\n    this._insertFakeRootElement();\n\n    this._resetInsertionMode();\n\n    this._findFormInFragmentContext();\n\n    this.tokenizer.write(html, true);\n\n    this._runParsingLoop(null);\n\n    const rootElement = this.treeAdapter.getFirstChild(documentMock);\n    const fragment = this.treeAdapter.createDocumentFragment();\n\n    this._adoptNodes(rootElement, fragment);\n\n    return fragment;\n  } //Bootstrap parser\n\n\n  _bootstrap(document, fragmentContext) {\n    this.tokenizer = new Tokenizer(this.options);\n    this.stopped = false;\n    this.insertionMode = INITIAL_MODE;\n    this.originalInsertionMode = '';\n    this.document = document;\n    this.fragmentContext = fragmentContext;\n    this.headElement = null;\n    this.formElement = null;\n    this.openElements = new OpenElementStack(this.document, this.treeAdapter);\n    this.activeFormattingElements = new FormattingElementList(this.treeAdapter);\n    this.tmplInsertionModeStack = [];\n    this.tmplInsertionModeStackTop = -1;\n    this.currentTmplInsertionMode = null;\n    this.pendingCharacterTokens = [];\n    this.hasNonWhitespacePendingCharacterToken = false;\n    this.framesetOk = true;\n    this.skipNextNewLine = false;\n    this.fosterParentingEnabled = false;\n  } //Errors\n\n\n  _err() {// NOTE: err reporting is noop by default. Enabled by mixin.\n  } //Parsing loop\n\n\n  _runParsingLoop(scriptHandler) {\n    while (!this.stopped) {\n      this._setupTokenizerCDATAMode();\n\n      const token = this.tokenizer.getNextToken();\n\n      if (token.type === Tokenizer.HIBERNATION_TOKEN) {\n        break;\n      }\n\n      if (this.skipNextNewLine) {\n        this.skipNextNewLine = false;\n\n        if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n          if (token.chars.length === 1) {\n            continue;\n          }\n\n          token.chars = token.chars.substr(1);\n        }\n      }\n\n      this._processInputToken(token);\n\n      if (scriptHandler && this.pendingScript) {\n        break;\n      }\n    }\n  }\n\n  runParsingLoopForCurrentChunk(writeCallback, scriptHandler) {\n    this._runParsingLoop(scriptHandler);\n\n    if (scriptHandler && this.pendingScript) {\n      const script = this.pendingScript;\n      this.pendingScript = null;\n      scriptHandler(script);\n      return;\n    }\n\n    if (writeCallback) {\n      writeCallback();\n    }\n  } //Text parsing\n\n\n  _setupTokenizerCDATAMode() {\n    const current = this._getAdjustedCurrentElement();\n\n    this.tokenizer.allowCDATA = current && current !== this.document && this.treeAdapter.getNamespaceURI(current) !== NS.HTML && !this._isIntegrationPoint(current);\n  }\n\n  _switchToTextParsing(currentToken, nextTokenizerState) {\n    this._insertElement(currentToken, NS.HTML);\n\n    this.tokenizer.state = nextTokenizerState;\n    this.originalInsertionMode = this.insertionMode;\n    this.insertionMode = TEXT_MODE;\n  }\n\n  switchToPlaintextParsing() {\n    this.insertionMode = TEXT_MODE;\n    this.originalInsertionMode = IN_BODY_MODE;\n    this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n  } //Fragment parsing\n\n\n  _getAdjustedCurrentElement() {\n    return this.openElements.stackTop === 0 && this.fragmentContext ? this.fragmentContext : this.openElements.current;\n  }\n\n  _findFormInFragmentContext() {\n    let node = this.fragmentContext;\n\n    do {\n      if (this.treeAdapter.getTagName(node) === $.FORM) {\n        this.formElement = node;\n        break;\n      }\n\n      node = this.treeAdapter.getParentNode(node);\n    } while (node);\n  }\n\n  _initTokenizerForFragmentParsing() {\n    if (this.treeAdapter.getNamespaceURI(this.fragmentContext) === NS.HTML) {\n      const tn = this.treeAdapter.getTagName(this.fragmentContext);\n\n      if (tn === $.TITLE || tn === $.TEXTAREA) {\n        this.tokenizer.state = Tokenizer.MODE.RCDATA;\n      } else if (tn === $.STYLE || tn === $.XMP || tn === $.IFRAME || tn === $.NOEMBED || tn === $.NOFRAMES || tn === $.NOSCRIPT) {\n        this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n      } else if (tn === $.SCRIPT) {\n        this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;\n      } else if (tn === $.PLAINTEXT) {\n        this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n      }\n    }\n  } //Tree mutation\n\n\n  _setDocumentType(token) {\n    const name = token.name || '';\n    const publicId = token.publicId || '';\n    const systemId = token.systemId || '';\n    this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n  }\n\n  _attachElementToTree(element) {\n    if (this._shouldFosterParentOnInsertion()) {\n      this._fosterParentElement(element);\n    } else {\n      const parent = this.openElements.currentTmplContent || this.openElements.current;\n      this.treeAdapter.appendChild(parent, element);\n    }\n  }\n\n  _appendElement(token, namespaceURI) {\n    const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n    this._attachElementToTree(element);\n  }\n\n  _insertElement(token, namespaceURI) {\n    const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n    this._attachElementToTree(element);\n\n    this.openElements.push(element);\n  }\n\n  _insertFakeElement(tagName) {\n    const element = this.treeAdapter.createElement(tagName, NS.HTML, []);\n\n    this._attachElementToTree(element);\n\n    this.openElements.push(element);\n  }\n\n  _insertTemplate(token) {\n    const tmpl = this.treeAdapter.createElement(token.tagName, NS.HTML, token.attrs);\n    const content = this.treeAdapter.createDocumentFragment();\n    this.treeAdapter.setTemplateContent(tmpl, content);\n\n    this._attachElementToTree(tmpl);\n\n    this.openElements.push(tmpl);\n  }\n\n  _insertFakeRootElement() {\n    const element = this.treeAdapter.createElement($.HTML, NS.HTML, []);\n    this.treeAdapter.appendChild(this.openElements.current, element);\n    this.openElements.push(element);\n  }\n\n  _appendCommentNode(token, parent) {\n    const commentNode = this.treeAdapter.createCommentNode(token.data);\n    this.treeAdapter.appendChild(parent, commentNode);\n  }\n\n  _insertCharacters(token) {\n    if (this._shouldFosterParentOnInsertion()) {\n      this._fosterParentText(token.chars);\n    } else {\n      const parent = this.openElements.currentTmplContent || this.openElements.current;\n      this.treeAdapter.insertText(parent, token.chars);\n    }\n  }\n\n  _adoptNodes(donor, recipient) {\n    for (let child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n      this.treeAdapter.detachNode(child);\n      this.treeAdapter.appendChild(recipient, child);\n    }\n  } //Token processing\n\n\n  _shouldProcessTokenInForeignContent(token) {\n    const current = this._getAdjustedCurrentElement();\n\n    if (!current || current === this.document) {\n      return false;\n    }\n\n    const ns = this.treeAdapter.getNamespaceURI(current);\n\n    if (ns === NS.HTML) {\n      return false;\n    }\n\n    if (this.treeAdapter.getTagName(current) === $.ANNOTATION_XML && ns === NS.MATHML && token.type === Tokenizer.START_TAG_TOKEN && token.tagName === $.SVG) {\n      return false;\n    }\n\n    const isCharacterToken = token.type === Tokenizer.CHARACTER_TOKEN || token.type === Tokenizer.NULL_CHARACTER_TOKEN || token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN;\n    const isMathMLTextStartTag = token.type === Tokenizer.START_TAG_TOKEN && token.tagName !== $.MGLYPH && token.tagName !== $.MALIGNMARK;\n\n    if ((isMathMLTextStartTag || isCharacterToken) && this._isIntegrationPoint(current, NS.MATHML)) {\n      return false;\n    }\n\n    if ((token.type === Tokenizer.START_TAG_TOKEN || isCharacterToken) && this._isIntegrationPoint(current, NS.HTML)) {\n      return false;\n    }\n\n    return token.type !== Tokenizer.EOF_TOKEN;\n  }\n\n  _processToken(token) {\n    TOKEN_HANDLERS[this.insertionMode][token.type](this, token);\n  }\n\n  _processTokenInBodyMode(token) {\n    TOKEN_HANDLERS[IN_BODY_MODE][token.type](this, token);\n  }\n\n  _processTokenInForeignContent(token) {\n    if (token.type === Tokenizer.CHARACTER_TOKEN) {\n      characterInForeignContent(this, token);\n    } else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\n      nullCharacterInForeignContent(this, token);\n    } else if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN) {\n      insertCharacters(this, token);\n    } else if (token.type === Tokenizer.COMMENT_TOKEN) {\n      appendComment(this, token);\n    } else if (token.type === Tokenizer.START_TAG_TOKEN) {\n      startTagInForeignContent(this, token);\n    } else if (token.type === Tokenizer.END_TAG_TOKEN) {\n      endTagInForeignContent(this, token);\n    }\n  }\n\n  _processInputToken(token) {\n    if (this._shouldProcessTokenInForeignContent(token)) {\n      this._processTokenInForeignContent(token);\n    } else {\n      this._processToken(token);\n    }\n\n    if (token.type === Tokenizer.START_TAG_TOKEN && token.selfClosing && !token.ackSelfClosing) {\n      this._err(ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n    }\n  } //Integration points\n\n\n  _isIntegrationPoint(element, foreignNS) {\n    const tn = this.treeAdapter.getTagName(element);\n    const ns = this.treeAdapter.getNamespaceURI(element);\n    const attrs = this.treeAdapter.getAttrList(element);\n    return foreignContent.isIntegrationPoint(tn, ns, attrs, foreignNS);\n  } //Active formatting elements reconstruction\n\n\n  _reconstructActiveFormattingElements() {\n    const listLength = this.activeFormattingElements.length;\n\n    if (listLength) {\n      let unopenIdx = listLength;\n      let entry = null;\n\n      do {\n        unopenIdx--;\n        entry = this.activeFormattingElements.entries[unopenIdx];\n\n        if (entry.type === FormattingElementList.MARKER_ENTRY || this.openElements.contains(entry.element)) {\n          unopenIdx++;\n          break;\n        }\n      } while (unopenIdx > 0);\n\n      for (let i = unopenIdx; i < listLength; i++) {\n        entry = this.activeFormattingElements.entries[i];\n\n        this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n\n        entry.element = this.openElements.current;\n      }\n    }\n  } //Close elements\n\n\n  _closeTableCell() {\n    this.openElements.generateImpliedEndTags();\n    this.openElements.popUntilTableCellPopped();\n    this.activeFormattingElements.clearToLastMarker();\n    this.insertionMode = IN_ROW_MODE;\n  }\n\n  _closePElement() {\n    this.openElements.generateImpliedEndTagsWithExclusion($.P);\n    this.openElements.popUntilTagNamePopped($.P);\n  } //Insertion modes\n\n\n  _resetInsertionMode() {\n    for (let i = this.openElements.stackTop, last = false; i >= 0; i--) {\n      let element = this.openElements.items[i];\n\n      if (i === 0) {\n        last = true;\n\n        if (this.fragmentContext) {\n          element = this.fragmentContext;\n        }\n      }\n\n      const tn = this.treeAdapter.getTagName(element);\n      const newInsertionMode = INSERTION_MODE_RESET_MAP[tn];\n\n      if (newInsertionMode) {\n        this.insertionMode = newInsertionMode;\n        break;\n      } else if (!last && (tn === $.TD || tn === $.TH)) {\n        this.insertionMode = IN_CELL_MODE;\n        break;\n      } else if (!last && tn === $.HEAD) {\n        this.insertionMode = IN_HEAD_MODE;\n        break;\n      } else if (tn === $.SELECT) {\n        this._resetInsertionModeForSelect(i);\n\n        break;\n      } else if (tn === $.TEMPLATE) {\n        this.insertionMode = this.currentTmplInsertionMode;\n        break;\n      } else if (tn === $.HTML) {\n        this.insertionMode = this.headElement ? AFTER_HEAD_MODE : BEFORE_HEAD_MODE;\n        break;\n      } else if (last) {\n        this.insertionMode = IN_BODY_MODE;\n        break;\n      }\n    }\n  }\n\n  _resetInsertionModeForSelect(selectIdx) {\n    if (selectIdx > 0) {\n      for (let i = selectIdx - 1; i > 0; i--) {\n        const ancestor = this.openElements.items[i];\n        const tn = this.treeAdapter.getTagName(ancestor);\n\n        if (tn === $.TEMPLATE) {\n          break;\n        } else if (tn === $.TABLE) {\n          this.insertionMode = IN_SELECT_IN_TABLE_MODE;\n          return;\n        }\n      }\n    }\n\n    this.insertionMode = IN_SELECT_MODE;\n  }\n\n  _pushTmplInsertionMode(mode) {\n    this.tmplInsertionModeStack.push(mode);\n    this.tmplInsertionModeStackTop++;\n    this.currentTmplInsertionMode = mode;\n  }\n\n  _popTmplInsertionMode() {\n    this.tmplInsertionModeStack.pop();\n    this.tmplInsertionModeStackTop--;\n    this.currentTmplInsertionMode = this.tmplInsertionModeStack[this.tmplInsertionModeStackTop];\n  } //Foster parenting\n\n\n  _isElementCausesFosterParenting(element) {\n    const tn = this.treeAdapter.getTagName(element);\n    return tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR;\n  }\n\n  _shouldFosterParentOnInsertion() {\n    return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.current);\n  }\n\n  _findFosterParentingLocation() {\n    const location = {\n      parent: null,\n      beforeElement: null\n    };\n\n    for (let i = this.openElements.stackTop; i >= 0; i--) {\n      const openElement = this.openElements.items[i];\n      const tn = this.treeAdapter.getTagName(openElement);\n      const ns = this.treeAdapter.getNamespaceURI(openElement);\n\n      if (tn === $.TEMPLATE && ns === NS.HTML) {\n        location.parent = this.treeAdapter.getTemplateContent(openElement);\n        break;\n      } else if (tn === $.TABLE) {\n        location.parent = this.treeAdapter.getParentNode(openElement);\n\n        if (location.parent) {\n          location.beforeElement = openElement;\n        } else {\n          location.parent = this.openElements.items[i - 1];\n        }\n\n        break;\n      }\n    }\n\n    if (!location.parent) {\n      location.parent = this.openElements.items[0];\n    }\n\n    return location;\n  }\n\n  _fosterParentElement(element) {\n    const location = this._findFosterParentingLocation();\n\n    if (location.beforeElement) {\n      this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n    } else {\n      this.treeAdapter.appendChild(location.parent, element);\n    }\n  }\n\n  _fosterParentText(chars) {\n    const location = this._findFosterParentingLocation();\n\n    if (location.beforeElement) {\n      this.treeAdapter.insertTextBefore(location.parent, chars, location.beforeElement);\n    } else {\n      this.treeAdapter.insertText(location.parent, chars);\n    }\n  } //Special elements\n\n\n  _isSpecialElement(element) {\n    const tn = this.treeAdapter.getTagName(element);\n    const ns = this.treeAdapter.getNamespaceURI(element);\n    return HTML.SPECIAL_ELEMENTS[ns][tn];\n  }\n\n}\n\nmodule.exports = Parser; //Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n//Steps 5-8 of the algorithm\n\nfunction aaObtainFormattingElementEntry(p, token) {\n  let formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n\n  if (formattingElementEntry) {\n    if (!p.openElements.contains(formattingElementEntry.element)) {\n      p.activeFormattingElements.removeEntry(formattingElementEntry);\n      formattingElementEntry = null;\n    } else if (!p.openElements.hasInScope(token.tagName)) {\n      formattingElementEntry = null;\n    }\n  } else {\n    genericEndTagInBody(p, token);\n  }\n\n  return formattingElementEntry;\n} //Steps 9 and 10 of the algorithm\n\n\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n  let furthestBlock = null;\n\n  for (let i = p.openElements.stackTop; i >= 0; i--) {\n    const element = p.openElements.items[i];\n\n    if (element === formattingElementEntry.element) {\n      break;\n    }\n\n    if (p._isSpecialElement(element)) {\n      furthestBlock = element;\n    }\n  }\n\n  if (!furthestBlock) {\n    p.openElements.popUntilElementPopped(formattingElementEntry.element);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n  }\n\n  return furthestBlock;\n} //Step 13 of the algorithm\n\n\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n  let lastElement = furthestBlock;\n  let nextElement = p.openElements.getCommonAncestor(furthestBlock);\n\n  for (let i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n    //NOTE: store next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n    nextElement = p.openElements.getCommonAncestor(element);\n    const elementEntry = p.activeFormattingElements.getElementEntry(element);\n    const counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n    const shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n\n    if (shouldRemoveFromOpenElements) {\n      if (counterOverflow) {\n        p.activeFormattingElements.removeEntry(elementEntry);\n      }\n\n      p.openElements.remove(element);\n    } else {\n      element = aaRecreateElementFromEntry(p, elementEntry);\n\n      if (lastElement === furthestBlock) {\n        p.activeFormattingElements.bookmark = elementEntry;\n      }\n\n      p.treeAdapter.detachNode(lastElement);\n      p.treeAdapter.appendChild(element, lastElement);\n      lastElement = element;\n    }\n  }\n\n  return lastElement;\n} //Step 13.7 of the algorithm\n\n\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n  const ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n  const newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n  p.openElements.replace(elementEntry.element, newElement);\n  elementEntry.element = newElement;\n  return newElement;\n} //Step 14 of the algorithm\n\n\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n  if (p._isElementCausesFosterParenting(commonAncestor)) {\n    p._fosterParentElement(lastElement);\n  } else {\n    const tn = p.treeAdapter.getTagName(commonAncestor);\n    const ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n\n    if (tn === $.TEMPLATE && ns === NS.HTML) {\n      commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n    }\n\n    p.treeAdapter.appendChild(commonAncestor, lastElement);\n  }\n} //Steps 15-19 of the algorithm\n\n\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n  const ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n  const token = formattingElementEntry.token;\n  const newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n\n  p._adoptNodes(furthestBlock, newElement);\n\n  p.treeAdapter.appendChild(furthestBlock, newElement);\n  p.activeFormattingElements.insertElementAfterBookmark(newElement, formattingElementEntry.token);\n  p.activeFormattingElements.removeEntry(formattingElementEntry);\n  p.openElements.remove(formattingElementEntry.element);\n  p.openElements.insertAfter(furthestBlock, newElement);\n} //Algorithm entry point\n\n\nfunction callAdoptionAgency(p, token) {\n  let formattingElementEntry;\n\n  for (let i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n    formattingElementEntry = aaObtainFormattingElementEntry(p, token, formattingElementEntry);\n\n    if (!formattingElementEntry) {\n      break;\n    }\n\n    const furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n\n    if (!furthestBlock) {\n      break;\n    }\n\n    p.activeFormattingElements.bookmark = formattingElementEntry;\n    const lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n    const commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n    p.treeAdapter.detachNode(lastElement);\n    aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n    aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n  }\n} //Generic token handlers\n//------------------------------------------------------------------\n\n\nfunction ignoreToken() {//NOTE: do nothing =)\n}\n\nfunction misplacedDoctype(p) {\n  p._err(ERR.misplacedDoctype);\n}\n\nfunction appendComment(p, token) {\n  p._appendCommentNode(token, p.openElements.currentTmplContent || p.openElements.current);\n}\n\nfunction appendCommentToRootHtmlElement(p, token) {\n  p._appendCommentNode(token, p.openElements.items[0]);\n}\n\nfunction appendCommentToDocument(p, token) {\n  p._appendCommentNode(token, p.document);\n}\n\nfunction insertCharacters(p, token) {\n  p._insertCharacters(token);\n}\n\nfunction stopParsing(p) {\n  p.stopped = true;\n} // The \"initial\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction doctypeInInitialMode(p, token) {\n  p._setDocumentType(token);\n\n  const mode = token.forceQuirks ? HTML.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n\n  if (!doctype.isConforming(token)) {\n    p._err(ERR.nonConformingDoctype);\n  }\n\n  p.treeAdapter.setDocumentMode(p.document, mode);\n  p.insertionMode = BEFORE_HTML_MODE;\n}\n\nfunction tokenInInitialMode(p, token) {\n  p._err(ERR.missingDoctype, {\n    beforeToken: true\n  });\n\n  p.treeAdapter.setDocumentMode(p.document, HTML.DOCUMENT_MODE.QUIRKS);\n  p.insertionMode = BEFORE_HTML_MODE;\n\n  p._processToken(token);\n} // The \"before html\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagBeforeHtml(p, token) {\n  if (token.tagName === $.HTML) {\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = BEFORE_HEAD_MODE;\n  } else {\n    tokenBeforeHtml(p, token);\n  }\n}\n\nfunction endTagBeforeHtml(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML || tn === $.HEAD || tn === $.BODY || tn === $.BR) {\n    tokenBeforeHtml(p, token);\n  }\n}\n\nfunction tokenBeforeHtml(p, token) {\n  p._insertFakeRootElement();\n\n  p.insertionMode = BEFORE_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"before head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagBeforeHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.HEAD) {\n    p._insertElement(token, NS.HTML);\n\n    p.headElement = p.openElements.current;\n    p.insertionMode = IN_HEAD_MODE;\n  } else {\n    tokenBeforeHead(p, token);\n  }\n}\n\nfunction endTagBeforeHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HEAD || tn === $.BODY || tn === $.HTML || tn === $.BR) {\n    tokenBeforeHead(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenBeforeHead(p, token) {\n  p._insertFakeElement($.HEAD);\n\n  p.headElement = p.openElements.current;\n  p.insertionMode = IN_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"in head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.TITLE) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RCDATA);\n  } else if (tn === $.NOSCRIPT) {\n    if (p.options.scriptingEnabled) {\n      p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n    } else {\n      p._insertElement(token, NS.HTML);\n\n      p.insertionMode = IN_HEAD_NO_SCRIPT_MODE;\n    }\n  } else if (tn === $.NOFRAMES || tn === $.STYLE) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n  } else if (tn === $.SCRIPT) {\n    p._switchToTextParsing(token, Tokenizer.MODE.SCRIPT_DATA);\n  } else if (tn === $.TEMPLATE) {\n    p._insertTemplate(token, NS.HTML);\n\n    p.activeFormattingElements.insertMarker();\n    p.framesetOk = false;\n    p.insertionMode = IN_TEMPLATE_MODE;\n\n    p._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n  } else if (tn === $.HEAD) {\n    p._err(ERR.misplacedStartTagForHeadElement);\n  } else {\n    tokenInHead(p, token);\n  }\n}\n\nfunction endTagInHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HEAD) {\n    p.openElements.pop();\n    p.insertionMode = AFTER_HEAD_MODE;\n  } else if (tn === $.BODY || tn === $.BR || tn === $.HTML) {\n    tokenInHead(p, token);\n  } else if (tn === $.TEMPLATE) {\n    if (p.openElements.tmplCount > 0) {\n      p.openElements.generateImpliedEndTagsThoroughly();\n\n      if (p.openElements.currentTagName !== $.TEMPLATE) {\n        p._err(ERR.closingOfElementWithOpenChildElements);\n      }\n\n      p.openElements.popUntilTagNamePopped($.TEMPLATE);\n      p.activeFormattingElements.clearToLastMarker();\n\n      p._popTmplInsertionMode();\n\n      p._resetInsertionMode();\n    } else {\n      p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenInHead(p, token) {\n  p.openElements.pop();\n  p.insertionMode = AFTER_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"in head no script\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInHeadNoScript(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BASEFONT || tn === $.BGSOUND || tn === $.HEAD || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.STYLE) {\n    startTagInHead(p, token);\n  } else if (tn === $.NOSCRIPT) {\n    p._err(ERR.nestedNoscriptInHead);\n  } else {\n    tokenInHeadNoScript(p, token);\n  }\n}\n\nfunction endTagInHeadNoScript(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.NOSCRIPT) {\n    p.openElements.pop();\n    p.insertionMode = IN_HEAD_MODE;\n  } else if (tn === $.BR) {\n    tokenInHeadNoScript(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenInHeadNoScript(p, token) {\n  const errCode = token.type === Tokenizer.EOF_TOKEN ? ERR.openElementsLeftAfterEof : ERR.disallowedContentInNoscriptInHead;\n\n  p._err(errCode);\n\n  p.openElements.pop();\n  p.insertionMode = IN_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"after head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BODY) {\n    p._insertElement(token, NS.HTML);\n\n    p.framesetOk = false;\n    p.insertionMode = IN_BODY_MODE;\n  } else if (tn === $.FRAMESET) {\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_FRAMESET_MODE;\n  } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.SCRIPT || tn === $.STYLE || tn === $.TEMPLATE || tn === $.TITLE) {\n    p._err(ERR.abandonedHeadElementChild);\n\n    p.openElements.push(p.headElement);\n    startTagInHead(p, token);\n    p.openElements.remove(p.headElement);\n  } else if (tn === $.HEAD) {\n    p._err(ERR.misplacedStartTagForHeadElement);\n  } else {\n    tokenAfterHead(p, token);\n  }\n}\n\nfunction endTagAfterHead(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.BODY || tn === $.HTML || tn === $.BR) {\n    tokenAfterHead(p, token);\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenAfterHead(p, token) {\n  p._insertFakeElement($.BODY);\n\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"in body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction whitespaceCharacterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertCharacters(token);\n}\n\nfunction characterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertCharacters(token);\n\n  p.framesetOk = false;\n}\n\nfunction htmlStartTagInBody(p, token) {\n  if (p.openElements.tmplCount === 0) {\n    p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n  }\n}\n\nfunction bodyStartTagInBody(p, token) {\n  const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n  if (bodyElement && p.openElements.tmplCount === 0) {\n    p.framesetOk = false;\n    p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n  }\n}\n\nfunction framesetStartTagInBody(p, token) {\n  const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n  if (p.framesetOk && bodyElement) {\n    p.treeAdapter.detachNode(bodyElement);\n    p.openElements.popAllUpToHtmlElement();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_FRAMESET_MODE;\n  }\n}\n\nfunction addressStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction numberedHeaderStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  const tn = p.openElements.currentTagName;\n\n  if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n    p.openElements.pop();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction preStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML); //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n\n\n  p.skipNextNewLine = true;\n  p.framesetOk = false;\n}\n\nfunction formStartTagInBody(p, token) {\n  const inTemplate = p.openElements.tmplCount > 0;\n\n  if (!p.formElement || inTemplate) {\n    if (p.openElements.hasInButtonScope($.P)) {\n      p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n\n    if (!inTemplate) {\n      p.formElement = p.openElements.current;\n    }\n  }\n}\n\nfunction listItemStartTagInBody(p, token) {\n  p.framesetOk = false;\n  const tn = token.tagName;\n\n  for (let i = p.openElements.stackTop; i >= 0; i--) {\n    const element = p.openElements.items[i];\n    const elementTn = p.treeAdapter.getTagName(element);\n    let closeTn = null;\n\n    if (tn === $.LI && elementTn === $.LI) {\n      closeTn = $.LI;\n    } else if ((tn === $.DD || tn === $.DT) && (elementTn === $.DD || elementTn === $.DT)) {\n      closeTn = elementTn;\n    }\n\n    if (closeTn) {\n      p.openElements.generateImpliedEndTagsWithExclusion(closeTn);\n      p.openElements.popUntilTagNamePopped(closeTn);\n      break;\n    }\n\n    if (elementTn !== $.ADDRESS && elementTn !== $.DIV && elementTn !== $.P && p._isSpecialElement(element)) {\n      break;\n    }\n  }\n\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction plaintextStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n}\n\nfunction buttonStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.BUTTON)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped($.BUTTON);\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n}\n\nfunction aStartTagInBody(p, token) {\n  const activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName($.A);\n\n  if (activeElementEntry) {\n    callAdoptionAgency(p, token);\n    p.openElements.remove(activeElementEntry.element);\n    p.activeFormattingElements.removeEntry(activeElementEntry);\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction bStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction nobrStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  if (p.openElements.hasInScope($.NOBR)) {\n    callAdoptionAgency(p, token);\n\n    p._reconstructActiveFormattingElements();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction appletStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.insertMarker();\n  p.framesetOk = false;\n}\n\nfunction tableStartTagInBody(p, token) {\n  if (p.treeAdapter.getDocumentMode(p.document) !== HTML.DOCUMENT_MODE.QUIRKS && p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  p.insertionMode = IN_TABLE_MODE;\n}\n\nfunction areaStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._appendElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\n\nfunction inputStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._appendElement(token, NS.HTML);\n\n  const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n  if (!inputType || inputType.toLowerCase() !== HIDDEN_INPUT_TYPE) {\n    p.framesetOk = false;\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction paramStartTagInBody(p, token) {\n  p._appendElement(token, NS.HTML);\n\n  token.ackSelfClosing = true;\n}\n\nfunction hrStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._appendElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\n\nfunction imageStartTagInBody(p, token) {\n  token.tagName = $.IMG;\n  areaStartTagInBody(p, token);\n}\n\nfunction textareaStartTagInBody(p, token) {\n  p._insertElement(token, NS.HTML); //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n\n\n  p.skipNextNewLine = true;\n  p.tokenizer.state = Tokenizer.MODE.RCDATA;\n  p.originalInsertionMode = p.insertionMode;\n  p.framesetOk = false;\n  p.insertionMode = TEXT_MODE;\n}\n\nfunction xmpStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p.framesetOk = false;\n\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction iframeStartTagInBody(p, token) {\n  p.framesetOk = false;\n\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n} //NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as a rawtext.\n\n\nfunction noembedStartTagInBody(p, token) {\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction selectStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n\n  if (p.insertionMode === IN_TABLE_MODE || p.insertionMode === IN_CAPTION_MODE || p.insertionMode === IN_TABLE_BODY_MODE || p.insertionMode === IN_ROW_MODE || p.insertionMode === IN_CELL_MODE) {\n    p.insertionMode = IN_SELECT_IN_TABLE_MODE;\n  } else {\n    p.insertionMode = IN_SELECT_MODE;\n  }\n}\n\nfunction optgroupStartTagInBody(p, token) {\n  if (p.openElements.currentTagName === $.OPTION) {\n    p.openElements.pop();\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction rbStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.RUBY)) {\n    p.openElements.generateImpliedEndTags();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction rtStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.RUBY)) {\n    p.openElements.generateImpliedEndTagsWithExclusion($.RTC);\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction menuStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction mathStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  foreignContent.adjustTokenMathMLAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n\n  if (token.selfClosing) {\n    p._appendElement(token, NS.MATHML);\n  } else {\n    p._insertElement(token, NS.MATHML);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction svgStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  foreignContent.adjustTokenSVGAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n\n  if (token.selfClosing) {\n    p._appendElement(token, NS.SVG);\n  } else {\n    p._insertElement(token, NS.SVG);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction genericStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n} //OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\n\n\nfunction startTagInBody(p, token) {\n  const tn = token.tagName;\n\n  switch (tn.length) {\n    case 1:\n      if (tn === $.I || tn === $.S || tn === $.B || tn === $.U) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.P) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.A) {\n        aStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 2:\n      if (tn === $.DL || tn === $.OL || tn === $.UL) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        numberedHeaderStartTagInBody(p, token);\n      } else if (tn === $.LI || tn === $.DD || tn === $.DT) {\n        listItemStartTagInBody(p, token);\n      } else if (tn === $.EM || tn === $.TT) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.BR) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.HR) {\n        hrStartTagInBody(p, token);\n      } else if (tn === $.RB) {\n        rbStartTagInBody(p, token);\n      } else if (tn === $.RT || tn === $.RP) {\n        rtStartTagInBody(p, token);\n      } else if (tn !== $.TH && tn !== $.TD && tn !== $.TR) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.DIV || tn === $.DIR || tn === $.NAV) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.PRE) {\n        preStartTagInBody(p, token);\n      } else if (tn === $.BIG) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.IMG || tn === $.WBR) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.XMP) {\n        xmpStartTagInBody(p, token);\n      } else if (tn === $.SVG) {\n        svgStartTagInBody(p, token);\n      } else if (tn === $.RTC) {\n        rbStartTagInBody(p, token);\n      } else if (tn !== $.COL) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.HTML) {\n        htmlStartTagInBody(p, token);\n      } else if (tn === $.BASE || tn === $.LINK || tn === $.META) {\n        startTagInHead(p, token);\n      } else if (tn === $.BODY) {\n        bodyStartTagInBody(p, token);\n      } else if (tn === $.MAIN || tn === $.MENU) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.FORM) {\n        formStartTagInBody(p, token);\n      } else if (tn === $.CODE || tn === $.FONT) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.NOBR) {\n        nobrStartTagInBody(p, token);\n      } else if (tn === $.AREA) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.MATH) {\n        mathStartTagInBody(p, token);\n      } else if (tn === $.MENU) {\n        menuStartTagInBody(p, token);\n      } else if (tn !== $.HEAD) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.STYLE || tn === $.TITLE) {\n        startTagInHead(p, token);\n      } else if (tn === $.ASIDE) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.SMALL) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.TABLE) {\n        tableStartTagInBody(p, token);\n      } else if (tn === $.EMBED) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.INPUT) {\n        inputStartTagInBody(p, token);\n      } else if (tn === $.PARAM || tn === $.TRACK) {\n        paramStartTagInBody(p, token);\n      } else if (tn === $.IMAGE) {\n        imageStartTagInBody(p, token);\n      } else if (tn !== $.FRAME && tn !== $.TBODY && tn !== $.TFOOT && tn !== $.THEAD) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.SCRIPT) {\n        startTagInHead(p, token);\n      } else if (tn === $.CENTER || tn === $.FIGURE || tn === $.FOOTER || tn === $.HEADER || tn === $.HGROUP || tn === $.DIALOG) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.BUTTON) {\n        buttonStartTagInBody(p, token);\n      } else if (tn === $.STRIKE || tn === $.STRONG) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.APPLET || tn === $.OBJECT) {\n        appletStartTagInBody(p, token);\n      } else if (tn === $.KEYGEN) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.SOURCE) {\n        paramStartTagInBody(p, token);\n      } else if (tn === $.IFRAME) {\n        iframeStartTagInBody(p, token);\n      } else if (tn === $.SELECT) {\n        selectStartTagInBody(p, token);\n      } else if (tn === $.OPTION) {\n        optgroupStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.BGSOUND) {\n        startTagInHead(p, token);\n      } else if (tn === $.DETAILS || tn === $.ADDRESS || tn === $.ARTICLE || tn === $.SECTION || tn === $.SUMMARY) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.LISTING) {\n        preStartTagInBody(p, token);\n      } else if (tn === $.MARQUEE) {\n        appletStartTagInBody(p, token);\n      } else if (tn === $.NOEMBED) {\n        noembedStartTagInBody(p, token);\n      } else if (tn !== $.CAPTION) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.BASEFONT) {\n        startTagInHead(p, token);\n      } else if (tn === $.FRAMESET) {\n        framesetStartTagInBody(p, token);\n      } else if (tn === $.FIELDSET) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.TEXTAREA) {\n        textareaStartTagInBody(p, token);\n      } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n      } else if (tn === $.NOSCRIPT) {\n        if (p.options.scriptingEnabled) {\n          noembedStartTagInBody(p, token);\n        } else {\n          genericStartTagInBody(p, token);\n        }\n      } else if (tn === $.OPTGROUP) {\n        optgroupStartTagInBody(p, token);\n      } else if (tn !== $.COLGROUP) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 9:\n      if (tn === $.PLAINTEXT) {\n        plaintextStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 10:\n      if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n        addressStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    default:\n      genericStartTagInBody(p, token);\n  }\n}\n\nfunction bodyEndTagInBody(p) {\n  if (p.openElements.hasInScope($.BODY)) {\n    p.insertionMode = AFTER_BODY_MODE;\n  }\n}\n\nfunction htmlEndTagInBody(p, token) {\n  if (p.openElements.hasInScope($.BODY)) {\n    p.insertionMode = AFTER_BODY_MODE;\n\n    p._processToken(token);\n  }\n}\n\nfunction addressEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\n\nfunction formEndTagInBody(p) {\n  const inTemplate = p.openElements.tmplCount > 0;\n  const formElement = p.formElement;\n\n  if (!inTemplate) {\n    p.formElement = null;\n  }\n\n  if ((formElement || inTemplate) && p.openElements.hasInScope($.FORM)) {\n    p.openElements.generateImpliedEndTags();\n\n    if (inTemplate) {\n      p.openElements.popUntilTagNamePopped($.FORM);\n    } else {\n      p.openElements.remove(formElement);\n    }\n  }\n}\n\nfunction pEndTagInBody(p) {\n  if (!p.openElements.hasInButtonScope($.P)) {\n    p._insertFakeElement($.P);\n  }\n\n  p._closePElement();\n}\n\nfunction liEndTagInBody(p) {\n  if (p.openElements.hasInListItemScope($.LI)) {\n    p.openElements.generateImpliedEndTagsWithExclusion($.LI);\n    p.openElements.popUntilTagNamePopped($.LI);\n  }\n}\n\nfunction ddEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTagsWithExclusion(tn);\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\n\nfunction numberedHeaderEndTagInBody(p) {\n  if (p.openElements.hasNumberedHeaderInScope()) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilNumberedHeaderPopped();\n  }\n}\n\nfunction appletEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n    p.activeFormattingElements.clearToLastMarker();\n  }\n}\n\nfunction brEndTagInBody(p) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertFakeElement($.BR);\n\n  p.openElements.pop();\n  p.framesetOk = false;\n}\n\nfunction genericEndTagInBody(p, token) {\n  const tn = token.tagName;\n\n  for (let i = p.openElements.stackTop; i > 0; i--) {\n    const element = p.openElements.items[i];\n\n    if (p.treeAdapter.getTagName(element) === tn) {\n      p.openElements.generateImpliedEndTagsWithExclusion(tn);\n      p.openElements.popUntilElementPopped(element);\n      break;\n    }\n\n    if (p._isSpecialElement(element)) {\n      break;\n    }\n  }\n} //OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\n\n\nfunction endTagInBody(p, token) {\n  const tn = token.tagName;\n\n  switch (tn.length) {\n    case 1:\n      if (tn === $.A || tn === $.B || tn === $.I || tn === $.S || tn === $.U) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.P) {\n        pEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 2:\n      if (tn === $.DL || tn === $.UL || tn === $.OL) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.LI) {\n        liEndTagInBody(p, token);\n      } else if (tn === $.DD || tn === $.DT) {\n        ddEndTagInBody(p, token);\n      } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        numberedHeaderEndTagInBody(p, token);\n      } else if (tn === $.BR) {\n        brEndTagInBody(p, token);\n      } else if (tn === $.EM || tn === $.TT) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.BIG) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.DIR || tn === $.DIV || tn === $.NAV || tn === $.PRE) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.BODY) {\n        bodyEndTagInBody(p, token);\n      } else if (tn === $.HTML) {\n        htmlEndTagInBody(p, token);\n      } else if (tn === $.FORM) {\n        formEndTagInBody(p, token);\n      } else if (tn === $.CODE || tn === $.FONT || tn === $.NOBR) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.MAIN || tn === $.MENU) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.ASIDE) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.SMALL) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.CENTER || tn === $.FIGURE || tn === $.FOOTER || tn === $.HEADER || tn === $.HGROUP || tn === $.DIALOG) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.APPLET || tn === $.OBJECT) {\n        appletEndTagInBody(p, token);\n      } else if (tn === $.STRIKE || tn === $.STRONG) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.ADDRESS || tn === $.ARTICLE || tn === $.DETAILS || tn === $.SECTION || tn === $.SUMMARY || tn === $.LISTING) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.MARQUEE) {\n        appletEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.FIELDSET) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 10:\n      if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    default:\n      genericEndTagInBody(p, token);\n  }\n}\n\nfunction eofInBody(p, token) {\n  if (p.tmplInsertionModeStackTop > -1) {\n    eofInTemplate(p, token);\n  } else {\n    p.stopped = true;\n  }\n} // The \"text\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction endTagInText(p, token) {\n  if (token.tagName === $.SCRIPT) {\n    p.pendingScript = p.openElements.current;\n  }\n\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n}\n\nfunction eofInText(p, token) {\n  p._err(ERR.eofInElementThatCanContainOnlyText);\n\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n\n  p._processToken(token);\n} // The \"in table\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction characterInTable(p, token) {\n  const curTn = p.openElements.currentTagName;\n\n  if (curTn === $.TABLE || curTn === $.TBODY || curTn === $.TFOOT || curTn === $.THEAD || curTn === $.TR) {\n    p.pendingCharacterTokens = [];\n    p.hasNonWhitespacePendingCharacterToken = false;\n    p.originalInsertionMode = p.insertionMode;\n    p.insertionMode = IN_TABLE_TEXT_MODE;\n\n    p._processToken(token);\n  } else {\n    tokenInTable(p, token);\n  }\n}\n\nfunction captionStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p.activeFormattingElements.insertMarker();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_CAPTION_MODE;\n}\n\nfunction colgroupStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_COLUMN_GROUP_MODE;\n}\n\nfunction colStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertFakeElement($.COLGROUP);\n\n  p.insertionMode = IN_COLUMN_GROUP_MODE;\n\n  p._processToken(token);\n}\n\nfunction tbodyStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_TABLE_BODY_MODE;\n}\n\nfunction tdStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertFakeElement($.TBODY);\n\n  p.insertionMode = IN_TABLE_BODY_MODE;\n\n  p._processToken(token);\n}\n\nfunction tableStartTagInTable(p, token) {\n  if (p.openElements.hasInTableScope($.TABLE)) {\n    p.openElements.popUntilTagNamePopped($.TABLE);\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  }\n}\n\nfunction inputStartTagInTable(p, token) {\n  const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n  if (inputType && inputType.toLowerCase() === HIDDEN_INPUT_TYPE) {\n    p._appendElement(token, NS.HTML);\n  } else {\n    tokenInTable(p, token);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction formStartTagInTable(p, token) {\n  if (!p.formElement && p.openElements.tmplCount === 0) {\n    p._insertElement(token, NS.HTML);\n\n    p.formElement = p.openElements.current;\n    p.openElements.pop();\n  }\n}\n\nfunction startTagInTable(p, token) {\n  const tn = token.tagName;\n\n  switch (tn.length) {\n    case 2:\n      if (tn === $.TD || tn === $.TH || tn === $.TR) {\n        tdStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.COL) {\n        colStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.FORM) {\n        formStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.TABLE) {\n        tableStartTagInTable(p, token);\n      } else if (tn === $.STYLE) {\n        startTagInHead(p, token);\n      } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        tbodyStartTagInTable(p, token);\n      } else if (tn === $.INPUT) {\n        inputStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.SCRIPT) {\n        startTagInHead(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.CAPTION) {\n        captionStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.COLGROUP) {\n        colgroupStartTagInTable(p, token);\n      } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    default:\n      tokenInTable(p, token);\n  }\n}\n\nfunction endTagInTable(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.TABLE)) {\n      p.openElements.popUntilTagNamePopped($.TABLE);\n\n      p._resetInsertionMode();\n    }\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML && tn !== $.TBODY && tn !== $.TD && tn !== $.TFOOT && tn !== $.TH && tn !== $.THEAD && tn !== $.TR) {\n    tokenInTable(p, token);\n  }\n}\n\nfunction tokenInTable(p, token) {\n  const savedFosterParentingState = p.fosterParentingEnabled;\n  p.fosterParentingEnabled = true;\n\n  p._processTokenInBodyMode(token);\n\n  p.fosterParentingEnabled = savedFosterParentingState;\n} // The \"in table text\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction whitespaceCharacterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n}\n\nfunction characterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n  p.hasNonWhitespacePendingCharacterToken = true;\n}\n\nfunction tokenInTableText(p, token) {\n  let i = 0;\n\n  if (p.hasNonWhitespacePendingCharacterToken) {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      tokenInTable(p, p.pendingCharacterTokens[i]);\n    }\n  } else {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      p._insertCharacters(p.pendingCharacterTokens[i]);\n    }\n  }\n\n  p.insertionMode = p.originalInsertionMode;\n\n  p._processToken(token);\n} // The \"in caption\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInCaption(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TD || tn === $.TFOOT || tn === $.TH || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.CAPTION)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped($.CAPTION);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\n\nfunction endTagInCaption(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.CAPTION)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped($.CAPTION);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_TABLE_MODE;\n\n      if (tn === $.TABLE) {\n        p._processToken(token);\n      }\n    }\n  } else if (tn !== $.BODY && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML && tn !== $.TBODY && tn !== $.TD && tn !== $.TFOOT && tn !== $.TH && tn !== $.THEAD && tn !== $.TR) {\n    endTagInBody(p, token);\n  }\n} // The \"in column group\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInColumnGroup(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.COL) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.TEMPLATE) {\n    startTagInHead(p, token);\n  } else {\n    tokenInColumnGroup(p, token);\n  }\n}\n\nfunction endTagInColumnGroup(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.COLGROUP) {\n    if (p.openElements.currentTagName === $.COLGROUP) {\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n    }\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else if (tn !== $.COL) {\n    tokenInColumnGroup(p, token);\n  }\n}\n\nfunction tokenInColumnGroup(p, token) {\n  if (p.openElements.currentTagName === $.COLGROUP) {\n    p.openElements.pop();\n    p.insertionMode = IN_TABLE_MODE;\n\n    p._processToken(token);\n  }\n} // The \"in table body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInTableBody(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TR) {\n    p.openElements.clearBackToTableBodyContext();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_ROW_MODE;\n  } else if (tn === $.TH || tn === $.TD) {\n    p.openElements.clearBackToTableBodyContext();\n\n    p._insertFakeElement($.TR);\n\n    p.insertionMode = IN_ROW_MODE;\n\n    p._processToken(token);\n  } else if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasTableBodyContextInTableScope()) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInTable(p, token);\n  }\n}\n\nfunction endTagInTableBody(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n    }\n  } else if (tn === $.TABLE) {\n    if (p.openElements.hasTableBodyContextInTableScope()) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP || tn !== $.HTML && tn !== $.TD && tn !== $.TH && tn !== $.TR) {\n    endTagInTable(p, token);\n  }\n} // The \"in row\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInRow(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TH || tn === $.TD) {\n    p.openElements.clearBackToTableRowContext();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_CELL_MODE;\n    p.activeFormattingElements.insertMarker();\n  } else if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInTable(p, token);\n  }\n}\n\nfunction endTagInRow(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n    }\n  } else if (tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasInTableScope(tn) || p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP || tn !== $.HTML && tn !== $.TD && tn !== $.TH) {\n    endTagInTable(p, token);\n  }\n} // The \"in cell\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInCell(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TD || tn === $.TFOOT || tn === $.TH || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TD) || p.openElements.hasInTableScope($.TH)) {\n      p._closeTableCell();\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\n\nfunction endTagInCell(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.TD || tn === $.TH) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped(tn);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_ROW_MODE;\n    }\n  } else if (tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p._closeTableCell();\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML) {\n    endTagInBody(p, token);\n  }\n} // The \"in select\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInSelect(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.OPTION) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.OPTGROUP) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n\n    if (p.openElements.currentTagName === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.INPUT || tn === $.KEYGEN || tn === $.TEXTAREA || tn === $.SELECT) {\n    if (p.openElements.hasInSelectScope($.SELECT)) {\n      p.openElements.popUntilTagNamePopped($.SELECT);\n\n      p._resetInsertionMode();\n\n      if (tn !== $.SELECT) {\n        p._processToken(token);\n      }\n    }\n  } else if (tn === $.SCRIPT || tn === $.TEMPLATE) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagInSelect(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.OPTGROUP) {\n    const prevOpenElement = p.openElements.items[p.openElements.stackTop - 1];\n    const prevOpenElementTn = prevOpenElement && p.treeAdapter.getTagName(prevOpenElement);\n\n    if (p.openElements.currentTagName === $.OPTION && prevOpenElementTn === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n\n    if (p.openElements.currentTagName === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n  } else if (tn === $.OPTION) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n  } else if (tn === $.SELECT && p.openElements.hasInSelectScope($.SELECT)) {\n    p.openElements.popUntilTagNamePopped($.SELECT);\n\n    p._resetInsertionMode();\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  }\n} //12.2.5.4.17 The \"in select in table\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInSelectInTable(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR || tn === $.TD || tn === $.TH) {\n    p.openElements.popUntilTagNamePopped($.SELECT);\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  } else {\n    startTagInSelect(p, token);\n  }\n}\n\nfunction endTagInSelectInTable(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR || tn === $.TD || tn === $.TH) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.popUntilTagNamePopped($.SELECT);\n\n      p._resetInsertionMode();\n\n      p._processToken(token);\n    }\n  } else {\n    endTagInSelect(p, token);\n  }\n} // The \"in template\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInTemplate(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.SCRIPT || tn === $.STYLE || tn === $.TEMPLATE || tn === $.TITLE) {\n    startTagInHead(p, token);\n  } else {\n    const newInsertionMode = TEMPLATE_INSERTION_MODE_SWITCH_MAP[tn] || IN_BODY_MODE;\n\n    p._popTmplInsertionMode();\n\n    p._pushTmplInsertionMode(newInsertionMode);\n\n    p.insertionMode = newInsertionMode;\n\n    p._processToken(token);\n  }\n}\n\nfunction endTagInTemplate(p, token) {\n  if (token.tagName === $.TEMPLATE) {\n    endTagInHead(p, token);\n  }\n}\n\nfunction eofInTemplate(p, token) {\n  if (p.openElements.tmplCount > 0) {\n    p.openElements.popUntilTagNamePopped($.TEMPLATE);\n    p.activeFormattingElements.clearToLastMarker();\n\n    p._popTmplInsertionMode();\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  } else {\n    p.stopped = true;\n  }\n} // The \"after body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\n\nfunction endTagAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    if (!p.fragmentContext) {\n      p.insertionMode = AFTER_AFTER_BODY_MODE;\n    }\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\n\nfunction tokenAfterBody(p, token) {\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"in frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInFrameset(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.FRAMESET) {\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.FRAME) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagInFrameset(p, token) {\n  if (token.tagName === $.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n    p.openElements.pop();\n\n    if (!p.fragmentContext && p.openElements.currentTagName !== $.FRAMESET) {\n      p.insertionMode = AFTER_FRAMESET_MODE;\n    }\n  }\n} // The \"after frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterFrameset(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagAfterFrameset(p, token) {\n  if (token.tagName === $.HTML) {\n    p.insertionMode = AFTER_AFTER_FRAMESET_MODE;\n  }\n} // The \"after after body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterAfterBody(p, token);\n  }\n}\n\nfunction tokenAfterAfterBody(p, token) {\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterAfterFrameset(p, token) {\n  const tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n} // The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\n\n\nfunction nullCharacterInForeignContent(p, token) {\n  token.chars = unicode.REPLACEMENT_CHARACTER;\n\n  p._insertCharacters(token);\n}\n\nfunction characterInForeignContent(p, token) {\n  p._insertCharacters(token);\n\n  p.framesetOk = false;\n}\n\nfunction startTagInForeignContent(p, token) {\n  if (foreignContent.causesExit(token) && !p.fragmentContext) {\n    while (p.treeAdapter.getNamespaceURI(p.openElements.current) !== NS.HTML && !p._isIntegrationPoint(p.openElements.current)) {\n      p.openElements.pop();\n    }\n\n    p._processToken(token);\n  } else {\n    const current = p._getAdjustedCurrentElement();\n\n    const currentNs = p.treeAdapter.getNamespaceURI(current);\n\n    if (currentNs === NS.MATHML) {\n      foreignContent.adjustTokenMathMLAttrs(token);\n    } else if (currentNs === NS.SVG) {\n      foreignContent.adjustTokenSVGTagName(token);\n      foreignContent.adjustTokenSVGAttrs(token);\n    }\n\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n      p._appendElement(token, currentNs);\n    } else {\n      p._insertElement(token, currentNs);\n    }\n\n    token.ackSelfClosing = true;\n  }\n}\n\nfunction endTagInForeignContent(p, token) {\n  for (let i = p.openElements.stackTop; i > 0; i--) {\n    const element = p.openElements.items[i];\n\n    if (p.treeAdapter.getNamespaceURI(element) === NS.HTML) {\n      p._processToken(token);\n\n      break;\n    }\n\n    if (p.treeAdapter.getTagName(element).toLowerCase() === token.tagName) {\n      p.openElements.popUntilElementPopped(element);\n      break;\n    }\n  }\n}","map":{"version":3,"names":["Tokenizer","require","OpenElementStack","FormattingElementList","LocationInfoParserMixin","ErrorReportingParserMixin","Mixin","defaultTreeAdapter","mergeOptions","doctype","foreignContent","ERR","unicode","HTML","$","TAG_NAMES","NS","NAMESPACES","ATTRS","DEFAULT_OPTIONS","scriptingEnabled","sourceCodeLocationInfo","onParseError","treeAdapter","HIDDEN_INPUT_TYPE","AA_OUTER_LOOP_ITER","AA_INNER_LOOP_ITER","INITIAL_MODE","BEFORE_HTML_MODE","BEFORE_HEAD_MODE","IN_HEAD_MODE","IN_HEAD_NO_SCRIPT_MODE","AFTER_HEAD_MODE","IN_BODY_MODE","TEXT_MODE","IN_TABLE_MODE","IN_TABLE_TEXT_MODE","IN_CAPTION_MODE","IN_COLUMN_GROUP_MODE","IN_TABLE_BODY_MODE","IN_ROW_MODE","IN_CELL_MODE","IN_SELECT_MODE","IN_SELECT_IN_TABLE_MODE","IN_TEMPLATE_MODE","AFTER_BODY_MODE","IN_FRAMESET_MODE","AFTER_FRAMESET_MODE","AFTER_AFTER_BODY_MODE","AFTER_AFTER_FRAMESET_MODE","INSERTION_MODE_RESET_MAP","TR","TBODY","THEAD","TFOOT","CAPTION","COLGROUP","TABLE","BODY","FRAMESET","TEMPLATE_INSERTION_MODE_SWITCH_MAP","COL","TD","TH","TOKEN_HANDLERS","CHARACTER_TOKEN","tokenInInitialMode","NULL_CHARACTER_TOKEN","WHITESPACE_CHARACTER_TOKEN","ignoreToken","COMMENT_TOKEN","appendComment","DOCTYPE_TOKEN","doctypeInInitialMode","START_TAG_TOKEN","END_TAG_TOKEN","EOF_TOKEN","tokenBeforeHtml","startTagBeforeHtml","endTagBeforeHtml","tokenBeforeHead","misplacedDoctype","startTagBeforeHead","endTagBeforeHead","tokenInHead","insertCharacters","startTagInHead","endTagInHead","tokenInHeadNoScript","startTagInHeadNoScript","endTagInHeadNoScript","tokenAfterHead","startTagAfterHead","endTagAfterHead","characterInBody","whitespaceCharacterInBody","startTagInBody","endTagInBody","eofInBody","endTagInText","eofInText","characterInTable","startTagInTable","endTagInTable","characterInTableText","whitespaceCharacterInTableText","tokenInTableText","startTagInCaption","endTagInCaption","tokenInColumnGroup","startTagInColumnGroup","endTagInColumnGroup","startTagInTableBody","endTagInTableBody","startTagInRow","endTagInRow","startTagInCell","endTagInCell","startTagInSelect","endTagInSelect","startTagInSelectInTable","endTagInSelectInTable","startTagInTemplate","endTagInTemplate","eofInTemplate","tokenAfterBody","appendCommentToRootHtmlElement","startTagAfterBody","endTagAfterBody","stopParsing","startTagInFrameset","endTagInFrameset","startTagAfterFrameset","endTagAfterFrameset","tokenAfterAfterBody","appendCommentToDocument","startTagAfterAfterBody","startTagAfterAfterFrameset","Parser","constructor","options","pendingScript","install","parse","html","document","createDocument","_bootstrap","tokenizer","write","_runParsingLoop","parseFragment","fragmentContext","createElement","TEMPLATE","documentMock","getTagName","_pushTmplInsertionMode","_initTokenizerForFragmentParsing","_insertFakeRootElement","_resetInsertionMode","_findFormInFragmentContext","rootElement","getFirstChild","fragment","createDocumentFragment","_adoptNodes","stopped","insertionMode","originalInsertionMode","headElement","formElement","openElements","activeFormattingElements","tmplInsertionModeStack","tmplInsertionModeStackTop","currentTmplInsertionMode","pendingCharacterTokens","hasNonWhitespacePendingCharacterToken","framesetOk","skipNextNewLine","fosterParentingEnabled","_err","scriptHandler","_setupTokenizerCDATAMode","token","getNextToken","type","HIBERNATION_TOKEN","chars","length","substr","_processInputToken","runParsingLoopForCurrentChunk","writeCallback","script","current","_getAdjustedCurrentElement","allowCDATA","getNamespaceURI","_isIntegrationPoint","_switchToTextParsing","currentToken","nextTokenizerState","_insertElement","state","switchToPlaintextParsing","MODE","PLAINTEXT","stackTop","node","FORM","getParentNode","tn","TITLE","TEXTAREA","RCDATA","STYLE","XMP","IFRAME","NOEMBED","NOFRAMES","NOSCRIPT","RAWTEXT","SCRIPT","SCRIPT_DATA","_setDocumentType","name","publicId","systemId","setDocumentType","_attachElementToTree","element","_shouldFosterParentOnInsertion","_fosterParentElement","parent","currentTmplContent","appendChild","_appendElement","namespaceURI","tagName","attrs","push","_insertFakeElement","_insertTemplate","tmpl","content","setTemplateContent","_appendCommentNode","commentNode","createCommentNode","data","_insertCharacters","_fosterParentText","insertText","donor","recipient","child","detachNode","_shouldProcessTokenInForeignContent","ns","ANNOTATION_XML","MATHML","SVG","isCharacterToken","isMathMLTextStartTag","MGLYPH","MALIGNMARK","_processToken","_processTokenInBodyMode","_processTokenInForeignContent","characterInForeignContent","nullCharacterInForeignContent","startTagInForeignContent","endTagInForeignContent","selfClosing","ackSelfClosing","nonVoidHtmlElementStartTagWithTrailingSolidus","foreignNS","getAttrList","isIntegrationPoint","_reconstructActiveFormattingElements","listLength","unopenIdx","entry","entries","MARKER_ENTRY","contains","i","_closeTableCell","generateImpliedEndTags","popUntilTableCellPopped","clearToLastMarker","_closePElement","generateImpliedEndTagsWithExclusion","P","popUntilTagNamePopped","last","items","newInsertionMode","HEAD","SELECT","_resetInsertionModeForSelect","selectIdx","ancestor","mode","_popTmplInsertionMode","pop","_isElementCausesFosterParenting","_findFosterParentingLocation","location","beforeElement","openElement","getTemplateContent","insertBefore","insertTextBefore","_isSpecialElement","SPECIAL_ELEMENTS","module","exports","aaObtainFormattingElementEntry","p","formattingElementEntry","getElementEntryInScopeWithTagName","removeEntry","hasInScope","genericEndTagInBody","aaObtainFurthestBlock","furthestBlock","popUntilElementPopped","aaInnerLoop","formattingElement","lastElement","nextElement","getCommonAncestor","elementEntry","getElementEntry","counterOverflow","shouldRemoveFromOpenElements","remove","aaRecreateElementFromEntry","bookmark","newElement","replace","aaInsertLastNodeInCommonAncestor","commonAncestor","aaReplaceFormattingElement","insertElementAfterBookmark","insertAfter","callAdoptionAgency","forceQuirks","DOCUMENT_MODE","QUIRKS","getDocumentMode","isConforming","nonConformingDoctype","setDocumentMode","missingDoctype","beforeToken","BR","endTagWithoutMatchingOpenElement","BASE","BASEFONT","BGSOUND","LINK","META","insertMarker","misplacedStartTagForHeadElement","tmplCount","generateImpliedEndTagsThoroughly","currentTagName","closingOfElementWithOpenChildElements","nestedNoscriptInHead","errCode","openElementsLeftAfterEof","disallowedContentInNoscriptInHead","abandonedHeadElementChild","htmlStartTagInBody","adoptAttributes","bodyStartTagInBody","bodyElement","tryPeekProperlyNestedBodyElement","framesetStartTagInBody","popAllUpToHtmlElement","addressStartTagInBody","hasInButtonScope","numberedHeaderStartTagInBody","H1","H2","H3","H4","H5","H6","preStartTagInBody","formStartTagInBody","inTemplate","listItemStartTagInBody","elementTn","closeTn","LI","DD","DT","ADDRESS","DIV","plaintextStartTagInBody","buttonStartTagInBody","BUTTON","aStartTagInBody","activeElementEntry","A","pushElement","bStartTagInBody","nobrStartTagInBody","NOBR","appletStartTagInBody","tableStartTagInBody","areaStartTagInBody","inputStartTagInBody","inputType","getTokenAttr","TYPE","toLowerCase","paramStartTagInBody","hrStartTagInBody","imageStartTagInBody","IMG","textareaStartTagInBody","xmpStartTagInBody","iframeStartTagInBody","noembedStartTagInBody","selectStartTagInBody","optgroupStartTagInBody","OPTION","rbStartTagInBody","RUBY","rtStartTagInBody","RTC","menuStartTagInBody","mathStartTagInBody","adjustTokenMathMLAttrs","adjustTokenXMLAttrs","svgStartTagInBody","adjustTokenSVGAttrs","genericStartTagInBody","I","S","B","U","DL","OL","UL","EM","TT","HR","RB","RT","RP","DIR","NAV","PRE","BIG","WBR","MAIN","MENU","CODE","FONT","AREA","MATH","ASIDE","SMALL","EMBED","INPUT","PARAM","TRACK","IMAGE","FRAME","CENTER","FIGURE","FOOTER","HEADER","HGROUP","DIALOG","STRIKE","STRONG","APPLET","OBJECT","KEYGEN","SOURCE","DETAILS","ARTICLE","SECTION","SUMMARY","LISTING","MARQUEE","FIELDSET","OPTGROUP","BLOCKQUOTE","FIGCAPTION","bodyEndTagInBody","htmlEndTagInBody","addressEndTagInBody","formEndTagInBody","pEndTagInBody","liEndTagInBody","hasInListItemScope","ddEndTagInBody","numberedHeaderEndTagInBody","hasNumberedHeaderInScope","popUntilNumberedHeaderPopped","appletEndTagInBody","brEndTagInBody","eofInElementThatCanContainOnlyText","curTn","tokenInTable","captionStartTagInTable","clearBackToTableContext","colgroupStartTagInTable","colStartTagInTable","tbodyStartTagInTable","tdStartTagInTable","tableStartTagInTable","hasInTableScope","inputStartTagInTable","formStartTagInTable","savedFosterParentingState","clearBackToTableBodyContext","hasTableBodyContextInTableScope","clearBackToTableRowContext","hasInSelectScope","prevOpenElement","prevOpenElementTn","isRootHtmlElementCurrent","REPLACEMENT_CHARACTER","causesExit","currentNs","adjustTokenSVGTagName"],"sources":["C:/Users/apinto2/Desktop/teswordtomd/12 setembro/UPLOAD 9/turorials/client/node_modules/parse5/lib/parser/index.js"],"sourcesContent":["'use strict';\n\nconst Tokenizer = require('../tokenizer');\nconst OpenElementStack = require('./open-element-stack');\nconst FormattingElementList = require('./formatting-element-list');\nconst LocationInfoParserMixin = require('../extensions/location-info/parser-mixin');\nconst ErrorReportingParserMixin = require('../extensions/error-reporting/parser-mixin');\nconst Mixin = require('../utils/mixin');\nconst defaultTreeAdapter = require('../tree-adapters/default');\nconst mergeOptions = require('../utils/merge-options');\nconst doctype = require('../common/doctype');\nconst foreignContent = require('../common/foreign-content');\nconst ERR = require('../common/error-codes');\nconst unicode = require('../common/unicode');\nconst HTML = require('../common/html');\n\n//Aliases\nconst $ = HTML.TAG_NAMES;\nconst NS = HTML.NAMESPACES;\nconst ATTRS = HTML.ATTRS;\n\nconst DEFAULT_OPTIONS = {\n    scriptingEnabled: true,\n    sourceCodeLocationInfo: false,\n    onParseError: null,\n    treeAdapter: defaultTreeAdapter\n};\n\n//Misc constants\nconst HIDDEN_INPUT_TYPE = 'hidden';\n\n//Adoption agency loops iteration count\nconst AA_OUTER_LOOP_ITER = 8;\nconst AA_INNER_LOOP_ITER = 3;\n\n//Insertion modes\nconst INITIAL_MODE = 'INITIAL_MODE';\nconst BEFORE_HTML_MODE = 'BEFORE_HTML_MODE';\nconst BEFORE_HEAD_MODE = 'BEFORE_HEAD_MODE';\nconst IN_HEAD_MODE = 'IN_HEAD_MODE';\nconst IN_HEAD_NO_SCRIPT_MODE = 'IN_HEAD_NO_SCRIPT_MODE';\nconst AFTER_HEAD_MODE = 'AFTER_HEAD_MODE';\nconst IN_BODY_MODE = 'IN_BODY_MODE';\nconst TEXT_MODE = 'TEXT_MODE';\nconst IN_TABLE_MODE = 'IN_TABLE_MODE';\nconst IN_TABLE_TEXT_MODE = 'IN_TABLE_TEXT_MODE';\nconst IN_CAPTION_MODE = 'IN_CAPTION_MODE';\nconst IN_COLUMN_GROUP_MODE = 'IN_COLUMN_GROUP_MODE';\nconst IN_TABLE_BODY_MODE = 'IN_TABLE_BODY_MODE';\nconst IN_ROW_MODE = 'IN_ROW_MODE';\nconst IN_CELL_MODE = 'IN_CELL_MODE';\nconst IN_SELECT_MODE = 'IN_SELECT_MODE';\nconst IN_SELECT_IN_TABLE_MODE = 'IN_SELECT_IN_TABLE_MODE';\nconst IN_TEMPLATE_MODE = 'IN_TEMPLATE_MODE';\nconst AFTER_BODY_MODE = 'AFTER_BODY_MODE';\nconst IN_FRAMESET_MODE = 'IN_FRAMESET_MODE';\nconst AFTER_FRAMESET_MODE = 'AFTER_FRAMESET_MODE';\nconst AFTER_AFTER_BODY_MODE = 'AFTER_AFTER_BODY_MODE';\nconst AFTER_AFTER_FRAMESET_MODE = 'AFTER_AFTER_FRAMESET_MODE';\n\n//Insertion mode reset map\nconst INSERTION_MODE_RESET_MAP = {\n    [$.TR]: IN_ROW_MODE,\n    [$.TBODY]: IN_TABLE_BODY_MODE,\n    [$.THEAD]: IN_TABLE_BODY_MODE,\n    [$.TFOOT]: IN_TABLE_BODY_MODE,\n    [$.CAPTION]: IN_CAPTION_MODE,\n    [$.COLGROUP]: IN_COLUMN_GROUP_MODE,\n    [$.TABLE]: IN_TABLE_MODE,\n    [$.BODY]: IN_BODY_MODE,\n    [$.FRAMESET]: IN_FRAMESET_MODE\n};\n\n//Template insertion mode switch map\nconst TEMPLATE_INSERTION_MODE_SWITCH_MAP = {\n    [$.CAPTION]: IN_TABLE_MODE,\n    [$.COLGROUP]: IN_TABLE_MODE,\n    [$.TBODY]: IN_TABLE_MODE,\n    [$.TFOOT]: IN_TABLE_MODE,\n    [$.THEAD]: IN_TABLE_MODE,\n    [$.COL]: IN_COLUMN_GROUP_MODE,\n    [$.TR]: IN_TABLE_BODY_MODE,\n    [$.TD]: IN_ROW_MODE,\n    [$.TH]: IN_ROW_MODE\n};\n\n//Token handlers map for insertion modes\nconst TOKEN_HANDLERS = {\n    [INITIAL_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInInitialMode,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInInitialMode,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: doctypeInInitialMode,\n        [Tokenizer.START_TAG_TOKEN]: tokenInInitialMode,\n        [Tokenizer.END_TAG_TOKEN]: tokenInInitialMode,\n        [Tokenizer.EOF_TOKEN]: tokenInInitialMode\n    },\n    [BEFORE_HTML_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHtml,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHtml,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagBeforeHtml,\n        [Tokenizer.END_TAG_TOKEN]: endTagBeforeHtml,\n        [Tokenizer.EOF_TOKEN]: tokenBeforeHtml\n    },\n    [BEFORE_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagBeforeHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagBeforeHead,\n        [Tokenizer.EOF_TOKEN]: tokenBeforeHead\n    },\n    [IN_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagInHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagInHead,\n        [Tokenizer.EOF_TOKEN]: tokenInHead\n    },\n    [IN_HEAD_NO_SCRIPT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInHeadNoScript,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHeadNoScript,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagInHeadNoScript,\n        [Tokenizer.END_TAG_TOKEN]: endTagInHeadNoScript,\n        [Tokenizer.EOF_TOKEN]: tokenInHeadNoScript\n    },\n    [AFTER_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterHead,\n        [Tokenizer.EOF_TOKEN]: tokenAfterHead\n    },\n    [IN_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagInBody,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [TEXT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: ignoreToken,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: ignoreToken,\n        [Tokenizer.END_TAG_TOKEN]: endTagInText,\n        [Tokenizer.EOF_TOKEN]: eofInText\n    },\n    [IN_TABLE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTable,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTable,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TABLE_TEXT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTableText,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInTableText,\n        [Tokenizer.COMMENT_TOKEN]: tokenInTableText,\n        [Tokenizer.DOCTYPE_TOKEN]: tokenInTableText,\n        [Tokenizer.START_TAG_TOKEN]: tokenInTableText,\n        [Tokenizer.END_TAG_TOKEN]: tokenInTableText,\n        [Tokenizer.EOF_TOKEN]: tokenInTableText\n    },\n    [IN_CAPTION_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInCaption,\n        [Tokenizer.END_TAG_TOKEN]: endTagInCaption,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_COLUMN_GROUP_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInColumnGroup,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInColumnGroup,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInColumnGroup,\n        [Tokenizer.END_TAG_TOKEN]: endTagInColumnGroup,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TABLE_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTableBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTableBody,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_ROW_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInRow,\n        [Tokenizer.END_TAG_TOKEN]: endTagInRow,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_CELL_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInCell,\n        [Tokenizer.END_TAG_TOKEN]: endTagInCell,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_SELECT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInSelect,\n        [Tokenizer.END_TAG_TOKEN]: endTagInSelect,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_SELECT_IN_TABLE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInSelectInTable,\n        [Tokenizer.END_TAG_TOKEN]: endTagInSelectInTable,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TEMPLATE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTemplate,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTemplate,\n        [Tokenizer.EOF_TOKEN]: eofInTemplate\n    },\n    [AFTER_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterBody,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToRootHtmlElement,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterBody,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [IN_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInFrameset,\n        [Tokenizer.END_TAG_TOKEN]: endTagInFrameset,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterFrameset,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterFrameset,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_AFTER_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterBody,\n        [Tokenizer.END_TAG_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_AFTER_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterFrameset,\n        [Tokenizer.END_TAG_TOKEN]: ignoreToken,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    }\n};\n\n//Parser\nclass Parser {\n    constructor(options) {\n        this.options = mergeOptions(DEFAULT_OPTIONS, options);\n\n        this.treeAdapter = this.options.treeAdapter;\n        this.pendingScript = null;\n\n        if (this.options.sourceCodeLocationInfo) {\n            Mixin.install(this, LocationInfoParserMixin);\n        }\n\n        if (this.options.onParseError) {\n            Mixin.install(this, ErrorReportingParserMixin, { onParseError: this.options.onParseError });\n        }\n    }\n\n    // API\n    parse(html) {\n        const document = this.treeAdapter.createDocument();\n\n        this._bootstrap(document, null);\n        this.tokenizer.write(html, true);\n        this._runParsingLoop(null);\n\n        return document;\n    }\n\n    parseFragment(html, fragmentContext) {\n        //NOTE: use <template> element as a fragment context if context element was not provided,\n        //so we will parse in \"forgiving\" manner\n        if (!fragmentContext) {\n            fragmentContext = this.treeAdapter.createElement($.TEMPLATE, NS.HTML, []);\n        }\n\n        //NOTE: create fake element which will be used as 'document' for fragment parsing.\n        //This is important for jsdom there 'document' can't be recreated, therefore\n        //fragment parsing causes messing of the main `document`.\n        const documentMock = this.treeAdapter.createElement('documentmock', NS.HTML, []);\n\n        this._bootstrap(documentMock, fragmentContext);\n\n        if (this.treeAdapter.getTagName(fragmentContext) === $.TEMPLATE) {\n            this._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n        }\n\n        this._initTokenizerForFragmentParsing();\n        this._insertFakeRootElement();\n        this._resetInsertionMode();\n        this._findFormInFragmentContext();\n        this.tokenizer.write(html, true);\n        this._runParsingLoop(null);\n\n        const rootElement = this.treeAdapter.getFirstChild(documentMock);\n        const fragment = this.treeAdapter.createDocumentFragment();\n\n        this._adoptNodes(rootElement, fragment);\n\n        return fragment;\n    }\n\n    //Bootstrap parser\n    _bootstrap(document, fragmentContext) {\n        this.tokenizer = new Tokenizer(this.options);\n\n        this.stopped = false;\n\n        this.insertionMode = INITIAL_MODE;\n        this.originalInsertionMode = '';\n\n        this.document = document;\n        this.fragmentContext = fragmentContext;\n\n        this.headElement = null;\n        this.formElement = null;\n\n        this.openElements = new OpenElementStack(this.document, this.treeAdapter);\n        this.activeFormattingElements = new FormattingElementList(this.treeAdapter);\n\n        this.tmplInsertionModeStack = [];\n        this.tmplInsertionModeStackTop = -1;\n        this.currentTmplInsertionMode = null;\n\n        this.pendingCharacterTokens = [];\n        this.hasNonWhitespacePendingCharacterToken = false;\n\n        this.framesetOk = true;\n        this.skipNextNewLine = false;\n        this.fosterParentingEnabled = false;\n    }\n\n    //Errors\n    _err() {\n        // NOTE: err reporting is noop by default. Enabled by mixin.\n    }\n\n    //Parsing loop\n    _runParsingLoop(scriptHandler) {\n        while (!this.stopped) {\n            this._setupTokenizerCDATAMode();\n\n            const token = this.tokenizer.getNextToken();\n\n            if (token.type === Tokenizer.HIBERNATION_TOKEN) {\n                break;\n            }\n\n            if (this.skipNextNewLine) {\n                this.skipNextNewLine = false;\n\n                if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n                    if (token.chars.length === 1) {\n                        continue;\n                    }\n\n                    token.chars = token.chars.substr(1);\n                }\n            }\n\n            this._processInputToken(token);\n\n            if (scriptHandler && this.pendingScript) {\n                break;\n            }\n        }\n    }\n\n    runParsingLoopForCurrentChunk(writeCallback, scriptHandler) {\n        this._runParsingLoop(scriptHandler);\n\n        if (scriptHandler && this.pendingScript) {\n            const script = this.pendingScript;\n\n            this.pendingScript = null;\n\n            scriptHandler(script);\n\n            return;\n        }\n\n        if (writeCallback) {\n            writeCallback();\n        }\n    }\n\n    //Text parsing\n    _setupTokenizerCDATAMode() {\n        const current = this._getAdjustedCurrentElement();\n\n        this.tokenizer.allowCDATA =\n            current &&\n            current !== this.document &&\n            this.treeAdapter.getNamespaceURI(current) !== NS.HTML &&\n            !this._isIntegrationPoint(current);\n    }\n\n    _switchToTextParsing(currentToken, nextTokenizerState) {\n        this._insertElement(currentToken, NS.HTML);\n        this.tokenizer.state = nextTokenizerState;\n        this.originalInsertionMode = this.insertionMode;\n        this.insertionMode = TEXT_MODE;\n    }\n\n    switchToPlaintextParsing() {\n        this.insertionMode = TEXT_MODE;\n        this.originalInsertionMode = IN_BODY_MODE;\n        this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n    }\n\n    //Fragment parsing\n    _getAdjustedCurrentElement() {\n        return this.openElements.stackTop === 0 && this.fragmentContext\n            ? this.fragmentContext\n            : this.openElements.current;\n    }\n\n    _findFormInFragmentContext() {\n        let node = this.fragmentContext;\n\n        do {\n            if (this.treeAdapter.getTagName(node) === $.FORM) {\n                this.formElement = node;\n                break;\n            }\n\n            node = this.treeAdapter.getParentNode(node);\n        } while (node);\n    }\n\n    _initTokenizerForFragmentParsing() {\n        if (this.treeAdapter.getNamespaceURI(this.fragmentContext) === NS.HTML) {\n            const tn = this.treeAdapter.getTagName(this.fragmentContext);\n\n            if (tn === $.TITLE || tn === $.TEXTAREA) {\n                this.tokenizer.state = Tokenizer.MODE.RCDATA;\n            } else if (\n                tn === $.STYLE ||\n                tn === $.XMP ||\n                tn === $.IFRAME ||\n                tn === $.NOEMBED ||\n                tn === $.NOFRAMES ||\n                tn === $.NOSCRIPT\n            ) {\n                this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n            } else if (tn === $.SCRIPT) {\n                this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;\n            } else if (tn === $.PLAINTEXT) {\n                this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n            }\n        }\n    }\n\n    //Tree mutation\n    _setDocumentType(token) {\n        const name = token.name || '';\n        const publicId = token.publicId || '';\n        const systemId = token.systemId || '';\n\n        this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n    }\n\n    _attachElementToTree(element) {\n        if (this._shouldFosterParentOnInsertion()) {\n            this._fosterParentElement(element);\n        } else {\n            const parent = this.openElements.currentTmplContent || this.openElements.current;\n\n            this.treeAdapter.appendChild(parent, element);\n        }\n    }\n\n    _appendElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n        this._attachElementToTree(element);\n    }\n\n    _insertElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n        this._attachElementToTree(element);\n        this.openElements.push(element);\n    }\n\n    _insertFakeElement(tagName) {\n        const element = this.treeAdapter.createElement(tagName, NS.HTML, []);\n\n        this._attachElementToTree(element);\n        this.openElements.push(element);\n    }\n\n    _insertTemplate(token) {\n        const tmpl = this.treeAdapter.createElement(token.tagName, NS.HTML, token.attrs);\n        const content = this.treeAdapter.createDocumentFragment();\n\n        this.treeAdapter.setTemplateContent(tmpl, content);\n        this._attachElementToTree(tmpl);\n        this.openElements.push(tmpl);\n    }\n\n    _insertFakeRootElement() {\n        const element = this.treeAdapter.createElement($.HTML, NS.HTML, []);\n\n        this.treeAdapter.appendChild(this.openElements.current, element);\n        this.openElements.push(element);\n    }\n\n    _appendCommentNode(token, parent) {\n        const commentNode = this.treeAdapter.createCommentNode(token.data);\n\n        this.treeAdapter.appendChild(parent, commentNode);\n    }\n\n    _insertCharacters(token) {\n        if (this._shouldFosterParentOnInsertion()) {\n            this._fosterParentText(token.chars);\n        } else {\n            const parent = this.openElements.currentTmplContent || this.openElements.current;\n\n            this.treeAdapter.insertText(parent, token.chars);\n        }\n    }\n\n    _adoptNodes(donor, recipient) {\n        for (let child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n            this.treeAdapter.detachNode(child);\n            this.treeAdapter.appendChild(recipient, child);\n        }\n    }\n\n    //Token processing\n    _shouldProcessTokenInForeignContent(token) {\n        const current = this._getAdjustedCurrentElement();\n\n        if (!current || current === this.document) {\n            return false;\n        }\n\n        const ns = this.treeAdapter.getNamespaceURI(current);\n\n        if (ns === NS.HTML) {\n            return false;\n        }\n\n        if (\n            this.treeAdapter.getTagName(current) === $.ANNOTATION_XML &&\n            ns === NS.MATHML &&\n            token.type === Tokenizer.START_TAG_TOKEN &&\n            token.tagName === $.SVG\n        ) {\n            return false;\n        }\n\n        const isCharacterToken =\n            token.type === Tokenizer.CHARACTER_TOKEN ||\n            token.type === Tokenizer.NULL_CHARACTER_TOKEN ||\n            token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN;\n\n        const isMathMLTextStartTag =\n            token.type === Tokenizer.START_TAG_TOKEN && token.tagName !== $.MGLYPH && token.tagName !== $.MALIGNMARK;\n\n        if ((isMathMLTextStartTag || isCharacterToken) && this._isIntegrationPoint(current, NS.MATHML)) {\n            return false;\n        }\n\n        if (\n            (token.type === Tokenizer.START_TAG_TOKEN || isCharacterToken) &&\n            this._isIntegrationPoint(current, NS.HTML)\n        ) {\n            return false;\n        }\n\n        return token.type !== Tokenizer.EOF_TOKEN;\n    }\n\n    _processToken(token) {\n        TOKEN_HANDLERS[this.insertionMode][token.type](this, token);\n    }\n\n    _processTokenInBodyMode(token) {\n        TOKEN_HANDLERS[IN_BODY_MODE][token.type](this, token);\n    }\n\n    _processTokenInForeignContent(token) {\n        if (token.type === Tokenizer.CHARACTER_TOKEN) {\n            characterInForeignContent(this, token);\n        } else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\n            nullCharacterInForeignContent(this, token);\n        } else if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN) {\n            insertCharacters(this, token);\n        } else if (token.type === Tokenizer.COMMENT_TOKEN) {\n            appendComment(this, token);\n        } else if (token.type === Tokenizer.START_TAG_TOKEN) {\n            startTagInForeignContent(this, token);\n        } else if (token.type === Tokenizer.END_TAG_TOKEN) {\n            endTagInForeignContent(this, token);\n        }\n    }\n\n    _processInputToken(token) {\n        if (this._shouldProcessTokenInForeignContent(token)) {\n            this._processTokenInForeignContent(token);\n        } else {\n            this._processToken(token);\n        }\n\n        if (token.type === Tokenizer.START_TAG_TOKEN && token.selfClosing && !token.ackSelfClosing) {\n            this._err(ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n        }\n    }\n\n    //Integration points\n    _isIntegrationPoint(element, foreignNS) {\n        const tn = this.treeAdapter.getTagName(element);\n        const ns = this.treeAdapter.getNamespaceURI(element);\n        const attrs = this.treeAdapter.getAttrList(element);\n\n        return foreignContent.isIntegrationPoint(tn, ns, attrs, foreignNS);\n    }\n\n    //Active formatting elements reconstruction\n    _reconstructActiveFormattingElements() {\n        const listLength = this.activeFormattingElements.length;\n\n        if (listLength) {\n            let unopenIdx = listLength;\n            let entry = null;\n\n            do {\n                unopenIdx--;\n                entry = this.activeFormattingElements.entries[unopenIdx];\n\n                if (entry.type === FormattingElementList.MARKER_ENTRY || this.openElements.contains(entry.element)) {\n                    unopenIdx++;\n                    break;\n                }\n            } while (unopenIdx > 0);\n\n            for (let i = unopenIdx; i < listLength; i++) {\n                entry = this.activeFormattingElements.entries[i];\n                this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n                entry.element = this.openElements.current;\n            }\n        }\n    }\n\n    //Close elements\n    _closeTableCell() {\n        this.openElements.generateImpliedEndTags();\n        this.openElements.popUntilTableCellPopped();\n        this.activeFormattingElements.clearToLastMarker();\n        this.insertionMode = IN_ROW_MODE;\n    }\n\n    _closePElement() {\n        this.openElements.generateImpliedEndTagsWithExclusion($.P);\n        this.openElements.popUntilTagNamePopped($.P);\n    }\n\n    //Insertion modes\n    _resetInsertionMode() {\n        for (let i = this.openElements.stackTop, last = false; i >= 0; i--) {\n            let element = this.openElements.items[i];\n\n            if (i === 0) {\n                last = true;\n\n                if (this.fragmentContext) {\n                    element = this.fragmentContext;\n                }\n            }\n\n            const tn = this.treeAdapter.getTagName(element);\n            const newInsertionMode = INSERTION_MODE_RESET_MAP[tn];\n\n            if (newInsertionMode) {\n                this.insertionMode = newInsertionMode;\n                break;\n            } else if (!last && (tn === $.TD || tn === $.TH)) {\n                this.insertionMode = IN_CELL_MODE;\n                break;\n            } else if (!last && tn === $.HEAD) {\n                this.insertionMode = IN_HEAD_MODE;\n                break;\n            } else if (tn === $.SELECT) {\n                this._resetInsertionModeForSelect(i);\n                break;\n            } else if (tn === $.TEMPLATE) {\n                this.insertionMode = this.currentTmplInsertionMode;\n                break;\n            } else if (tn === $.HTML) {\n                this.insertionMode = this.headElement ? AFTER_HEAD_MODE : BEFORE_HEAD_MODE;\n                break;\n            } else if (last) {\n                this.insertionMode = IN_BODY_MODE;\n                break;\n            }\n        }\n    }\n\n    _resetInsertionModeForSelect(selectIdx) {\n        if (selectIdx > 0) {\n            for (let i = selectIdx - 1; i > 0; i--) {\n                const ancestor = this.openElements.items[i];\n                const tn = this.treeAdapter.getTagName(ancestor);\n\n                if (tn === $.TEMPLATE) {\n                    break;\n                } else if (tn === $.TABLE) {\n                    this.insertionMode = IN_SELECT_IN_TABLE_MODE;\n                    return;\n                }\n            }\n        }\n\n        this.insertionMode = IN_SELECT_MODE;\n    }\n\n    _pushTmplInsertionMode(mode) {\n        this.tmplInsertionModeStack.push(mode);\n        this.tmplInsertionModeStackTop++;\n        this.currentTmplInsertionMode = mode;\n    }\n\n    _popTmplInsertionMode() {\n        this.tmplInsertionModeStack.pop();\n        this.tmplInsertionModeStackTop--;\n        this.currentTmplInsertionMode = this.tmplInsertionModeStack[this.tmplInsertionModeStackTop];\n    }\n\n    //Foster parenting\n    _isElementCausesFosterParenting(element) {\n        const tn = this.treeAdapter.getTagName(element);\n\n        return tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR;\n    }\n\n    _shouldFosterParentOnInsertion() {\n        return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.current);\n    }\n\n    _findFosterParentingLocation() {\n        const location = {\n            parent: null,\n            beforeElement: null\n        };\n\n        for (let i = this.openElements.stackTop; i >= 0; i--) {\n            const openElement = this.openElements.items[i];\n            const tn = this.treeAdapter.getTagName(openElement);\n            const ns = this.treeAdapter.getNamespaceURI(openElement);\n\n            if (tn === $.TEMPLATE && ns === NS.HTML) {\n                location.parent = this.treeAdapter.getTemplateContent(openElement);\n                break;\n            } else if (tn === $.TABLE) {\n                location.parent = this.treeAdapter.getParentNode(openElement);\n\n                if (location.parent) {\n                    location.beforeElement = openElement;\n                } else {\n                    location.parent = this.openElements.items[i - 1];\n                }\n\n                break;\n            }\n        }\n\n        if (!location.parent) {\n            location.parent = this.openElements.items[0];\n        }\n\n        return location;\n    }\n\n    _fosterParentElement(element) {\n        const location = this._findFosterParentingLocation();\n\n        if (location.beforeElement) {\n            this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n        } else {\n            this.treeAdapter.appendChild(location.parent, element);\n        }\n    }\n\n    _fosterParentText(chars) {\n        const location = this._findFosterParentingLocation();\n\n        if (location.beforeElement) {\n            this.treeAdapter.insertTextBefore(location.parent, chars, location.beforeElement);\n        } else {\n            this.treeAdapter.insertText(location.parent, chars);\n        }\n    }\n\n    //Special elements\n    _isSpecialElement(element) {\n        const tn = this.treeAdapter.getTagName(element);\n        const ns = this.treeAdapter.getNamespaceURI(element);\n\n        return HTML.SPECIAL_ELEMENTS[ns][tn];\n    }\n}\n\nmodule.exports = Parser;\n\n//Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n\n//Steps 5-8 of the algorithm\nfunction aaObtainFormattingElementEntry(p, token) {\n    let formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n\n    if (formattingElementEntry) {\n        if (!p.openElements.contains(formattingElementEntry.element)) {\n            p.activeFormattingElements.removeEntry(formattingElementEntry);\n            formattingElementEntry = null;\n        } else if (!p.openElements.hasInScope(token.tagName)) {\n            formattingElementEntry = null;\n        }\n    } else {\n        genericEndTagInBody(p, token);\n    }\n\n    return formattingElementEntry;\n}\n\n//Steps 9 and 10 of the algorithm\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n    let furthestBlock = null;\n\n    for (let i = p.openElements.stackTop; i >= 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (element === formattingElementEntry.element) {\n            break;\n        }\n\n        if (p._isSpecialElement(element)) {\n            furthestBlock = element;\n        }\n    }\n\n    if (!furthestBlock) {\n        p.openElements.popUntilElementPopped(formattingElementEntry.element);\n        p.activeFormattingElements.removeEntry(formattingElementEntry);\n    }\n\n    return furthestBlock;\n}\n\n//Step 13 of the algorithm\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n    let lastElement = furthestBlock;\n    let nextElement = p.openElements.getCommonAncestor(furthestBlock);\n\n    for (let i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n        //NOTE: store next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n        nextElement = p.openElements.getCommonAncestor(element);\n\n        const elementEntry = p.activeFormattingElements.getElementEntry(element);\n        const counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n        const shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n\n        if (shouldRemoveFromOpenElements) {\n            if (counterOverflow) {\n                p.activeFormattingElements.removeEntry(elementEntry);\n            }\n\n            p.openElements.remove(element);\n        } else {\n            element = aaRecreateElementFromEntry(p, elementEntry);\n\n            if (lastElement === furthestBlock) {\n                p.activeFormattingElements.bookmark = elementEntry;\n            }\n\n            p.treeAdapter.detachNode(lastElement);\n            p.treeAdapter.appendChild(element, lastElement);\n            lastElement = element;\n        }\n    }\n\n    return lastElement;\n}\n\n//Step 13.7 of the algorithm\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n    const newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n\n    p.openElements.replace(elementEntry.element, newElement);\n    elementEntry.element = newElement;\n\n    return newElement;\n}\n\n//Step 14 of the algorithm\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n    if (p._isElementCausesFosterParenting(commonAncestor)) {\n        p._fosterParentElement(lastElement);\n    } else {\n        const tn = p.treeAdapter.getTagName(commonAncestor);\n        const ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n\n        if (tn === $.TEMPLATE && ns === NS.HTML) {\n            commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n        }\n\n        p.treeAdapter.appendChild(commonAncestor, lastElement);\n    }\n}\n\n//Steps 15-19 of the algorithm\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n    const token = formattingElementEntry.token;\n    const newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n\n    p._adoptNodes(furthestBlock, newElement);\n    p.treeAdapter.appendChild(furthestBlock, newElement);\n\n    p.activeFormattingElements.insertElementAfterBookmark(newElement, formattingElementEntry.token);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n\n    p.openElements.remove(formattingElementEntry.element);\n    p.openElements.insertAfter(furthestBlock, newElement);\n}\n\n//Algorithm entry point\nfunction callAdoptionAgency(p, token) {\n    let formattingElementEntry;\n\n    for (let i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n        formattingElementEntry = aaObtainFormattingElementEntry(p, token, formattingElementEntry);\n\n        if (!formattingElementEntry) {\n            break;\n        }\n\n        const furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n\n        if (!furthestBlock) {\n            break;\n        }\n\n        p.activeFormattingElements.bookmark = formattingElementEntry;\n\n        const lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n        const commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n\n        p.treeAdapter.detachNode(lastElement);\n        aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n        aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n    }\n}\n\n//Generic token handlers\n//------------------------------------------------------------------\nfunction ignoreToken() {\n    //NOTE: do nothing =)\n}\n\nfunction misplacedDoctype(p) {\n    p._err(ERR.misplacedDoctype);\n}\n\nfunction appendComment(p, token) {\n    p._appendCommentNode(token, p.openElements.currentTmplContent || p.openElements.current);\n}\n\nfunction appendCommentToRootHtmlElement(p, token) {\n    p._appendCommentNode(token, p.openElements.items[0]);\n}\n\nfunction appendCommentToDocument(p, token) {\n    p._appendCommentNode(token, p.document);\n}\n\nfunction insertCharacters(p, token) {\n    p._insertCharacters(token);\n}\n\nfunction stopParsing(p) {\n    p.stopped = true;\n}\n\n// The \"initial\" insertion mode\n//------------------------------------------------------------------\nfunction doctypeInInitialMode(p, token) {\n    p._setDocumentType(token);\n\n    const mode = token.forceQuirks ? HTML.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n\n    if (!doctype.isConforming(token)) {\n        p._err(ERR.nonConformingDoctype);\n    }\n\n    p.treeAdapter.setDocumentMode(p.document, mode);\n\n    p.insertionMode = BEFORE_HTML_MODE;\n}\n\nfunction tokenInInitialMode(p, token) {\n    p._err(ERR.missingDoctype, { beforeToken: true });\n    p.treeAdapter.setDocumentMode(p.document, HTML.DOCUMENT_MODE.QUIRKS);\n    p.insertionMode = BEFORE_HTML_MODE;\n    p._processToken(token);\n}\n\n// The \"before html\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHtml(p, token) {\n    if (token.tagName === $.HTML) {\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = BEFORE_HEAD_MODE;\n    } else {\n        tokenBeforeHtml(p, token);\n    }\n}\n\nfunction endTagBeforeHtml(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML || tn === $.HEAD || tn === $.BODY || tn === $.BR) {\n        tokenBeforeHtml(p, token);\n    }\n}\n\nfunction tokenBeforeHtml(p, token) {\n    p._insertFakeRootElement();\n    p.insertionMode = BEFORE_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"before head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.HEAD) {\n        p._insertElement(token, NS.HTML);\n        p.headElement = p.openElements.current;\n        p.insertionMode = IN_HEAD_MODE;\n    } else {\n        tokenBeforeHead(p, token);\n    }\n}\n\nfunction endTagBeforeHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HEAD || tn === $.BODY || tn === $.HTML || tn === $.BR) {\n        tokenBeforeHead(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenBeforeHead(p, token) {\n    p._insertFakeElement($.HEAD);\n    p.headElement = p.openElements.current;\n    p.insertionMode = IN_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"in head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.TITLE) {\n        p._switchToTextParsing(token, Tokenizer.MODE.RCDATA);\n    } else if (tn === $.NOSCRIPT) {\n        if (p.options.scriptingEnabled) {\n            p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n        } else {\n            p._insertElement(token, NS.HTML);\n            p.insertionMode = IN_HEAD_NO_SCRIPT_MODE;\n        }\n    } else if (tn === $.NOFRAMES || tn === $.STYLE) {\n        p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n    } else if (tn === $.SCRIPT) {\n        p._switchToTextParsing(token, Tokenizer.MODE.SCRIPT_DATA);\n    } else if (tn === $.TEMPLATE) {\n        p._insertTemplate(token, NS.HTML);\n        p.activeFormattingElements.insertMarker();\n        p.framesetOk = false;\n        p.insertionMode = IN_TEMPLATE_MODE;\n        p._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n    } else if (tn === $.HEAD) {\n        p._err(ERR.misplacedStartTagForHeadElement);\n    } else {\n        tokenInHead(p, token);\n    }\n}\n\nfunction endTagInHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HEAD) {\n        p.openElements.pop();\n        p.insertionMode = AFTER_HEAD_MODE;\n    } else if (tn === $.BODY || tn === $.BR || tn === $.HTML) {\n        tokenInHead(p, token);\n    } else if (tn === $.TEMPLATE) {\n        if (p.openElements.tmplCount > 0) {\n            p.openElements.generateImpliedEndTagsThoroughly();\n\n            if (p.openElements.currentTagName !== $.TEMPLATE) {\n                p._err(ERR.closingOfElementWithOpenChildElements);\n            }\n\n            p.openElements.popUntilTagNamePopped($.TEMPLATE);\n            p.activeFormattingElements.clearToLastMarker();\n            p._popTmplInsertionMode();\n            p._resetInsertionMode();\n        } else {\n            p._err(ERR.endTagWithoutMatchingOpenElement);\n        }\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenInHead(p, token) {\n    p.openElements.pop();\n    p.insertionMode = AFTER_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"in head no script\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHeadNoScript(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.HEAD ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.STYLE\n    ) {\n        startTagInHead(p, token);\n    } else if (tn === $.NOSCRIPT) {\n        p._err(ERR.nestedNoscriptInHead);\n    } else {\n        tokenInHeadNoScript(p, token);\n    }\n}\n\nfunction endTagInHeadNoScript(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.NOSCRIPT) {\n        p.openElements.pop();\n        p.insertionMode = IN_HEAD_MODE;\n    } else if (tn === $.BR) {\n        tokenInHeadNoScript(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenInHeadNoScript(p, token) {\n    const errCode =\n        token.type === Tokenizer.EOF_TOKEN ? ERR.openElementsLeftAfterEof : ERR.disallowedContentInNoscriptInHead;\n\n    p._err(errCode);\n    p.openElements.pop();\n    p.insertionMode = IN_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"after head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.BODY) {\n        p._insertElement(token, NS.HTML);\n        p.framesetOk = false;\n        p.insertionMode = IN_BODY_MODE;\n    } else if (tn === $.FRAMESET) {\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_FRAMESET_MODE;\n    } else if (\n        tn === $.BASE ||\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.SCRIPT ||\n        tn === $.STYLE ||\n        tn === $.TEMPLATE ||\n        tn === $.TITLE\n    ) {\n        p._err(ERR.abandonedHeadElementChild);\n        p.openElements.push(p.headElement);\n        startTagInHead(p, token);\n        p.openElements.remove(p.headElement);\n    } else if (tn === $.HEAD) {\n        p._err(ERR.misplacedStartTagForHeadElement);\n    } else {\n        tokenAfterHead(p, token);\n    }\n}\n\nfunction endTagAfterHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.BODY || tn === $.HTML || tn === $.BR) {\n        tokenAfterHead(p, token);\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenAfterHead(p, token) {\n    p._insertFakeElement($.BODY);\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"in body\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n}\n\nfunction characterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\n\nfunction htmlStartTagInBody(p, token) {\n    if (p.openElements.tmplCount === 0) {\n        p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n    }\n}\n\nfunction bodyStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n    if (bodyElement && p.openElements.tmplCount === 0) {\n        p.framesetOk = false;\n        p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n    }\n}\n\nfunction framesetStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n    if (p.framesetOk && bodyElement) {\n        p.treeAdapter.detachNode(bodyElement);\n        p.openElements.popAllUpToHtmlElement();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_FRAMESET_MODE;\n    }\n}\n\nfunction addressStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction numberedHeaderStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    const tn = p.openElements.currentTagName;\n\n    if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction preStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.framesetOk = false;\n}\n\nfunction formStartTagInBody(p, token) {\n    const inTemplate = p.openElements.tmplCount > 0;\n\n    if (!p.formElement || inTemplate) {\n        if (p.openElements.hasInButtonScope($.P)) {\n            p._closePElement();\n        }\n\n        p._insertElement(token, NS.HTML);\n\n        if (!inTemplate) {\n            p.formElement = p.openElements.current;\n        }\n    }\n}\n\nfunction listItemStartTagInBody(p, token) {\n    p.framesetOk = false;\n\n    const tn = token.tagName;\n\n    for (let i = p.openElements.stackTop; i >= 0; i--) {\n        const element = p.openElements.items[i];\n        const elementTn = p.treeAdapter.getTagName(element);\n        let closeTn = null;\n\n        if (tn === $.LI && elementTn === $.LI) {\n            closeTn = $.LI;\n        } else if ((tn === $.DD || tn === $.DT) && (elementTn === $.DD || elementTn === $.DT)) {\n            closeTn = elementTn;\n        }\n\n        if (closeTn) {\n            p.openElements.generateImpliedEndTagsWithExclusion(closeTn);\n            p.openElements.popUntilTagNamePopped(closeTn);\n            break;\n        }\n\n        if (elementTn !== $.ADDRESS && elementTn !== $.DIV && elementTn !== $.P && p._isSpecialElement(element)) {\n            break;\n        }\n    }\n\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction plaintextStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n}\n\nfunction buttonStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.BUTTON)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped($.BUTTON);\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n}\n\nfunction aStartTagInBody(p, token) {\n    const activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName($.A);\n\n    if (activeElementEntry) {\n        callAdoptionAgency(p, token);\n        p.openElements.remove(activeElementEntry.element);\n        p.activeFormattingElements.removeEntry(activeElementEntry);\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction bStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction nobrStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    if (p.openElements.hasInScope($.NOBR)) {\n        callAdoptionAgency(p, token);\n        p._reconstructActiveFormattingElements();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction appletStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.insertMarker();\n    p.framesetOk = false;\n}\n\nfunction tableStartTagInBody(p, token) {\n    if (\n        p.treeAdapter.getDocumentMode(p.document) !== HTML.DOCUMENT_MODE.QUIRKS &&\n        p.openElements.hasInButtonScope($.P)\n    ) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n    p.insertionMode = IN_TABLE_MODE;\n}\n\nfunction areaStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\n\nfunction inputStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, NS.HTML);\n\n    const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n    if (!inputType || inputType.toLowerCase() !== HIDDEN_INPUT_TYPE) {\n        p.framesetOk = false;\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction paramStartTagInBody(p, token) {\n    p._appendElement(token, NS.HTML);\n    token.ackSelfClosing = true;\n}\n\nfunction hrStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._appendElement(token, NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\n\nfunction imageStartTagInBody(p, token) {\n    token.tagName = $.IMG;\n    areaStartTagInBody(p, token);\n}\n\nfunction textareaStartTagInBody(p, token) {\n    p._insertElement(token, NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.tokenizer.state = Tokenizer.MODE.RCDATA;\n    p.originalInsertionMode = p.insertionMode;\n    p.framesetOk = false;\n    p.insertionMode = TEXT_MODE;\n}\n\nfunction xmpStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._reconstructActiveFormattingElements();\n    p.framesetOk = false;\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction iframeStartTagInBody(p, token) {\n    p.framesetOk = false;\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\n//NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as a rawtext.\nfunction noembedStartTagInBody(p, token) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction selectStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n\n    if (\n        p.insertionMode === IN_TABLE_MODE ||\n        p.insertionMode === IN_CAPTION_MODE ||\n        p.insertionMode === IN_TABLE_BODY_MODE ||\n        p.insertionMode === IN_ROW_MODE ||\n        p.insertionMode === IN_CELL_MODE\n    ) {\n        p.insertionMode = IN_SELECT_IN_TABLE_MODE;\n    } else {\n        p.insertionMode = IN_SELECT_MODE;\n    }\n}\n\nfunction optgroupStartTagInBody(p, token) {\n    if (p.openElements.currentTagName === $.OPTION) {\n        p.openElements.pop();\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n}\n\nfunction rbStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.RUBY)) {\n        p.openElements.generateImpliedEndTags();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction rtStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.RUBY)) {\n        p.openElements.generateImpliedEndTagsWithExclusion($.RTC);\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction menuStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction mathStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    foreignContent.adjustTokenMathMLAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n        p._appendElement(token, NS.MATHML);\n    } else {\n        p._insertElement(token, NS.MATHML);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction svgStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    foreignContent.adjustTokenSVGAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n        p._appendElement(token, NS.SVG);\n    } else {\n        p._insertElement(token, NS.SVG);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction genericStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n}\n\n//OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\nfunction startTagInBody(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 1:\n            if (tn === $.I || tn === $.S || tn === $.B || tn === $.U) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.P) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.A) {\n                aStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 2:\n            if (tn === $.DL || tn === $.OL || tn === $.UL) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n                numberedHeaderStartTagInBody(p, token);\n            } else if (tn === $.LI || tn === $.DD || tn === $.DT) {\n                listItemStartTagInBody(p, token);\n            } else if (tn === $.EM || tn === $.TT) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.BR) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.HR) {\n                hrStartTagInBody(p, token);\n            } else if (tn === $.RB) {\n                rbStartTagInBody(p, token);\n            } else if (tn === $.RT || tn === $.RP) {\n                rtStartTagInBody(p, token);\n            } else if (tn !== $.TH && tn !== $.TD && tn !== $.TR) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.DIV || tn === $.DIR || tn === $.NAV) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.PRE) {\n                preStartTagInBody(p, token);\n            } else if (tn === $.BIG) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.IMG || tn === $.WBR) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.XMP) {\n                xmpStartTagInBody(p, token);\n            } else if (tn === $.SVG) {\n                svgStartTagInBody(p, token);\n            } else if (tn === $.RTC) {\n                rbStartTagInBody(p, token);\n            } else if (tn !== $.COL) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.HTML) {\n                htmlStartTagInBody(p, token);\n            } else if (tn === $.BASE || tn === $.LINK || tn === $.META) {\n                startTagInHead(p, token);\n            } else if (tn === $.BODY) {\n                bodyStartTagInBody(p, token);\n            } else if (tn === $.MAIN || tn === $.MENU) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.FORM) {\n                formStartTagInBody(p, token);\n            } else if (tn === $.CODE || tn === $.FONT) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.NOBR) {\n                nobrStartTagInBody(p, token);\n            } else if (tn === $.AREA) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.MATH) {\n                mathStartTagInBody(p, token);\n            } else if (tn === $.MENU) {\n                menuStartTagInBody(p, token);\n            } else if (tn !== $.HEAD) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.STYLE || tn === $.TITLE) {\n                startTagInHead(p, token);\n            } else if (tn === $.ASIDE) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.SMALL) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.TABLE) {\n                tableStartTagInBody(p, token);\n            } else if (tn === $.EMBED) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.INPUT) {\n                inputStartTagInBody(p, token);\n            } else if (tn === $.PARAM || tn === $.TRACK) {\n                paramStartTagInBody(p, token);\n            } else if (tn === $.IMAGE) {\n                imageStartTagInBody(p, token);\n            } else if (tn !== $.FRAME && tn !== $.TBODY && tn !== $.TFOOT && tn !== $.THEAD) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (tn === $.SCRIPT) {\n                startTagInHead(p, token);\n            } else if (\n                tn === $.CENTER ||\n                tn === $.FIGURE ||\n                tn === $.FOOTER ||\n                tn === $.HEADER ||\n                tn === $.HGROUP ||\n                tn === $.DIALOG\n            ) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.BUTTON) {\n                buttonStartTagInBody(p, token);\n            } else if (tn === $.STRIKE || tn === $.STRONG) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.APPLET || tn === $.OBJECT) {\n                appletStartTagInBody(p, token);\n            } else if (tn === $.KEYGEN) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.SOURCE) {\n                paramStartTagInBody(p, token);\n            } else if (tn === $.IFRAME) {\n                iframeStartTagInBody(p, token);\n            } else if (tn === $.SELECT) {\n                selectStartTagInBody(p, token);\n            } else if (tn === $.OPTION) {\n                optgroupStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (tn === $.BGSOUND) {\n                startTagInHead(p, token);\n            } else if (\n                tn === $.DETAILS ||\n                tn === $.ADDRESS ||\n                tn === $.ARTICLE ||\n                tn === $.SECTION ||\n                tn === $.SUMMARY\n            ) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.LISTING) {\n                preStartTagInBody(p, token);\n            } else if (tn === $.MARQUEE) {\n                appletStartTagInBody(p, token);\n            } else if (tn === $.NOEMBED) {\n                noembedStartTagInBody(p, token);\n            } else if (tn !== $.CAPTION) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.BASEFONT) {\n                startTagInHead(p, token);\n            } else if (tn === $.FRAMESET) {\n                framesetStartTagInBody(p, token);\n            } else if (tn === $.FIELDSET) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.TEXTAREA) {\n                textareaStartTagInBody(p, token);\n            } else if (tn === $.TEMPLATE) {\n                startTagInHead(p, token);\n            } else if (tn === $.NOSCRIPT) {\n                if (p.options.scriptingEnabled) {\n                    noembedStartTagInBody(p, token);\n                } else {\n                    genericStartTagInBody(p, token);\n                }\n            } else if (tn === $.OPTGROUP) {\n                optgroupStartTagInBody(p, token);\n            } else if (tn !== $.COLGROUP) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 9:\n            if (tn === $.PLAINTEXT) {\n                plaintextStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 10:\n            if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n                addressStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        default:\n            genericStartTagInBody(p, token);\n    }\n}\n\nfunction bodyEndTagInBody(p) {\n    if (p.openElements.hasInScope($.BODY)) {\n        p.insertionMode = AFTER_BODY_MODE;\n    }\n}\n\nfunction htmlEndTagInBody(p, token) {\n    if (p.openElements.hasInScope($.BODY)) {\n        p.insertionMode = AFTER_BODY_MODE;\n        p._processToken(token);\n    }\n}\n\nfunction addressEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\n\nfunction formEndTagInBody(p) {\n    const inTemplate = p.openElements.tmplCount > 0;\n    const formElement = p.formElement;\n\n    if (!inTemplate) {\n        p.formElement = null;\n    }\n\n    if ((formElement || inTemplate) && p.openElements.hasInScope($.FORM)) {\n        p.openElements.generateImpliedEndTags();\n\n        if (inTemplate) {\n            p.openElements.popUntilTagNamePopped($.FORM);\n        } else {\n            p.openElements.remove(formElement);\n        }\n    }\n}\n\nfunction pEndTagInBody(p) {\n    if (!p.openElements.hasInButtonScope($.P)) {\n        p._insertFakeElement($.P);\n    }\n\n    p._closePElement();\n}\n\nfunction liEndTagInBody(p) {\n    if (p.openElements.hasInListItemScope($.LI)) {\n        p.openElements.generateImpliedEndTagsWithExclusion($.LI);\n        p.openElements.popUntilTagNamePopped($.LI);\n    }\n}\n\nfunction ddEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTagsWithExclusion(tn);\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\n\nfunction numberedHeaderEndTagInBody(p) {\n    if (p.openElements.hasNumberedHeaderInScope()) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilNumberedHeaderPopped();\n    }\n}\n\nfunction appletEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n        p.activeFormattingElements.clearToLastMarker();\n    }\n}\n\nfunction brEndTagInBody(p) {\n    p._reconstructActiveFormattingElements();\n    p._insertFakeElement($.BR);\n    p.openElements.pop();\n    p.framesetOk = false;\n}\n\nfunction genericEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (p.treeAdapter.getTagName(element) === tn) {\n            p.openElements.generateImpliedEndTagsWithExclusion(tn);\n            p.openElements.popUntilElementPopped(element);\n            break;\n        }\n\n        if (p._isSpecialElement(element)) {\n            break;\n        }\n    }\n}\n\n//OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\nfunction endTagInBody(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 1:\n            if (tn === $.A || tn === $.B || tn === $.I || tn === $.S || tn === $.U) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.P) {\n                pEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 2:\n            if (tn === $.DL || tn === $.UL || tn === $.OL) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.LI) {\n                liEndTagInBody(p, token);\n            } else if (tn === $.DD || tn === $.DT) {\n                ddEndTagInBody(p, token);\n            } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n                numberedHeaderEndTagInBody(p, token);\n            } else if (tn === $.BR) {\n                brEndTagInBody(p, token);\n            } else if (tn === $.EM || tn === $.TT) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.BIG) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.DIR || tn === $.DIV || tn === $.NAV || tn === $.PRE) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.BODY) {\n                bodyEndTagInBody(p, token);\n            } else if (tn === $.HTML) {\n                htmlEndTagInBody(p, token);\n            } else if (tn === $.FORM) {\n                formEndTagInBody(p, token);\n            } else if (tn === $.CODE || tn === $.FONT || tn === $.NOBR) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.MAIN || tn === $.MENU) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.ASIDE) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.SMALL) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (\n                tn === $.CENTER ||\n                tn === $.FIGURE ||\n                tn === $.FOOTER ||\n                tn === $.HEADER ||\n                tn === $.HGROUP ||\n                tn === $.DIALOG\n            ) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.APPLET || tn === $.OBJECT) {\n                appletEndTagInBody(p, token);\n            } else if (tn === $.STRIKE || tn === $.STRONG) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (\n                tn === $.ADDRESS ||\n                tn === $.ARTICLE ||\n                tn === $.DETAILS ||\n                tn === $.SECTION ||\n                tn === $.SUMMARY ||\n                tn === $.LISTING\n            ) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.MARQUEE) {\n                appletEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.FIELDSET) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.TEMPLATE) {\n                endTagInHead(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 10:\n            if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        default:\n            genericEndTagInBody(p, token);\n    }\n}\n\nfunction eofInBody(p, token) {\n    if (p.tmplInsertionModeStackTop > -1) {\n        eofInTemplate(p, token);\n    } else {\n        p.stopped = true;\n    }\n}\n\n// The \"text\" insertion mode\n//------------------------------------------------------------------\nfunction endTagInText(p, token) {\n    if (token.tagName === $.SCRIPT) {\n        p.pendingScript = p.openElements.current;\n    }\n\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n}\n\nfunction eofInText(p, token) {\n    p._err(ERR.eofInElementThatCanContainOnlyText);\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n    p._processToken(token);\n}\n\n// The \"in table\" insertion mode\n//------------------------------------------------------------------\nfunction characterInTable(p, token) {\n    const curTn = p.openElements.currentTagName;\n\n    if (curTn === $.TABLE || curTn === $.TBODY || curTn === $.TFOOT || curTn === $.THEAD || curTn === $.TR) {\n        p.pendingCharacterTokens = [];\n        p.hasNonWhitespacePendingCharacterToken = false;\n        p.originalInsertionMode = p.insertionMode;\n        p.insertionMode = IN_TABLE_TEXT_MODE;\n        p._processToken(token);\n    } else {\n        tokenInTable(p, token);\n    }\n}\n\nfunction captionStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p.activeFormattingElements.insertMarker();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_CAPTION_MODE;\n}\n\nfunction colgroupStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_COLUMN_GROUP_MODE;\n}\n\nfunction colStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement($.COLGROUP);\n    p.insertionMode = IN_COLUMN_GROUP_MODE;\n    p._processToken(token);\n}\n\nfunction tbodyStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_TABLE_BODY_MODE;\n}\n\nfunction tdStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement($.TBODY);\n    p.insertionMode = IN_TABLE_BODY_MODE;\n    p._processToken(token);\n}\n\nfunction tableStartTagInTable(p, token) {\n    if (p.openElements.hasInTableScope($.TABLE)) {\n        p.openElements.popUntilTagNamePopped($.TABLE);\n        p._resetInsertionMode();\n        p._processToken(token);\n    }\n}\n\nfunction inputStartTagInTable(p, token) {\n    const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n    if (inputType && inputType.toLowerCase() === HIDDEN_INPUT_TYPE) {\n        p._appendElement(token, NS.HTML);\n    } else {\n        tokenInTable(p, token);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction formStartTagInTable(p, token) {\n    if (!p.formElement && p.openElements.tmplCount === 0) {\n        p._insertElement(token, NS.HTML);\n        p.formElement = p.openElements.current;\n        p.openElements.pop();\n    }\n}\n\nfunction startTagInTable(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 2:\n            if (tn === $.TD || tn === $.TH || tn === $.TR) {\n                tdStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.COL) {\n                colStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.FORM) {\n                formStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.TABLE) {\n                tableStartTagInTable(p, token);\n            } else if (tn === $.STYLE) {\n                startTagInHead(p, token);\n            } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n                tbodyStartTagInTable(p, token);\n            } else if (tn === $.INPUT) {\n                inputStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (tn === $.SCRIPT) {\n                startTagInHead(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (tn === $.CAPTION) {\n                captionStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.COLGROUP) {\n                colgroupStartTagInTable(p, token);\n            } else if (tn === $.TEMPLATE) {\n                startTagInHead(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        default:\n            tokenInTable(p, token);\n    }\n}\n\nfunction endTagInTable(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.TABLE)) {\n            p.openElements.popUntilTagNamePopped($.TABLE);\n            p._resetInsertionMode();\n        }\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else if (\n        tn !== $.BODY &&\n        tn !== $.CAPTION &&\n        tn !== $.COL &&\n        tn !== $.COLGROUP &&\n        tn !== $.HTML &&\n        tn !== $.TBODY &&\n        tn !== $.TD &&\n        tn !== $.TFOOT &&\n        tn !== $.TH &&\n        tn !== $.THEAD &&\n        tn !== $.TR\n    ) {\n        tokenInTable(p, token);\n    }\n}\n\nfunction tokenInTable(p, token) {\n    const savedFosterParentingState = p.fosterParentingEnabled;\n\n    p.fosterParentingEnabled = true;\n    p._processTokenInBodyMode(token);\n    p.fosterParentingEnabled = savedFosterParentingState;\n}\n\n// The \"in table text\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n}\n\nfunction characterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n    p.hasNonWhitespacePendingCharacterToken = true;\n}\n\nfunction tokenInTableText(p, token) {\n    let i = 0;\n\n    if (p.hasNonWhitespacePendingCharacterToken) {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            tokenInTable(p, p.pendingCharacterTokens[i]);\n        }\n    } else {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            p._insertCharacters(p.pendingCharacterTokens[i]);\n        }\n    }\n\n    p.insertionMode = p.originalInsertionMode;\n    p._processToken(token);\n}\n\n// The \"in caption\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCaption(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TD ||\n        tn === $.TFOOT ||\n        tn === $.TH ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.CAPTION)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped($.CAPTION);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInBody(p, token);\n    }\n}\n\nfunction endTagInCaption(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.CAPTION || tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.CAPTION)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped($.CAPTION);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_TABLE_MODE;\n\n            if (tn === $.TABLE) {\n                p._processToken(token);\n            }\n        }\n    } else if (\n        tn !== $.BODY &&\n        tn !== $.COL &&\n        tn !== $.COLGROUP &&\n        tn !== $.HTML &&\n        tn !== $.TBODY &&\n        tn !== $.TD &&\n        tn !== $.TFOOT &&\n        tn !== $.TH &&\n        tn !== $.THEAD &&\n        tn !== $.TR\n    ) {\n        endTagInBody(p, token);\n    }\n}\n\n// The \"in column group\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInColumnGroup(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.COL) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n    } else {\n        tokenInColumnGroup(p, token);\n    }\n}\n\nfunction endTagInColumnGroup(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.COLGROUP) {\n        if (p.openElements.currentTagName === $.COLGROUP) {\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n        }\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else if (tn !== $.COL) {\n        tokenInColumnGroup(p, token);\n    }\n}\n\nfunction tokenInColumnGroup(p, token) {\n    if (p.openElements.currentTagName === $.COLGROUP) {\n        p.openElements.pop();\n        p.insertionMode = IN_TABLE_MODE;\n        p._processToken(token);\n    }\n}\n\n// The \"in table body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTableBody(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TR) {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_ROW_MODE;\n    } else if (tn === $.TH || tn === $.TD) {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertFakeElement($.TR);\n        p.insertionMode = IN_ROW_MODE;\n        p._processToken(token);\n    } else if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD\n    ) {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInTable(p, token);\n    }\n}\n\nfunction endTagInTableBody(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n        }\n    } else if (tn === $.TABLE) {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else if (\n        (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP) ||\n        (tn !== $.HTML && tn !== $.TD && tn !== $.TH && tn !== $.TR)\n    ) {\n        endTagInTable(p, token);\n    }\n}\n\n// The \"in row\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInRow(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TH || tn === $.TD) {\n        p.openElements.clearBackToTableRowContext();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_CELL_MODE;\n        p.activeFormattingElements.insertMarker();\n    } else if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInTable(p, token);\n    }\n}\n\nfunction endTagInRow(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TR) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n        }\n    } else if (tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        if (p.openElements.hasInTableScope(tn) || p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else if (\n        (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP) ||\n        (tn !== $.HTML && tn !== $.TD && tn !== $.TH)\n    ) {\n        endTagInTable(p, token);\n    }\n}\n\n// The \"in cell\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCell(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TD ||\n        tn === $.TFOOT ||\n        tn === $.TH ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.TD) || p.openElements.hasInTableScope($.TH)) {\n            p._closeTableCell();\n            p._processToken(token);\n        }\n    } else {\n        startTagInBody(p, token);\n    }\n}\n\nfunction endTagInCell(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TD || tn === $.TH) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped(tn);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_ROW_MODE;\n        }\n    } else if (tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p._closeTableCell();\n            p._processToken(token);\n        }\n    } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML) {\n        endTagInBody(p, token);\n    }\n}\n\n// The \"in select\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelect(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.OPTION) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.OPTGROUP) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n\n        if (p.openElements.currentTagName === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.INPUT || tn === $.KEYGEN || tn === $.TEXTAREA || tn === $.SELECT) {\n        if (p.openElements.hasInSelectScope($.SELECT)) {\n            p.openElements.popUntilTagNamePopped($.SELECT);\n            p._resetInsertionMode();\n\n            if (tn !== $.SELECT) {\n                p._processToken(token);\n            }\n        }\n    } else if (tn === $.SCRIPT || tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagInSelect(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.OPTGROUP) {\n        const prevOpenElement = p.openElements.items[p.openElements.stackTop - 1];\n        const prevOpenElementTn = prevOpenElement && p.treeAdapter.getTagName(prevOpenElement);\n\n        if (p.openElements.currentTagName === $.OPTION && prevOpenElementTn === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n\n        if (p.openElements.currentTagName === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n    } else if (tn === $.OPTION) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n    } else if (tn === $.SELECT && p.openElements.hasInSelectScope($.SELECT)) {\n        p.openElements.popUntilTagNamePopped($.SELECT);\n        p._resetInsertionMode();\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    }\n}\n\n//12.2.5.4.17 The \"in select in table\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelectInTable(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.TABLE ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR ||\n        tn === $.TD ||\n        tn === $.TH\n    ) {\n        p.openElements.popUntilTagNamePopped($.SELECT);\n        p._resetInsertionMode();\n        p._processToken(token);\n    } else {\n        startTagInSelect(p, token);\n    }\n}\n\nfunction endTagInSelectInTable(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.TABLE ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR ||\n        tn === $.TD ||\n        tn === $.TH\n    ) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.popUntilTagNamePopped($.SELECT);\n            p._resetInsertionMode();\n            p._processToken(token);\n        }\n    } else {\n        endTagInSelect(p, token);\n    }\n}\n\n// The \"in template\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTemplate(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.BASE ||\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.SCRIPT ||\n        tn === $.STYLE ||\n        tn === $.TEMPLATE ||\n        tn === $.TITLE\n    ) {\n        startTagInHead(p, token);\n    } else {\n        const newInsertionMode = TEMPLATE_INSERTION_MODE_SWITCH_MAP[tn] || IN_BODY_MODE;\n\n        p._popTmplInsertionMode();\n        p._pushTmplInsertionMode(newInsertionMode);\n        p.insertionMode = newInsertionMode;\n        p._processToken(token);\n    }\n}\n\nfunction endTagInTemplate(p, token) {\n    if (token.tagName === $.TEMPLATE) {\n        endTagInHead(p, token);\n    }\n}\n\nfunction eofInTemplate(p, token) {\n    if (p.openElements.tmplCount > 0) {\n        p.openElements.popUntilTagNamePopped($.TEMPLATE);\n        p.activeFormattingElements.clearToLastMarker();\n        p._popTmplInsertionMode();\n        p._resetInsertionMode();\n        p._processToken(token);\n    } else {\n        p.stopped = true;\n    }\n}\n\n// The \"after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        startTagInBody(p, token);\n    } else {\n        tokenAfterBody(p, token);\n    }\n}\n\nfunction endTagAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        if (!p.fragmentContext) {\n            p.insertionMode = AFTER_AFTER_BODY_MODE;\n        }\n    } else {\n        tokenAfterBody(p, token);\n    }\n}\n\nfunction tokenAfterBody(p, token) {\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"in frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.FRAMESET) {\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.FRAME) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagInFrameset(p, token) {\n    if (token.tagName === $.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n        p.openElements.pop();\n\n        if (!p.fragmentContext && p.openElements.currentTagName !== $.FRAMESET) {\n            p.insertionMode = AFTER_FRAMESET_MODE;\n        }\n    }\n}\n\n// The \"after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagAfterFrameset(p, token) {\n    if (token.tagName === $.HTML) {\n        p.insertionMode = AFTER_AFTER_FRAMESET_MODE;\n    }\n}\n\n// The \"after after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        startTagInBody(p, token);\n    } else {\n        tokenAfterAfterBody(p, token);\n    }\n}\n\nfunction tokenAfterAfterBody(p, token) {\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\n// The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\nfunction nullCharacterInForeignContent(p, token) {\n    token.chars = unicode.REPLACEMENT_CHARACTER;\n    p._insertCharacters(token);\n}\n\nfunction characterInForeignContent(p, token) {\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\n\nfunction startTagInForeignContent(p, token) {\n    if (foreignContent.causesExit(token) && !p.fragmentContext) {\n        while (\n            p.treeAdapter.getNamespaceURI(p.openElements.current) !== NS.HTML &&\n            !p._isIntegrationPoint(p.openElements.current)\n        ) {\n            p.openElements.pop();\n        }\n\n        p._processToken(token);\n    } else {\n        const current = p._getAdjustedCurrentElement();\n        const currentNs = p.treeAdapter.getNamespaceURI(current);\n\n        if (currentNs === NS.MATHML) {\n            foreignContent.adjustTokenMathMLAttrs(token);\n        } else if (currentNs === NS.SVG) {\n            foreignContent.adjustTokenSVGTagName(token);\n            foreignContent.adjustTokenSVGAttrs(token);\n        }\n\n        foreignContent.adjustTokenXMLAttrs(token);\n\n        if (token.selfClosing) {\n            p._appendElement(token, currentNs);\n        } else {\n            p._insertElement(token, currentNs);\n        }\n\n        token.ackSelfClosing = true;\n    }\n}\n\nfunction endTagInForeignContent(p, token) {\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (p.treeAdapter.getNamespaceURI(element) === NS.HTML) {\n            p._processToken(token);\n            break;\n        }\n\n        if (p.treeAdapter.getTagName(element).toLowerCase() === token.tagName) {\n            p.openElements.popUntilElementPopped(element);\n            break;\n        }\n    }\n}\n"],"mappings":"AAAA;;AAEA,MAAMA,SAAS,GAAGC,OAAO,CAAC,cAAD,CAAzB;;AACA,MAAMC,gBAAgB,GAAGD,OAAO,CAAC,sBAAD,CAAhC;;AACA,MAAME,qBAAqB,GAAGF,OAAO,CAAC,2BAAD,CAArC;;AACA,MAAMG,uBAAuB,GAAGH,OAAO,CAAC,0CAAD,CAAvC;;AACA,MAAMI,yBAAyB,GAAGJ,OAAO,CAAC,4CAAD,CAAzC;;AACA,MAAMK,KAAK,GAAGL,OAAO,CAAC,gBAAD,CAArB;;AACA,MAAMM,kBAAkB,GAAGN,OAAO,CAAC,0BAAD,CAAlC;;AACA,MAAMO,YAAY,GAAGP,OAAO,CAAC,wBAAD,CAA5B;;AACA,MAAMQ,OAAO,GAAGR,OAAO,CAAC,mBAAD,CAAvB;;AACA,MAAMS,cAAc,GAAGT,OAAO,CAAC,2BAAD,CAA9B;;AACA,MAAMU,GAAG,GAAGV,OAAO,CAAC,uBAAD,CAAnB;;AACA,MAAMW,OAAO,GAAGX,OAAO,CAAC,mBAAD,CAAvB;;AACA,MAAMY,IAAI,GAAGZ,OAAO,CAAC,gBAAD,CAApB,C,CAEA;;;AACA,MAAMa,CAAC,GAAGD,IAAI,CAACE,SAAf;AACA,MAAMC,EAAE,GAAGH,IAAI,CAACI,UAAhB;AACA,MAAMC,KAAK,GAAGL,IAAI,CAACK,KAAnB;AAEA,MAAMC,eAAe,GAAG;EACpBC,gBAAgB,EAAE,IADE;EAEpBC,sBAAsB,EAAE,KAFJ;EAGpBC,YAAY,EAAE,IAHM;EAIpBC,WAAW,EAAEhB;AAJO,CAAxB,C,CAOA;;AACA,MAAMiB,iBAAiB,GAAG,QAA1B,C,CAEA;;AACA,MAAMC,kBAAkB,GAAG,CAA3B;AACA,MAAMC,kBAAkB,GAAG,CAA3B,C,CAEA;;AACA,MAAMC,YAAY,GAAG,cAArB;AACA,MAAMC,gBAAgB,GAAG,kBAAzB;AACA,MAAMC,gBAAgB,GAAG,kBAAzB;AACA,MAAMC,YAAY,GAAG,cAArB;AACA,MAAMC,sBAAsB,GAAG,wBAA/B;AACA,MAAMC,eAAe,GAAG,iBAAxB;AACA,MAAMC,YAAY,GAAG,cAArB;AACA,MAAMC,SAAS,GAAG,WAAlB;AACA,MAAMC,aAAa,GAAG,eAAtB;AACA,MAAMC,kBAAkB,GAAG,oBAA3B;AACA,MAAMC,eAAe,GAAG,iBAAxB;AACA,MAAMC,oBAAoB,GAAG,sBAA7B;AACA,MAAMC,kBAAkB,GAAG,oBAA3B;AACA,MAAMC,WAAW,GAAG,aAApB;AACA,MAAMC,YAAY,GAAG,cAArB;AACA,MAAMC,cAAc,GAAG,gBAAvB;AACA,MAAMC,uBAAuB,GAAG,yBAAhC;AACA,MAAMC,gBAAgB,GAAG,kBAAzB;AACA,MAAMC,eAAe,GAAG,iBAAxB;AACA,MAAMC,gBAAgB,GAAG,kBAAzB;AACA,MAAMC,mBAAmB,GAAG,qBAA5B;AACA,MAAMC,qBAAqB,GAAG,uBAA9B;AACA,MAAMC,yBAAyB,GAAG,2BAAlC,C,CAEA;;AACA,MAAMC,wBAAwB,GAAG;EAC7B,CAACpC,CAAC,CAACqC,EAAH,GAAQX,WADqB;EAE7B,CAAC1B,CAAC,CAACsC,KAAH,GAAWb,kBAFkB;EAG7B,CAACzB,CAAC,CAACuC,KAAH,GAAWd,kBAHkB;EAI7B,CAACzB,CAAC,CAACwC,KAAH,GAAWf,kBAJkB;EAK7B,CAACzB,CAAC,CAACyC,OAAH,GAAalB,eALgB;EAM7B,CAACvB,CAAC,CAAC0C,QAAH,GAAclB,oBANe;EAO7B,CAACxB,CAAC,CAAC2C,KAAH,GAAWtB,aAPkB;EAQ7B,CAACrB,CAAC,CAAC4C,IAAH,GAAUzB,YARmB;EAS7B,CAACnB,CAAC,CAAC6C,QAAH,GAAcb;AATe,CAAjC,C,CAYA;;AACA,MAAMc,kCAAkC,GAAG;EACvC,CAAC9C,CAAC,CAACyC,OAAH,GAAapB,aAD0B;EAEvC,CAACrB,CAAC,CAAC0C,QAAH,GAAcrB,aAFyB;EAGvC,CAACrB,CAAC,CAACsC,KAAH,GAAWjB,aAH4B;EAIvC,CAACrB,CAAC,CAACwC,KAAH,GAAWnB,aAJ4B;EAKvC,CAACrB,CAAC,CAACuC,KAAH,GAAWlB,aAL4B;EAMvC,CAACrB,CAAC,CAAC+C,GAAH,GAASvB,oBAN8B;EAOvC,CAACxB,CAAC,CAACqC,EAAH,GAAQZ,kBAP+B;EAQvC,CAACzB,CAAC,CAACgD,EAAH,GAAQtB,WAR+B;EASvC,CAAC1B,CAAC,CAACiD,EAAH,GAAQvB;AAT+B,CAA3C,C,CAYA;;AACA,MAAMwB,cAAc,GAAG;EACnB,CAACrC,YAAD,GAAgB;IACZ,CAAC3B,SAAS,CAACiE,eAAX,GAA6BC,kBADjB;IAEZ,CAAClE,SAAS,CAACmE,oBAAX,GAAkCD,kBAFtB;IAGZ,CAAClE,SAAS,CAACoE,0BAAX,GAAwCC,WAH5B;IAIZ,CAACrE,SAAS,CAACsE,aAAX,GAA2BC,aAJf;IAKZ,CAACvE,SAAS,CAACwE,aAAX,GAA2BC,oBALf;IAMZ,CAACzE,SAAS,CAAC0E,eAAX,GAA6BR,kBANjB;IAOZ,CAAClE,SAAS,CAAC2E,aAAX,GAA2BT,kBAPf;IAQZ,CAAClE,SAAS,CAAC4E,SAAX,GAAuBV;EARX,CADG;EAWnB,CAACtC,gBAAD,GAAoB;IAChB,CAAC5B,SAAS,CAACiE,eAAX,GAA6BY,eADb;IAEhB,CAAC7E,SAAS,CAACmE,oBAAX,GAAkCU,eAFlB;IAGhB,CAAC7E,SAAS,CAACoE,0BAAX,GAAwCC,WAHxB;IAIhB,CAACrE,SAAS,CAACsE,aAAX,GAA2BC,aAJX;IAKhB,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALX;IAMhB,CAACrE,SAAS,CAAC0E,eAAX,GAA6BI,kBANb;IAOhB,CAAC9E,SAAS,CAAC2E,aAAX,GAA2BI,gBAPX;IAQhB,CAAC/E,SAAS,CAAC4E,SAAX,GAAuBC;EARP,CAXD;EAqBnB,CAAChD,gBAAD,GAAoB;IAChB,CAAC7B,SAAS,CAACiE,eAAX,GAA6Be,eADb;IAEhB,CAAChF,SAAS,CAACmE,oBAAX,GAAkCa,eAFlB;IAGhB,CAAChF,SAAS,CAACoE,0BAAX,GAAwCC,WAHxB;IAIhB,CAACrE,SAAS,CAACsE,aAAX,GAA2BC,aAJX;IAKhB,CAACvE,SAAS,CAACwE,aAAX,GAA2BS,gBALX;IAMhB,CAACjF,SAAS,CAAC0E,eAAX,GAA6BQ,kBANb;IAOhB,CAAClF,SAAS,CAAC2E,aAAX,GAA2BQ,gBAPX;IAQhB,CAACnF,SAAS,CAAC4E,SAAX,GAAuBI;EARP,CArBD;EA+BnB,CAAClD,YAAD,GAAgB;IACZ,CAAC9B,SAAS,CAACiE,eAAX,GAA6BmB,WADjB;IAEZ,CAACpF,SAAS,CAACmE,oBAAX,GAAkCiB,WAFtB;IAGZ,CAACpF,SAAS,CAACoE,0BAAX,GAAwCiB,gBAH5B;IAIZ,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJf;IAKZ,CAACvE,SAAS,CAACwE,aAAX,GAA2BS,gBALf;IAMZ,CAACjF,SAAS,CAAC0E,eAAX,GAA6BY,cANjB;IAOZ,CAACtF,SAAS,CAAC2E,aAAX,GAA2BY,YAPf;IAQZ,CAACvF,SAAS,CAAC4E,SAAX,GAAuBQ;EARX,CA/BG;EAyCnB,CAACrD,sBAAD,GAA0B;IACtB,CAAC/B,SAAS,CAACiE,eAAX,GAA6BuB,mBADP;IAEtB,CAACxF,SAAS,CAACmE,oBAAX,GAAkCqB,mBAFZ;IAGtB,CAACxF,SAAS,CAACoE,0BAAX,GAAwCiB,gBAHlB;IAItB,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJL;IAKtB,CAACvE,SAAS,CAACwE,aAAX,GAA2BS,gBALL;IAMtB,CAACjF,SAAS,CAAC0E,eAAX,GAA6Be,sBANP;IAOtB,CAACzF,SAAS,CAAC2E,aAAX,GAA2Be,oBAPL;IAQtB,CAAC1F,SAAS,CAAC4E,SAAX,GAAuBY;EARD,CAzCP;EAmDnB,CAACxD,eAAD,GAAmB;IACf,CAAChC,SAAS,CAACiE,eAAX,GAA6B0B,cADd;IAEf,CAAC3F,SAAS,CAACmE,oBAAX,GAAkCwB,cAFnB;IAGf,CAAC3F,SAAS,CAACoE,0BAAX,GAAwCiB,gBAHzB;IAIf,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJZ;IAKf,CAACvE,SAAS,CAACwE,aAAX,GAA2BS,gBALZ;IAMf,CAACjF,SAAS,CAAC0E,eAAX,GAA6BkB,iBANd;IAOf,CAAC5F,SAAS,CAAC2E,aAAX,GAA2BkB,eAPZ;IAQf,CAAC7F,SAAS,CAAC4E,SAAX,GAAuBe;EARR,CAnDA;EA6DnB,CAAC1D,YAAD,GAAgB;IACZ,CAACjC,SAAS,CAACiE,eAAX,GAA6B6B,eADjB;IAEZ,CAAC9F,SAAS,CAACmE,oBAAX,GAAkCE,WAFtB;IAGZ,CAACrE,SAAS,CAACoE,0BAAX,GAAwC2B,yBAH5B;IAIZ,CAAC/F,SAAS,CAACsE,aAAX,GAA2BC,aAJf;IAKZ,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALf;IAMZ,CAACrE,SAAS,CAAC0E,eAAX,GAA6BsB,cANjB;IAOZ,CAAChG,SAAS,CAAC2E,aAAX,GAA2BsB,YAPf;IAQZ,CAACjG,SAAS,CAAC4E,SAAX,GAAuBsB;EARX,CA7DG;EAuEnB,CAAChE,SAAD,GAAa;IACT,CAAClC,SAAS,CAACiE,eAAX,GAA6BoB,gBADpB;IAET,CAACrF,SAAS,CAACmE,oBAAX,GAAkCkB,gBAFzB;IAGT,CAACrF,SAAS,CAACoE,0BAAX,GAAwCiB,gBAH/B;IAIT,CAACrF,SAAS,CAACsE,aAAX,GAA2BD,WAJlB;IAKT,CAACrE,SAAS,CAACwE,aAAX,GAA2BH,WALlB;IAMT,CAACrE,SAAS,CAAC0E,eAAX,GAA6BL,WANpB;IAOT,CAACrE,SAAS,CAAC2E,aAAX,GAA2BwB,YAPlB;IAQT,CAACnG,SAAS,CAAC4E,SAAX,GAAuBwB;EARd,CAvEM;EAiFnB,CAACjE,aAAD,GAAiB;IACb,CAACnC,SAAS,CAACiE,eAAX,GAA6BoC,gBADhB;IAEb,CAACrG,SAAS,CAACmE,oBAAX,GAAkCkC,gBAFrB;IAGb,CAACrG,SAAS,CAACoE,0BAAX,GAAwCiC,gBAH3B;IAIb,CAACrG,SAAS,CAACsE,aAAX,GAA2BC,aAJd;IAKb,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALd;IAMb,CAACrE,SAAS,CAAC0E,eAAX,GAA6B4B,eANhB;IAOb,CAACtG,SAAS,CAAC2E,aAAX,GAA2B4B,aAPd;IAQb,CAACvG,SAAS,CAAC4E,SAAX,GAAuBsB;EARV,CAjFE;EA2FnB,CAAC9D,kBAAD,GAAsB;IAClB,CAACpC,SAAS,CAACiE,eAAX,GAA6BuC,oBADX;IAElB,CAACxG,SAAS,CAACmE,oBAAX,GAAkCE,WAFhB;IAGlB,CAACrE,SAAS,CAACoE,0BAAX,GAAwCqC,8BAHtB;IAIlB,CAACzG,SAAS,CAACsE,aAAX,GAA2BoC,gBAJT;IAKlB,CAAC1G,SAAS,CAACwE,aAAX,GAA2BkC,gBALT;IAMlB,CAAC1G,SAAS,CAAC0E,eAAX,GAA6BgC,gBANX;IAOlB,CAAC1G,SAAS,CAAC2E,aAAX,GAA2B+B,gBAPT;IAQlB,CAAC1G,SAAS,CAAC4E,SAAX,GAAuB8B;EARL,CA3FH;EAqGnB,CAACrE,eAAD,GAAmB;IACf,CAACrC,SAAS,CAACiE,eAAX,GAA6B6B,eADd;IAEf,CAAC9F,SAAS,CAACmE,oBAAX,GAAkCE,WAFnB;IAGf,CAACrE,SAAS,CAACoE,0BAAX,GAAwC2B,yBAHzB;IAIf,CAAC/F,SAAS,CAACsE,aAAX,GAA2BC,aAJZ;IAKf,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALZ;IAMf,CAACrE,SAAS,CAAC0E,eAAX,GAA6BiC,iBANd;IAOf,CAAC3G,SAAS,CAAC2E,aAAX,GAA2BiC,eAPZ;IAQf,CAAC5G,SAAS,CAAC4E,SAAX,GAAuBsB;EARR,CArGA;EA+GnB,CAAC5D,oBAAD,GAAwB;IACpB,CAACtC,SAAS,CAACiE,eAAX,GAA6B4C,kBADT;IAEpB,CAAC7G,SAAS,CAACmE,oBAAX,GAAkC0C,kBAFd;IAGpB,CAAC7G,SAAS,CAACoE,0BAAX,GAAwCiB,gBAHpB;IAIpB,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJP;IAKpB,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALP;IAMpB,CAACrE,SAAS,CAAC0E,eAAX,GAA6BoC,qBANT;IAOpB,CAAC9G,SAAS,CAAC2E,aAAX,GAA2BoC,mBAPP;IAQpB,CAAC/G,SAAS,CAAC4E,SAAX,GAAuBsB;EARH,CA/GL;EAyHnB,CAAC3D,kBAAD,GAAsB;IAClB,CAACvC,SAAS,CAACiE,eAAX,GAA6BoC,gBADX;IAElB,CAACrG,SAAS,CAACmE,oBAAX,GAAkCkC,gBAFhB;IAGlB,CAACrG,SAAS,CAACoE,0BAAX,GAAwCiC,gBAHtB;IAIlB,CAACrG,SAAS,CAACsE,aAAX,GAA2BC,aAJT;IAKlB,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALT;IAMlB,CAACrE,SAAS,CAAC0E,eAAX,GAA6BsC,mBANX;IAOlB,CAAChH,SAAS,CAAC2E,aAAX,GAA2BsC,iBAPT;IAQlB,CAACjH,SAAS,CAAC4E,SAAX,GAAuBsB;EARL,CAzHH;EAmInB,CAAC1D,WAAD,GAAe;IACX,CAACxC,SAAS,CAACiE,eAAX,GAA6BoC,gBADlB;IAEX,CAACrG,SAAS,CAACmE,oBAAX,GAAkCkC,gBAFvB;IAGX,CAACrG,SAAS,CAACoE,0BAAX,GAAwCiC,gBAH7B;IAIX,CAACrG,SAAS,CAACsE,aAAX,GAA2BC,aAJhB;IAKX,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALhB;IAMX,CAACrE,SAAS,CAAC0E,eAAX,GAA6BwC,aANlB;IAOX,CAAClH,SAAS,CAAC2E,aAAX,GAA2BwC,WAPhB;IAQX,CAACnH,SAAS,CAAC4E,SAAX,GAAuBsB;EARZ,CAnII;EA6InB,CAACzD,YAAD,GAAgB;IACZ,CAACzC,SAAS,CAACiE,eAAX,GAA6B6B,eADjB;IAEZ,CAAC9F,SAAS,CAACmE,oBAAX,GAAkCE,WAFtB;IAGZ,CAACrE,SAAS,CAACoE,0BAAX,GAAwC2B,yBAH5B;IAIZ,CAAC/F,SAAS,CAACsE,aAAX,GAA2BC,aAJf;IAKZ,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALf;IAMZ,CAACrE,SAAS,CAAC0E,eAAX,GAA6B0C,cANjB;IAOZ,CAACpH,SAAS,CAAC2E,aAAX,GAA2B0C,YAPf;IAQZ,CAACrH,SAAS,CAAC4E,SAAX,GAAuBsB;EARX,CA7IG;EAuJnB,CAACxD,cAAD,GAAkB;IACd,CAAC1C,SAAS,CAACiE,eAAX,GAA6BoB,gBADf;IAEd,CAACrF,SAAS,CAACmE,oBAAX,GAAkCE,WAFpB;IAGd,CAACrE,SAAS,CAACoE,0BAAX,GAAwCiB,gBAH1B;IAId,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJb;IAKd,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALb;IAMd,CAACrE,SAAS,CAAC0E,eAAX,GAA6B4C,gBANf;IAOd,CAACtH,SAAS,CAAC2E,aAAX,GAA2B4C,cAPb;IAQd,CAACvH,SAAS,CAAC4E,SAAX,GAAuBsB;EART,CAvJC;EAiKnB,CAACvD,uBAAD,GAA2B;IACvB,CAAC3C,SAAS,CAACiE,eAAX,GAA6BoB,gBADN;IAEvB,CAACrF,SAAS,CAACmE,oBAAX,GAAkCE,WAFX;IAGvB,CAACrE,SAAS,CAACoE,0BAAX,GAAwCiB,gBAHjB;IAIvB,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJJ;IAKvB,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALJ;IAMvB,CAACrE,SAAS,CAAC0E,eAAX,GAA6B8C,uBANN;IAOvB,CAACxH,SAAS,CAAC2E,aAAX,GAA2B8C,qBAPJ;IAQvB,CAACzH,SAAS,CAAC4E,SAAX,GAAuBsB;EARA,CAjKR;EA2KnB,CAACtD,gBAAD,GAAoB;IAChB,CAAC5C,SAAS,CAACiE,eAAX,GAA6B6B,eADb;IAEhB,CAAC9F,SAAS,CAACmE,oBAAX,GAAkCE,WAFlB;IAGhB,CAACrE,SAAS,CAACoE,0BAAX,GAAwC2B,yBAHxB;IAIhB,CAAC/F,SAAS,CAACsE,aAAX,GAA2BC,aAJX;IAKhB,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALX;IAMhB,CAACrE,SAAS,CAAC0E,eAAX,GAA6BgD,kBANb;IAOhB,CAAC1H,SAAS,CAAC2E,aAAX,GAA2BgD,gBAPX;IAQhB,CAAC3H,SAAS,CAAC4E,SAAX,GAAuBgD;EARP,CA3KD;EAqLnB,CAAC/E,eAAD,GAAmB;IACf,CAAC7C,SAAS,CAACiE,eAAX,GAA6B4D,cADd;IAEf,CAAC7H,SAAS,CAACmE,oBAAX,GAAkC0D,cAFnB;IAGf,CAAC7H,SAAS,CAACoE,0BAAX,GAAwC2B,yBAHzB;IAIf,CAAC/F,SAAS,CAACsE,aAAX,GAA2BwD,8BAJZ;IAKf,CAAC9H,SAAS,CAACwE,aAAX,GAA2BH,WALZ;IAMf,CAACrE,SAAS,CAAC0E,eAAX,GAA6BqD,iBANd;IAOf,CAAC/H,SAAS,CAAC2E,aAAX,GAA2BqD,eAPZ;IAQf,CAAChI,SAAS,CAAC4E,SAAX,GAAuBqD;EARR,CArLA;EA+LnB,CAACnF,gBAAD,GAAoB;IAChB,CAAC9C,SAAS,CAACiE,eAAX,GAA6BI,WADb;IAEhB,CAACrE,SAAS,CAACmE,oBAAX,GAAkCE,WAFlB;IAGhB,CAACrE,SAAS,CAACoE,0BAAX,GAAwCiB,gBAHxB;IAIhB,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJX;IAKhB,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALX;IAMhB,CAACrE,SAAS,CAAC0E,eAAX,GAA6BwD,kBANb;IAOhB,CAAClI,SAAS,CAAC2E,aAAX,GAA2BwD,gBAPX;IAQhB,CAACnI,SAAS,CAAC4E,SAAX,GAAuBqD;EARP,CA/LD;EAyMnB,CAAClF,mBAAD,GAAuB;IACnB,CAAC/C,SAAS,CAACiE,eAAX,GAA6BI,WADV;IAEnB,CAACrE,SAAS,CAACmE,oBAAX,GAAkCE,WAFf;IAGnB,CAACrE,SAAS,CAACoE,0BAAX,GAAwCiB,gBAHrB;IAInB,CAACrF,SAAS,CAACsE,aAAX,GAA2BC,aAJR;IAKnB,CAACvE,SAAS,CAACwE,aAAX,GAA2BH,WALR;IAMnB,CAACrE,SAAS,CAAC0E,eAAX,GAA6B0D,qBANV;IAOnB,CAACpI,SAAS,CAAC2E,aAAX,GAA2B0D,mBAPR;IAQnB,CAACrI,SAAS,CAAC4E,SAAX,GAAuBqD;EARJ,CAzMJ;EAmNnB,CAACjF,qBAAD,GAAyB;IACrB,CAAChD,SAAS,CAACiE,eAAX,GAA6BqE,mBADR;IAErB,CAACtI,SAAS,CAACmE,oBAAX,GAAkCmE,mBAFb;IAGrB,CAACtI,SAAS,CAACoE,0BAAX,GAAwC2B,yBAHnB;IAIrB,CAAC/F,SAAS,CAACsE,aAAX,GAA2BiE,uBAJN;IAKrB,CAACvI,SAAS,CAACwE,aAAX,GAA2BH,WALN;IAMrB,CAACrE,SAAS,CAAC0E,eAAX,GAA6B8D,sBANR;IAOrB,CAACxI,SAAS,CAAC2E,aAAX,GAA2B2D,mBAPN;IAQrB,CAACtI,SAAS,CAAC4E,SAAX,GAAuBqD;EARF,CAnNN;EA6NnB,CAAChF,yBAAD,GAA6B;IACzB,CAACjD,SAAS,CAACiE,eAAX,GAA6BI,WADJ;IAEzB,CAACrE,SAAS,CAACmE,oBAAX,GAAkCE,WAFT;IAGzB,CAACrE,SAAS,CAACoE,0BAAX,GAAwC2B,yBAHf;IAIzB,CAAC/F,SAAS,CAACsE,aAAX,GAA2BiE,uBAJF;IAKzB,CAACvI,SAAS,CAACwE,aAAX,GAA2BH,WALF;IAMzB,CAACrE,SAAS,CAAC0E,eAAX,GAA6B+D,0BANJ;IAOzB,CAACzI,SAAS,CAAC2E,aAAX,GAA2BN,WAPF;IAQzB,CAACrE,SAAS,CAAC4E,SAAX,GAAuBqD;EARE;AA7NV,CAAvB,C,CAyOA;;AACA,MAAMS,MAAN,CAAa;EACTC,WAAW,CAACC,OAAD,EAAU;IACjB,KAAKA,OAAL,GAAepI,YAAY,CAACW,eAAD,EAAkByH,OAAlB,CAA3B;IAEA,KAAKrH,WAAL,GAAmB,KAAKqH,OAAL,CAAarH,WAAhC;IACA,KAAKsH,aAAL,GAAqB,IAArB;;IAEA,IAAI,KAAKD,OAAL,CAAavH,sBAAjB,EAAyC;MACrCf,KAAK,CAACwI,OAAN,CAAc,IAAd,EAAoB1I,uBAApB;IACH;;IAED,IAAI,KAAKwI,OAAL,CAAatH,YAAjB,EAA+B;MAC3BhB,KAAK,CAACwI,OAAN,CAAc,IAAd,EAAoBzI,yBAApB,EAA+C;QAAEiB,YAAY,EAAE,KAAKsH,OAAL,CAAatH;MAA7B,CAA/C;IACH;EACJ,CAdQ,CAgBT;;;EACAyH,KAAK,CAACC,IAAD,EAAO;IACR,MAAMC,QAAQ,GAAG,KAAK1H,WAAL,CAAiB2H,cAAjB,EAAjB;;IAEA,KAAKC,UAAL,CAAgBF,QAAhB,EAA0B,IAA1B;;IACA,KAAKG,SAAL,CAAeC,KAAf,CAAqBL,IAArB,EAA2B,IAA3B;;IACA,KAAKM,eAAL,CAAqB,IAArB;;IAEA,OAAOL,QAAP;EACH;;EAEDM,aAAa,CAACP,IAAD,EAAOQ,eAAP,EAAwB;IACjC;IACA;IACA,IAAI,CAACA,eAAL,EAAsB;MAClBA,eAAe,GAAG,KAAKjI,WAAL,CAAiBkI,aAAjB,CAA+B3I,CAAC,CAAC4I,QAAjC,EAA2C1I,EAAE,CAACH,IAA9C,EAAoD,EAApD,CAAlB;IACH,CALgC,CAOjC;IACA;IACA;;;IACA,MAAM8I,YAAY,GAAG,KAAKpI,WAAL,CAAiBkI,aAAjB,CAA+B,cAA/B,EAA+CzI,EAAE,CAACH,IAAlD,EAAwD,EAAxD,CAArB;;IAEA,KAAKsI,UAAL,CAAgBQ,YAAhB,EAA8BH,eAA9B;;IAEA,IAAI,KAAKjI,WAAL,CAAiBqI,UAAjB,CAA4BJ,eAA5B,MAAiD1I,CAAC,CAAC4I,QAAvD,EAAiE;MAC7D,KAAKG,sBAAL,CAA4BjH,gBAA5B;IACH;;IAED,KAAKkH,gCAAL;;IACA,KAAKC,sBAAL;;IACA,KAAKC,mBAAL;;IACA,KAAKC,0BAAL;;IACA,KAAKb,SAAL,CAAeC,KAAf,CAAqBL,IAArB,EAA2B,IAA3B;;IACA,KAAKM,eAAL,CAAqB,IAArB;;IAEA,MAAMY,WAAW,GAAG,KAAK3I,WAAL,CAAiB4I,aAAjB,CAA+BR,YAA/B,CAApB;IACA,MAAMS,QAAQ,GAAG,KAAK7I,WAAL,CAAiB8I,sBAAjB,EAAjB;;IAEA,KAAKC,WAAL,CAAiBJ,WAAjB,EAA8BE,QAA9B;;IAEA,OAAOA,QAAP;EACH,CA1DQ,CA4DT;;;EACAjB,UAAU,CAACF,QAAD,EAAWO,eAAX,EAA4B;IAClC,KAAKJ,SAAL,GAAiB,IAAIpJ,SAAJ,CAAc,KAAK4I,OAAnB,CAAjB;IAEA,KAAK2B,OAAL,GAAe,KAAf;IAEA,KAAKC,aAAL,GAAqB7I,YAArB;IACA,KAAK8I,qBAAL,GAA6B,EAA7B;IAEA,KAAKxB,QAAL,GAAgBA,QAAhB;IACA,KAAKO,eAAL,GAAuBA,eAAvB;IAEA,KAAKkB,WAAL,GAAmB,IAAnB;IACA,KAAKC,WAAL,GAAmB,IAAnB;IAEA,KAAKC,YAAL,GAAoB,IAAI1K,gBAAJ,CAAqB,KAAK+I,QAA1B,EAAoC,KAAK1H,WAAzC,CAApB;IACA,KAAKsJ,wBAAL,GAAgC,IAAI1K,qBAAJ,CAA0B,KAAKoB,WAA/B,CAAhC;IAEA,KAAKuJ,sBAAL,GAA8B,EAA9B;IACA,KAAKC,yBAAL,GAAiC,CAAC,CAAlC;IACA,KAAKC,wBAAL,GAAgC,IAAhC;IAEA,KAAKC,sBAAL,GAA8B,EAA9B;IACA,KAAKC,qCAAL,GAA6C,KAA7C;IAEA,KAAKC,UAAL,GAAkB,IAAlB;IACA,KAAKC,eAAL,GAAuB,KAAvB;IACA,KAAKC,sBAAL,GAA8B,KAA9B;EACH,CAxFQ,CA0FT;;;EACAC,IAAI,GAAG,CACH;EACH,CA7FQ,CA+FT;;;EACAhC,eAAe,CAACiC,aAAD,EAAgB;IAC3B,OAAO,CAAC,KAAKhB,OAAb,EAAsB;MAClB,KAAKiB,wBAAL;;MAEA,MAAMC,KAAK,GAAG,KAAKrC,SAAL,CAAesC,YAAf,EAAd;;MAEA,IAAID,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC4L,iBAA7B,EAAgD;QAC5C;MACH;;MAED,IAAI,KAAKR,eAAT,EAA0B;QACtB,KAAKA,eAAL,GAAuB,KAAvB;;QAEA,IAAIK,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACoE,0BAAzB,IAAuDqH,KAAK,CAACI,KAAN,CAAY,CAAZ,MAAmB,IAA9E,EAAoF;UAChF,IAAIJ,KAAK,CAACI,KAAN,CAAYC,MAAZ,KAAuB,CAA3B,EAA8B;YAC1B;UACH;;UAEDL,KAAK,CAACI,KAAN,GAAcJ,KAAK,CAACI,KAAN,CAAYE,MAAZ,CAAmB,CAAnB,CAAd;QACH;MACJ;;MAED,KAAKC,kBAAL,CAAwBP,KAAxB;;MAEA,IAAIF,aAAa,IAAI,KAAK1C,aAA1B,EAAyC;QACrC;MACH;IACJ;EACJ;;EAEDoD,6BAA6B,CAACC,aAAD,EAAgBX,aAAhB,EAA+B;IACxD,KAAKjC,eAAL,CAAqBiC,aAArB;;IAEA,IAAIA,aAAa,IAAI,KAAK1C,aAA1B,EAAyC;MACrC,MAAMsD,MAAM,GAAG,KAAKtD,aAApB;MAEA,KAAKA,aAAL,GAAqB,IAArB;MAEA0C,aAAa,CAACY,MAAD,CAAb;MAEA;IACH;;IAED,IAAID,aAAJ,EAAmB;MACfA,aAAa;IAChB;EACJ,CA9IQ,CAgJT;;;EACAV,wBAAwB,GAAG;IACvB,MAAMY,OAAO,GAAG,KAAKC,0BAAL,EAAhB;;IAEA,KAAKjD,SAAL,CAAekD,UAAf,GACIF,OAAO,IACPA,OAAO,KAAK,KAAKnD,QADjB,IAEA,KAAK1H,WAAL,CAAiBgL,eAAjB,CAAiCH,OAAjC,MAA8CpL,EAAE,CAACH,IAFjD,IAGA,CAAC,KAAK2L,mBAAL,CAAyBJ,OAAzB,CAJL;EAKH;;EAEDK,oBAAoB,CAACC,YAAD,EAAeC,kBAAf,EAAmC;IACnD,KAAKC,cAAL,CAAoBF,YAApB,EAAkC1L,EAAE,CAACH,IAArC;;IACA,KAAKuI,SAAL,CAAeyD,KAAf,GAAuBF,kBAAvB;IACA,KAAKlC,qBAAL,GAA6B,KAAKD,aAAlC;IACA,KAAKA,aAAL,GAAqBtI,SAArB;EACH;;EAED4K,wBAAwB,GAAG;IACvB,KAAKtC,aAAL,GAAqBtI,SAArB;IACA,KAAKuI,qBAAL,GAA6BxI,YAA7B;IACA,KAAKmH,SAAL,CAAeyD,KAAf,GAAuB7M,SAAS,CAAC+M,IAAV,CAAeC,SAAtC;EACH,CAtKQ,CAwKT;;;EACAX,0BAA0B,GAAG;IACzB,OAAO,KAAKzB,YAAL,CAAkBqC,QAAlB,KAA+B,CAA/B,IAAoC,KAAKzD,eAAzC,GACD,KAAKA,eADJ,GAED,KAAKoB,YAAL,CAAkBwB,OAFxB;EAGH;;EAEDnC,0BAA0B,GAAG;IACzB,IAAIiD,IAAI,GAAG,KAAK1D,eAAhB;;IAEA,GAAG;MACC,IAAI,KAAKjI,WAAL,CAAiBqI,UAAjB,CAA4BsD,IAA5B,MAAsCpM,CAAC,CAACqM,IAA5C,EAAkD;QAC9C,KAAKxC,WAAL,GAAmBuC,IAAnB;QACA;MACH;;MAEDA,IAAI,GAAG,KAAK3L,WAAL,CAAiB6L,aAAjB,CAA+BF,IAA/B,CAAP;IACH,CAPD,QAOSA,IAPT;EAQH;;EAEDpD,gCAAgC,GAAG;IAC/B,IAAI,KAAKvI,WAAL,CAAiBgL,eAAjB,CAAiC,KAAK/C,eAAtC,MAA2DxI,EAAE,CAACH,IAAlE,EAAwE;MACpE,MAAMwM,EAAE,GAAG,KAAK9L,WAAL,CAAiBqI,UAAjB,CAA4B,KAAKJ,eAAjC,CAAX;;MAEA,IAAI6D,EAAE,KAAKvM,CAAC,CAACwM,KAAT,IAAkBD,EAAE,KAAKvM,CAAC,CAACyM,QAA/B,EAAyC;QACrC,KAAKnE,SAAL,CAAeyD,KAAf,GAAuB7M,SAAS,CAAC+M,IAAV,CAAeS,MAAtC;MACH,CAFD,MAEO,IACHH,EAAE,KAAKvM,CAAC,CAAC2M,KAAT,IACAJ,EAAE,KAAKvM,CAAC,CAAC4M,GADT,IAEAL,EAAE,KAAKvM,CAAC,CAAC6M,MAFT,IAGAN,EAAE,KAAKvM,CAAC,CAAC8M,OAHT,IAIAP,EAAE,KAAKvM,CAAC,CAAC+M,QAJT,IAKAR,EAAE,KAAKvM,CAAC,CAACgN,QANN,EAOL;QACE,KAAK1E,SAAL,CAAeyD,KAAf,GAAuB7M,SAAS,CAAC+M,IAAV,CAAegB,OAAtC;MACH,CATM,MASA,IAAIV,EAAE,KAAKvM,CAAC,CAACkN,MAAb,EAAqB;QACxB,KAAK5E,SAAL,CAAeyD,KAAf,GAAuB7M,SAAS,CAAC+M,IAAV,CAAekB,WAAtC;MACH,CAFM,MAEA,IAAIZ,EAAE,KAAKvM,CAAC,CAACkM,SAAb,EAAwB;QAC3B,KAAK5D,SAAL,CAAeyD,KAAf,GAAuB7M,SAAS,CAAC+M,IAAV,CAAeC,SAAtC;MACH;IACJ;EACJ,CAjNQ,CAmNT;;;EACAkB,gBAAgB,CAACzC,KAAD,EAAQ;IACpB,MAAM0C,IAAI,GAAG1C,KAAK,CAAC0C,IAAN,IAAc,EAA3B;IACA,MAAMC,QAAQ,GAAG3C,KAAK,CAAC2C,QAAN,IAAkB,EAAnC;IACA,MAAMC,QAAQ,GAAG5C,KAAK,CAAC4C,QAAN,IAAkB,EAAnC;IAEA,KAAK9M,WAAL,CAAiB+M,eAAjB,CAAiC,KAAKrF,QAAtC,EAAgDkF,IAAhD,EAAsDC,QAAtD,EAAgEC,QAAhE;EACH;;EAEDE,oBAAoB,CAACC,OAAD,EAAU;IAC1B,IAAI,KAAKC,8BAAL,EAAJ,EAA2C;MACvC,KAAKC,oBAAL,CAA0BF,OAA1B;IACH,CAFD,MAEO;MACH,MAAMG,MAAM,GAAG,KAAK/D,YAAL,CAAkBgE,kBAAlB,IAAwC,KAAKhE,YAAL,CAAkBwB,OAAzE;MAEA,KAAK7K,WAAL,CAAiBsN,WAAjB,CAA6BF,MAA7B,EAAqCH,OAArC;IACH;EACJ;;EAEDM,cAAc,CAACrD,KAAD,EAAQsD,YAAR,EAAsB;IAChC,MAAMP,OAAO,GAAG,KAAKjN,WAAL,CAAiBkI,aAAjB,CAA+BgC,KAAK,CAACuD,OAArC,EAA8CD,YAA9C,EAA4DtD,KAAK,CAACwD,KAAlE,CAAhB;;IAEA,KAAKV,oBAAL,CAA0BC,OAA1B;EACH;;EAED5B,cAAc,CAACnB,KAAD,EAAQsD,YAAR,EAAsB;IAChC,MAAMP,OAAO,GAAG,KAAKjN,WAAL,CAAiBkI,aAAjB,CAA+BgC,KAAK,CAACuD,OAArC,EAA8CD,YAA9C,EAA4DtD,KAAK,CAACwD,KAAlE,CAAhB;;IAEA,KAAKV,oBAAL,CAA0BC,OAA1B;;IACA,KAAK5D,YAAL,CAAkBsE,IAAlB,CAAuBV,OAAvB;EACH;;EAEDW,kBAAkB,CAACH,OAAD,EAAU;IACxB,MAAMR,OAAO,GAAG,KAAKjN,WAAL,CAAiBkI,aAAjB,CAA+BuF,OAA/B,EAAwChO,EAAE,CAACH,IAA3C,EAAiD,EAAjD,CAAhB;;IAEA,KAAK0N,oBAAL,CAA0BC,OAA1B;;IACA,KAAK5D,YAAL,CAAkBsE,IAAlB,CAAuBV,OAAvB;EACH;;EAEDY,eAAe,CAAC3D,KAAD,EAAQ;IACnB,MAAM4D,IAAI,GAAG,KAAK9N,WAAL,CAAiBkI,aAAjB,CAA+BgC,KAAK,CAACuD,OAArC,EAA8ChO,EAAE,CAACH,IAAjD,EAAuD4K,KAAK,CAACwD,KAA7D,CAAb;IACA,MAAMK,OAAO,GAAG,KAAK/N,WAAL,CAAiB8I,sBAAjB,EAAhB;IAEA,KAAK9I,WAAL,CAAiBgO,kBAAjB,CAAoCF,IAApC,EAA0CC,OAA1C;;IACA,KAAKf,oBAAL,CAA0Bc,IAA1B;;IACA,KAAKzE,YAAL,CAAkBsE,IAAlB,CAAuBG,IAAvB;EACH;;EAEDtF,sBAAsB,GAAG;IACrB,MAAMyE,OAAO,GAAG,KAAKjN,WAAL,CAAiBkI,aAAjB,CAA+B3I,CAAC,CAACD,IAAjC,EAAuCG,EAAE,CAACH,IAA1C,EAAgD,EAAhD,CAAhB;IAEA,KAAKU,WAAL,CAAiBsN,WAAjB,CAA6B,KAAKjE,YAAL,CAAkBwB,OAA/C,EAAwDoC,OAAxD;IACA,KAAK5D,YAAL,CAAkBsE,IAAlB,CAAuBV,OAAvB;EACH;;EAEDgB,kBAAkB,CAAC/D,KAAD,EAAQkD,MAAR,EAAgB;IAC9B,MAAMc,WAAW,GAAG,KAAKlO,WAAL,CAAiBmO,iBAAjB,CAAmCjE,KAAK,CAACkE,IAAzC,CAApB;IAEA,KAAKpO,WAAL,CAAiBsN,WAAjB,CAA6BF,MAA7B,EAAqCc,WAArC;EACH;;EAEDG,iBAAiB,CAACnE,KAAD,EAAQ;IACrB,IAAI,KAAKgD,8BAAL,EAAJ,EAA2C;MACvC,KAAKoB,iBAAL,CAAuBpE,KAAK,CAACI,KAA7B;IACH,CAFD,MAEO;MACH,MAAM8C,MAAM,GAAG,KAAK/D,YAAL,CAAkBgE,kBAAlB,IAAwC,KAAKhE,YAAL,CAAkBwB,OAAzE;MAEA,KAAK7K,WAAL,CAAiBuO,UAAjB,CAA4BnB,MAA5B,EAAoClD,KAAK,CAACI,KAA1C;IACH;EACJ;;EAEDvB,WAAW,CAACyF,KAAD,EAAQC,SAAR,EAAmB;IAC1B,KAAK,IAAIC,KAAK,GAAG,KAAK1O,WAAL,CAAiB4I,aAAjB,CAA+B4F,KAA/B,CAAjB,EAAwDE,KAAxD,EAA+DA,KAAK,GAAG,KAAK1O,WAAL,CAAiB4I,aAAjB,CAA+B4F,KAA/B,CAAvE,EAA8G;MAC1G,KAAKxO,WAAL,CAAiB2O,UAAjB,CAA4BD,KAA5B;MACA,KAAK1O,WAAL,CAAiBsN,WAAjB,CAA6BmB,SAA7B,EAAwCC,KAAxC;IACH;EACJ,CA/RQ,CAiST;;;EACAE,mCAAmC,CAAC1E,KAAD,EAAQ;IACvC,MAAMW,OAAO,GAAG,KAAKC,0BAAL,EAAhB;;IAEA,IAAI,CAACD,OAAD,IAAYA,OAAO,KAAK,KAAKnD,QAAjC,EAA2C;MACvC,OAAO,KAAP;IACH;;IAED,MAAMmH,EAAE,GAAG,KAAK7O,WAAL,CAAiBgL,eAAjB,CAAiCH,OAAjC,CAAX;;IAEA,IAAIgE,EAAE,KAAKpP,EAAE,CAACH,IAAd,EAAoB;MAChB,OAAO,KAAP;IACH;;IAED,IACI,KAAKU,WAAL,CAAiBqI,UAAjB,CAA4BwC,OAA5B,MAAyCtL,CAAC,CAACuP,cAA3C,IACAD,EAAE,KAAKpP,EAAE,CAACsP,MADV,IAEA7E,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC0E,eAFzB,IAGA+G,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAACyP,GAJxB,EAKE;MACE,OAAO,KAAP;IACH;;IAED,MAAMC,gBAAgB,GAClB/E,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACiE,eAAzB,IACAwH,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACmE,oBADzB,IAEAsH,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACoE,0BAH7B;IAKA,MAAMqM,oBAAoB,GACtBhF,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC0E,eAAzB,IAA4C+G,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAAC4P,MAAhE,IAA0EjF,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAAC6P,UADlG;;IAGA,IAAI,CAACF,oBAAoB,IAAID,gBAAzB,KAA8C,KAAKhE,mBAAL,CAAyBJ,OAAzB,EAAkCpL,EAAE,CAACsP,MAArC,CAAlD,EAAgG;MAC5F,OAAO,KAAP;IACH;;IAED,IACI,CAAC7E,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC0E,eAAzB,IAA4C8L,gBAA7C,KACA,KAAKhE,mBAAL,CAAyBJ,OAAzB,EAAkCpL,EAAE,CAACH,IAArC,CAFJ,EAGE;MACE,OAAO,KAAP;IACH;;IAED,OAAO4K,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC4E,SAAhC;EACH;;EAEDgM,aAAa,CAACnF,KAAD,EAAQ;IACjBzH,cAAc,CAAC,KAAKwG,aAAN,CAAd,CAAmCiB,KAAK,CAACE,IAAzC,EAA+C,IAA/C,EAAqDF,KAArD;EACH;;EAEDoF,uBAAuB,CAACpF,KAAD,EAAQ;IAC3BzH,cAAc,CAAC/B,YAAD,CAAd,CAA6BwJ,KAAK,CAACE,IAAnC,EAAyC,IAAzC,EAA+CF,KAA/C;EACH;;EAEDqF,6BAA6B,CAACrF,KAAD,EAAQ;IACjC,IAAIA,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACiE,eAA7B,EAA8C;MAC1C8M,yBAAyB,CAAC,IAAD,EAAOtF,KAAP,CAAzB;IACH,CAFD,MAEO,IAAIA,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACmE,oBAA7B,EAAmD;MACtD6M,6BAA6B,CAAC,IAAD,EAAOvF,KAAP,CAA7B;IACH,CAFM,MAEA,IAAIA,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACoE,0BAA7B,EAAyD;MAC5DiB,gBAAgB,CAAC,IAAD,EAAOoG,KAAP,CAAhB;IACH,CAFM,MAEA,IAAIA,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAACsE,aAA7B,EAA4C;MAC/CC,aAAa,CAAC,IAAD,EAAOkH,KAAP,CAAb;IACH,CAFM,MAEA,IAAIA,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC0E,eAA7B,EAA8C;MACjDuM,wBAAwB,CAAC,IAAD,EAAOxF,KAAP,CAAxB;IACH,CAFM,MAEA,IAAIA,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC2E,aAA7B,EAA4C;MAC/CuM,sBAAsB,CAAC,IAAD,EAAOzF,KAAP,CAAtB;IACH;EACJ;;EAEDO,kBAAkB,CAACP,KAAD,EAAQ;IACtB,IAAI,KAAK0E,mCAAL,CAAyC1E,KAAzC,CAAJ,EAAqD;MACjD,KAAKqF,6BAAL,CAAmCrF,KAAnC;IACH,CAFD,MAEO;MACH,KAAKmF,aAAL,CAAmBnF,KAAnB;IACH;;IAED,IAAIA,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC0E,eAAzB,IAA4C+G,KAAK,CAAC0F,WAAlD,IAAiE,CAAC1F,KAAK,CAAC2F,cAA5E,EAA4F;MACxF,KAAK9F,IAAL,CAAU3K,GAAG,CAAC0Q,6CAAd;IACH;EACJ,CAhXQ,CAkXT;;;EACA7E,mBAAmB,CAACgC,OAAD,EAAU8C,SAAV,EAAqB;IACpC,MAAMjE,EAAE,GAAG,KAAK9L,WAAL,CAAiBqI,UAAjB,CAA4B4E,OAA5B,CAAX;IACA,MAAM4B,EAAE,GAAG,KAAK7O,WAAL,CAAiBgL,eAAjB,CAAiCiC,OAAjC,CAAX;IACA,MAAMS,KAAK,GAAG,KAAK1N,WAAL,CAAiBgQ,WAAjB,CAA6B/C,OAA7B,CAAd;IAEA,OAAO9N,cAAc,CAAC8Q,kBAAf,CAAkCnE,EAAlC,EAAsC+C,EAAtC,EAA0CnB,KAA1C,EAAiDqC,SAAjD,CAAP;EACH,CAzXQ,CA2XT;;;EACAG,oCAAoC,GAAG;IACnC,MAAMC,UAAU,GAAG,KAAK7G,wBAAL,CAA8BiB,MAAjD;;IAEA,IAAI4F,UAAJ,EAAgB;MACZ,IAAIC,SAAS,GAAGD,UAAhB;MACA,IAAIE,KAAK,GAAG,IAAZ;;MAEA,GAAG;QACCD,SAAS;QACTC,KAAK,GAAG,KAAK/G,wBAAL,CAA8BgH,OAA9B,CAAsCF,SAAtC,CAAR;;QAEA,IAAIC,KAAK,CAACjG,IAAN,KAAexL,qBAAqB,CAAC2R,YAArC,IAAqD,KAAKlH,YAAL,CAAkBmH,QAAlB,CAA2BH,KAAK,CAACpD,OAAjC,CAAzD,EAAoG;UAChGmD,SAAS;UACT;QACH;MACJ,CARD,QAQSA,SAAS,GAAG,CARrB;;MAUA,KAAK,IAAIK,CAAC,GAAGL,SAAb,EAAwBK,CAAC,GAAGN,UAA5B,EAAwCM,CAAC,EAAzC,EAA6C;QACzCJ,KAAK,GAAG,KAAK/G,wBAAL,CAA8BgH,OAA9B,CAAsCG,CAAtC,CAAR;;QACA,KAAKpF,cAAL,CAAoBgF,KAAK,CAACnG,KAA1B,EAAiC,KAAKlK,WAAL,CAAiBgL,eAAjB,CAAiCqF,KAAK,CAACpD,OAAvC,CAAjC;;QACAoD,KAAK,CAACpD,OAAN,GAAgB,KAAK5D,YAAL,CAAkBwB,OAAlC;MACH;IACJ;EACJ,CAnZQ,CAqZT;;;EACA6F,eAAe,GAAG;IACd,KAAKrH,YAAL,CAAkBsH,sBAAlB;IACA,KAAKtH,YAAL,CAAkBuH,uBAAlB;IACA,KAAKtH,wBAAL,CAA8BuH,iBAA9B;IACA,KAAK5H,aAAL,GAAqBhI,WAArB;EACH;;EAED6P,cAAc,GAAG;IACb,KAAKzH,YAAL,CAAkB0H,mCAAlB,CAAsDxR,CAAC,CAACyR,CAAxD;IACA,KAAK3H,YAAL,CAAkB4H,qBAAlB,CAAwC1R,CAAC,CAACyR,CAA1C;EACH,CAhaQ,CAkaT;;;EACAvI,mBAAmB,GAAG;IAClB,KAAK,IAAIgI,CAAC,GAAG,KAAKpH,YAAL,CAAkBqC,QAA1B,EAAoCwF,IAAI,GAAG,KAAhD,EAAuDT,CAAC,IAAI,CAA5D,EAA+DA,CAAC,EAAhE,EAAoE;MAChE,IAAIxD,OAAO,GAAG,KAAK5D,YAAL,CAAkB8H,KAAlB,CAAwBV,CAAxB,CAAd;;MAEA,IAAIA,CAAC,KAAK,CAAV,EAAa;QACTS,IAAI,GAAG,IAAP;;QAEA,IAAI,KAAKjJ,eAAT,EAA0B;UACtBgF,OAAO,GAAG,KAAKhF,eAAf;QACH;MACJ;;MAED,MAAM6D,EAAE,GAAG,KAAK9L,WAAL,CAAiBqI,UAAjB,CAA4B4E,OAA5B,CAAX;MACA,MAAMmE,gBAAgB,GAAGzP,wBAAwB,CAACmK,EAAD,CAAjD;;MAEA,IAAIsF,gBAAJ,EAAsB;QAClB,KAAKnI,aAAL,GAAqBmI,gBAArB;QACA;MACH,CAHD,MAGO,IAAI,CAACF,IAAD,KAAUpF,EAAE,KAAKvM,CAAC,CAACgD,EAAT,IAAeuJ,EAAE,KAAKvM,CAAC,CAACiD,EAAlC,CAAJ,EAA2C;QAC9C,KAAKyG,aAAL,GAAqB/H,YAArB;QACA;MACH,CAHM,MAGA,IAAI,CAACgQ,IAAD,IAASpF,EAAE,KAAKvM,CAAC,CAAC8R,IAAtB,EAA4B;QAC/B,KAAKpI,aAAL,GAAqB1I,YAArB;QACA;MACH,CAHM,MAGA,IAAIuL,EAAE,KAAKvM,CAAC,CAAC+R,MAAb,EAAqB;QACxB,KAAKC,4BAAL,CAAkCd,CAAlC;;QACA;MACH,CAHM,MAGA,IAAI3E,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;QAC1B,KAAKc,aAAL,GAAqB,KAAKQ,wBAA1B;QACA;MACH,CAHM,MAGA,IAAIqC,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;QACtB,KAAK2J,aAAL,GAAqB,KAAKE,WAAL,GAAmB1I,eAAnB,GAAqCH,gBAA1D;QACA;MACH,CAHM,MAGA,IAAI4Q,IAAJ,EAAU;QACb,KAAKjI,aAAL,GAAqBvI,YAArB;QACA;MACH;IACJ;EACJ;;EAED6Q,4BAA4B,CAACC,SAAD,EAAY;IACpC,IAAIA,SAAS,GAAG,CAAhB,EAAmB;MACf,KAAK,IAAIf,CAAC,GAAGe,SAAS,GAAG,CAAzB,EAA4Bf,CAAC,GAAG,CAAhC,EAAmCA,CAAC,EAApC,EAAwC;QACpC,MAAMgB,QAAQ,GAAG,KAAKpI,YAAL,CAAkB8H,KAAlB,CAAwBV,CAAxB,CAAjB;QACA,MAAM3E,EAAE,GAAG,KAAK9L,WAAL,CAAiBqI,UAAjB,CAA4BoJ,QAA5B,CAAX;;QAEA,IAAI3F,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;UACnB;QACH,CAFD,MAEO,IAAI2D,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;UACvB,KAAK+G,aAAL,GAAqB7H,uBAArB;UACA;QACH;MACJ;IACJ;;IAED,KAAK6H,aAAL,GAAqB9H,cAArB;EACH;;EAEDmH,sBAAsB,CAACoJ,IAAD,EAAO;IACzB,KAAKnI,sBAAL,CAA4BoE,IAA5B,CAAiC+D,IAAjC;IACA,KAAKlI,yBAAL;IACA,KAAKC,wBAAL,GAAgCiI,IAAhC;EACH;;EAEDC,qBAAqB,GAAG;IACpB,KAAKpI,sBAAL,CAA4BqI,GAA5B;IACA,KAAKpI,yBAAL;IACA,KAAKC,wBAAL,GAAgC,KAAKF,sBAAL,CAA4B,KAAKC,yBAAjC,CAAhC;EACH,CAveQ,CAyeT;;;EACAqI,+BAA+B,CAAC5E,OAAD,EAAU;IACrC,MAAMnB,EAAE,GAAG,KAAK9L,WAAL,CAAiBqI,UAAjB,CAA4B4E,OAA5B,CAAX;IAEA,OAAOnB,EAAE,KAAKvM,CAAC,CAAC2C,KAAT,IAAkB4J,EAAE,KAAKvM,CAAC,CAACsC,KAA3B,IAAoCiK,EAAE,KAAKvM,CAAC,CAACwC,KAA7C,IAAsD+J,EAAE,KAAKvM,CAAC,CAACuC,KAA/D,IAAwEgK,EAAE,KAAKvM,CAAC,CAACqC,EAAxF;EACH;;EAEDsL,8BAA8B,GAAG;IAC7B,OAAO,KAAKpD,sBAAL,IAA+B,KAAK+H,+BAAL,CAAqC,KAAKxI,YAAL,CAAkBwB,OAAvD,CAAtC;EACH;;EAEDiH,4BAA4B,GAAG;IAC3B,MAAMC,QAAQ,GAAG;MACb3E,MAAM,EAAE,IADK;MAEb4E,aAAa,EAAE;IAFF,CAAjB;;IAKA,KAAK,IAAIvB,CAAC,GAAG,KAAKpH,YAAL,CAAkBqC,QAA/B,EAAyC+E,CAAC,IAAI,CAA9C,EAAiDA,CAAC,EAAlD,EAAsD;MAClD,MAAMwB,WAAW,GAAG,KAAK5I,YAAL,CAAkB8H,KAAlB,CAAwBV,CAAxB,CAApB;MACA,MAAM3E,EAAE,GAAG,KAAK9L,WAAL,CAAiBqI,UAAjB,CAA4B4J,WAA5B,CAAX;MACA,MAAMpD,EAAE,GAAG,KAAK7O,WAAL,CAAiBgL,eAAjB,CAAiCiH,WAAjC,CAAX;;MAEA,IAAInG,EAAE,KAAKvM,CAAC,CAAC4I,QAAT,IAAqB0G,EAAE,KAAKpP,EAAE,CAACH,IAAnC,EAAyC;QACrCyS,QAAQ,CAAC3E,MAAT,GAAkB,KAAKpN,WAAL,CAAiBkS,kBAAjB,CAAoCD,WAApC,CAAlB;QACA;MACH,CAHD,MAGO,IAAInG,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;QACvB6P,QAAQ,CAAC3E,MAAT,GAAkB,KAAKpN,WAAL,CAAiB6L,aAAjB,CAA+BoG,WAA/B,CAAlB;;QAEA,IAAIF,QAAQ,CAAC3E,MAAb,EAAqB;UACjB2E,QAAQ,CAACC,aAAT,GAAyBC,WAAzB;QACH,CAFD,MAEO;UACHF,QAAQ,CAAC3E,MAAT,GAAkB,KAAK/D,YAAL,CAAkB8H,KAAlB,CAAwBV,CAAC,GAAG,CAA5B,CAAlB;QACH;;QAED;MACH;IACJ;;IAED,IAAI,CAACsB,QAAQ,CAAC3E,MAAd,EAAsB;MAClB2E,QAAQ,CAAC3E,MAAT,GAAkB,KAAK/D,YAAL,CAAkB8H,KAAlB,CAAwB,CAAxB,CAAlB;IACH;;IAED,OAAOY,QAAP;EACH;;EAED5E,oBAAoB,CAACF,OAAD,EAAU;IAC1B,MAAM8E,QAAQ,GAAG,KAAKD,4BAAL,EAAjB;;IAEA,IAAIC,QAAQ,CAACC,aAAb,EAA4B;MACxB,KAAKhS,WAAL,CAAiBmS,YAAjB,CAA8BJ,QAAQ,CAAC3E,MAAvC,EAA+CH,OAA/C,EAAwD8E,QAAQ,CAACC,aAAjE;IACH,CAFD,MAEO;MACH,KAAKhS,WAAL,CAAiBsN,WAAjB,CAA6ByE,QAAQ,CAAC3E,MAAtC,EAA8CH,OAA9C;IACH;EACJ;;EAEDqB,iBAAiB,CAAChE,KAAD,EAAQ;IACrB,MAAMyH,QAAQ,GAAG,KAAKD,4BAAL,EAAjB;;IAEA,IAAIC,QAAQ,CAACC,aAAb,EAA4B;MACxB,KAAKhS,WAAL,CAAiBoS,gBAAjB,CAAkCL,QAAQ,CAAC3E,MAA3C,EAAmD9C,KAAnD,EAA0DyH,QAAQ,CAACC,aAAnE;IACH,CAFD,MAEO;MACH,KAAKhS,WAAL,CAAiBuO,UAAjB,CAA4BwD,QAAQ,CAAC3E,MAArC,EAA6C9C,KAA7C;IACH;EACJ,CAxiBQ,CA0iBT;;;EACA+H,iBAAiB,CAACpF,OAAD,EAAU;IACvB,MAAMnB,EAAE,GAAG,KAAK9L,WAAL,CAAiBqI,UAAjB,CAA4B4E,OAA5B,CAAX;IACA,MAAM4B,EAAE,GAAG,KAAK7O,WAAL,CAAiBgL,eAAjB,CAAiCiC,OAAjC,CAAX;IAEA,OAAO3N,IAAI,CAACgT,gBAAL,CAAsBzD,EAAtB,EAA0B/C,EAA1B,CAAP;EACH;;AAhjBQ;;AAmjBbyG,MAAM,CAACC,OAAP,GAAiBrL,MAAjB,C,CAEA;AACA;AACA;AAEA;;AACA,SAASsL,8BAAT,CAAwCC,CAAxC,EAA2CxI,KAA3C,EAAkD;EAC9C,IAAIyI,sBAAsB,GAAGD,CAAC,CAACpJ,wBAAF,CAA2BsJ,iCAA3B,CAA6D1I,KAAK,CAACuD,OAAnE,CAA7B;;EAEA,IAAIkF,sBAAJ,EAA4B;IACxB,IAAI,CAACD,CAAC,CAACrJ,YAAF,CAAemH,QAAf,CAAwBmC,sBAAsB,CAAC1F,OAA/C,CAAL,EAA8D;MAC1DyF,CAAC,CAACpJ,wBAAF,CAA2BuJ,WAA3B,CAAuCF,sBAAvC;MACAA,sBAAsB,GAAG,IAAzB;IACH,CAHD,MAGO,IAAI,CAACD,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0B5I,KAAK,CAACuD,OAAhC,CAAL,EAA+C;MAClDkF,sBAAsB,GAAG,IAAzB;IACH;EACJ,CAPD,MAOO;IACHI,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;EACH;;EAED,OAAOyI,sBAAP;AACH,C,CAED;;;AACA,SAASK,qBAAT,CAA+BN,CAA/B,EAAkCC,sBAAlC,EAA0D;EACtD,IAAIM,aAAa,GAAG,IAApB;;EAEA,KAAK,IAAIxC,CAAC,GAAGiC,CAAC,CAACrJ,YAAF,CAAeqC,QAA5B,EAAsC+E,CAAC,IAAI,CAA3C,EAA8CA,CAAC,EAA/C,EAAmD;IAC/C,MAAMxD,OAAO,GAAGyF,CAAC,CAACrJ,YAAF,CAAe8H,KAAf,CAAqBV,CAArB,CAAhB;;IAEA,IAAIxD,OAAO,KAAK0F,sBAAsB,CAAC1F,OAAvC,EAAgD;MAC5C;IACH;;IAED,IAAIyF,CAAC,CAACL,iBAAF,CAAoBpF,OAApB,CAAJ,EAAkC;MAC9BgG,aAAa,GAAGhG,OAAhB;IACH;EACJ;;EAED,IAAI,CAACgG,aAAL,EAAoB;IAChBP,CAAC,CAACrJ,YAAF,CAAe6J,qBAAf,CAAqCP,sBAAsB,CAAC1F,OAA5D;IACAyF,CAAC,CAACpJ,wBAAF,CAA2BuJ,WAA3B,CAAuCF,sBAAvC;EACH;;EAED,OAAOM,aAAP;AACH,C,CAED;;;AACA,SAASE,WAAT,CAAqBT,CAArB,EAAwBO,aAAxB,EAAuCG,iBAAvC,EAA0D;EACtD,IAAIC,WAAW,GAAGJ,aAAlB;EACA,IAAIK,WAAW,GAAGZ,CAAC,CAACrJ,YAAF,CAAekK,iBAAf,CAAiCN,aAAjC,CAAlB;;EAEA,KAAK,IAAIxC,CAAC,GAAG,CAAR,EAAWxD,OAAO,GAAGqG,WAA1B,EAAuCrG,OAAO,KAAKmG,iBAAnD,EAAsE3C,CAAC,IAAIxD,OAAO,GAAGqG,WAArF,EAAkG;IAC9F;IACAA,WAAW,GAAGZ,CAAC,CAACrJ,YAAF,CAAekK,iBAAf,CAAiCtG,OAAjC,CAAd;IAEA,MAAMuG,YAAY,GAAGd,CAAC,CAACpJ,wBAAF,CAA2BmK,eAA3B,CAA2CxG,OAA3C,CAArB;IACA,MAAMyG,eAAe,GAAGF,YAAY,IAAI/C,CAAC,IAAItQ,kBAA7C;IACA,MAAMwT,4BAA4B,GAAG,CAACH,YAAD,IAAiBE,eAAtD;;IAEA,IAAIC,4BAAJ,EAAkC;MAC9B,IAAID,eAAJ,EAAqB;QACjBhB,CAAC,CAACpJ,wBAAF,CAA2BuJ,WAA3B,CAAuCW,YAAvC;MACH;;MAEDd,CAAC,CAACrJ,YAAF,CAAeuK,MAAf,CAAsB3G,OAAtB;IACH,CAND,MAMO;MACHA,OAAO,GAAG4G,0BAA0B,CAACnB,CAAD,EAAIc,YAAJ,CAApC;;MAEA,IAAIH,WAAW,KAAKJ,aAApB,EAAmC;QAC/BP,CAAC,CAACpJ,wBAAF,CAA2BwK,QAA3B,GAAsCN,YAAtC;MACH;;MAEDd,CAAC,CAAC1S,WAAF,CAAc2O,UAAd,CAAyB0E,WAAzB;MACAX,CAAC,CAAC1S,WAAF,CAAcsN,WAAd,CAA0BL,OAA1B,EAAmCoG,WAAnC;MACAA,WAAW,GAAGpG,OAAd;IACH;EACJ;;EAED,OAAOoG,WAAP;AACH,C,CAED;;;AACA,SAASQ,0BAAT,CAAoCnB,CAApC,EAAuCc,YAAvC,EAAqD;EACjD,MAAM3E,EAAE,GAAG6D,CAAC,CAAC1S,WAAF,CAAcgL,eAAd,CAA8BwI,YAAY,CAACvG,OAA3C,CAAX;EACA,MAAM8G,UAAU,GAAGrB,CAAC,CAAC1S,WAAF,CAAckI,aAAd,CAA4BsL,YAAY,CAACtJ,KAAb,CAAmBuD,OAA/C,EAAwDoB,EAAxD,EAA4D2E,YAAY,CAACtJ,KAAb,CAAmBwD,KAA/E,CAAnB;EAEAgF,CAAC,CAACrJ,YAAF,CAAe2K,OAAf,CAAuBR,YAAY,CAACvG,OAApC,EAA6C8G,UAA7C;EACAP,YAAY,CAACvG,OAAb,GAAuB8G,UAAvB;EAEA,OAAOA,UAAP;AACH,C,CAED;;;AACA,SAASE,gCAAT,CAA0CvB,CAA1C,EAA6CwB,cAA7C,EAA6Db,WAA7D,EAA0E;EACtE,IAAIX,CAAC,CAACb,+BAAF,CAAkCqC,cAAlC,CAAJ,EAAuD;IACnDxB,CAAC,CAACvF,oBAAF,CAAuBkG,WAAvB;EACH,CAFD,MAEO;IACH,MAAMvH,EAAE,GAAG4G,CAAC,CAAC1S,WAAF,CAAcqI,UAAd,CAAyB6L,cAAzB,CAAX;IACA,MAAMrF,EAAE,GAAG6D,CAAC,CAAC1S,WAAF,CAAcgL,eAAd,CAA8BkJ,cAA9B,CAAX;;IAEA,IAAIpI,EAAE,KAAKvM,CAAC,CAAC4I,QAAT,IAAqB0G,EAAE,KAAKpP,EAAE,CAACH,IAAnC,EAAyC;MACrC4U,cAAc,GAAGxB,CAAC,CAAC1S,WAAF,CAAckS,kBAAd,CAAiCgC,cAAjC,CAAjB;IACH;;IAEDxB,CAAC,CAAC1S,WAAF,CAAcsN,WAAd,CAA0B4G,cAA1B,EAA0Cb,WAA1C;EACH;AACJ,C,CAED;;;AACA,SAASc,0BAAT,CAAoCzB,CAApC,EAAuCO,aAAvC,EAAsDN,sBAAtD,EAA8E;EAC1E,MAAM9D,EAAE,GAAG6D,CAAC,CAAC1S,WAAF,CAAcgL,eAAd,CAA8B2H,sBAAsB,CAAC1F,OAArD,CAAX;EACA,MAAM/C,KAAK,GAAGyI,sBAAsB,CAACzI,KAArC;EACA,MAAM6J,UAAU,GAAGrB,CAAC,CAAC1S,WAAF,CAAckI,aAAd,CAA4BgC,KAAK,CAACuD,OAAlC,EAA2CoB,EAA3C,EAA+C3E,KAAK,CAACwD,KAArD,CAAnB;;EAEAgF,CAAC,CAAC3J,WAAF,CAAckK,aAAd,EAA6Bc,UAA7B;;EACArB,CAAC,CAAC1S,WAAF,CAAcsN,WAAd,CAA0B2F,aAA1B,EAAyCc,UAAzC;EAEArB,CAAC,CAACpJ,wBAAF,CAA2B8K,0BAA3B,CAAsDL,UAAtD,EAAkEpB,sBAAsB,CAACzI,KAAzF;EACAwI,CAAC,CAACpJ,wBAAF,CAA2BuJ,WAA3B,CAAuCF,sBAAvC;EAEAD,CAAC,CAACrJ,YAAF,CAAeuK,MAAf,CAAsBjB,sBAAsB,CAAC1F,OAA7C;EACAyF,CAAC,CAACrJ,YAAF,CAAegL,WAAf,CAA2BpB,aAA3B,EAA0Cc,UAA1C;AACH,C,CAED;;;AACA,SAASO,kBAAT,CAA4B5B,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,IAAIyI,sBAAJ;;EAEA,KAAK,IAAIlC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGvQ,kBAApB,EAAwCuQ,CAAC,EAAzC,EAA6C;IACzCkC,sBAAsB,GAAGF,8BAA8B,CAACC,CAAD,EAAIxI,KAAJ,EAAWyI,sBAAX,CAAvD;;IAEA,IAAI,CAACA,sBAAL,EAA6B;MACzB;IACH;;IAED,MAAMM,aAAa,GAAGD,qBAAqB,CAACN,CAAD,EAAIC,sBAAJ,CAA3C;;IAEA,IAAI,CAACM,aAAL,EAAoB;MAChB;IACH;;IAEDP,CAAC,CAACpJ,wBAAF,CAA2BwK,QAA3B,GAAsCnB,sBAAtC;IAEA,MAAMU,WAAW,GAAGF,WAAW,CAACT,CAAD,EAAIO,aAAJ,EAAmBN,sBAAsB,CAAC1F,OAA1C,CAA/B;IACA,MAAMiH,cAAc,GAAGxB,CAAC,CAACrJ,YAAF,CAAekK,iBAAf,CAAiCZ,sBAAsB,CAAC1F,OAAxD,CAAvB;IAEAyF,CAAC,CAAC1S,WAAF,CAAc2O,UAAd,CAAyB0E,WAAzB;IACAY,gCAAgC,CAACvB,CAAD,EAAIwB,cAAJ,EAAoBb,WAApB,CAAhC;IACAc,0BAA0B,CAACzB,CAAD,EAAIO,aAAJ,EAAmBN,sBAAnB,CAA1B;EACH;AACJ,C,CAED;AACA;;;AACA,SAAS7P,WAAT,GAAuB,CACnB;AACH;;AAED,SAASY,gBAAT,CAA0BgP,CAA1B,EAA6B;EACzBA,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAACsE,gBAAX;AACH;;AAED,SAASV,aAAT,CAAuB0P,CAAvB,EAA0BxI,KAA1B,EAAiC;EAC7BwI,CAAC,CAACzE,kBAAF,CAAqB/D,KAArB,EAA4BwI,CAAC,CAACrJ,YAAF,CAAegE,kBAAf,IAAqCqF,CAAC,CAACrJ,YAAF,CAAewB,OAAhF;AACH;;AAED,SAAStE,8BAAT,CAAwCmM,CAAxC,EAA2CxI,KAA3C,EAAkD;EAC9CwI,CAAC,CAACzE,kBAAF,CAAqB/D,KAArB,EAA4BwI,CAAC,CAACrJ,YAAF,CAAe8H,KAAf,CAAqB,CAArB,CAA5B;AACH;;AAED,SAASnK,uBAAT,CAAiC0L,CAAjC,EAAoCxI,KAApC,EAA2C;EACvCwI,CAAC,CAACzE,kBAAF,CAAqB/D,KAArB,EAA4BwI,CAAC,CAAChL,QAA9B;AACH;;AAED,SAAS5D,gBAAT,CAA0B4O,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChCwI,CAAC,CAACrE,iBAAF,CAAoBnE,KAApB;AACH;;AAED,SAASxD,WAAT,CAAqBgM,CAArB,EAAwB;EACpBA,CAAC,CAAC1J,OAAF,GAAY,IAAZ;AACH,C,CAED;AACA;;;AACA,SAAS9F,oBAAT,CAA8BwP,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpCwI,CAAC,CAAC/F,gBAAF,CAAmBzC,KAAnB;;EAEA,MAAMwH,IAAI,GAAGxH,KAAK,CAACqK,WAAN,GAAoBjV,IAAI,CAACkV,aAAL,CAAmBC,MAAvC,GAAgDvV,OAAO,CAACwV,eAAR,CAAwBxK,KAAxB,CAA7D;;EAEA,IAAI,CAAChL,OAAO,CAACyV,YAAR,CAAqBzK,KAArB,CAAL,EAAkC;IAC9BwI,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAACwV,oBAAX;EACH;;EAEDlC,CAAC,CAAC1S,WAAF,CAAc6U,eAAd,CAA8BnC,CAAC,CAAChL,QAAhC,EAA0CgK,IAA1C;EAEAgB,CAAC,CAACzJ,aAAF,GAAkB5I,gBAAlB;AACH;;AAED,SAASsC,kBAAT,CAA4B+P,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClCwI,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAAC0V,cAAX,EAA2B;IAAEC,WAAW,EAAE;EAAf,CAA3B;;EACArC,CAAC,CAAC1S,WAAF,CAAc6U,eAAd,CAA8BnC,CAAC,CAAChL,QAAhC,EAA0CpI,IAAI,CAACkV,aAAL,CAAmBC,MAA7D;EACA/B,CAAC,CAACzJ,aAAF,GAAkB5I,gBAAlB;;EACAqS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAAS3G,kBAAT,CAA4BmP,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAACD,IAAxB,EAA8B;IAC1BoT,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAACzJ,aAAF,GAAkB3I,gBAAlB;EACH,CAHD,MAGO;IACHgD,eAAe,CAACoP,CAAD,EAAIxI,KAAJ,CAAf;EACH;AACJ;;AAED,SAAS1G,gBAAT,CAA0BkP,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAT,IAAiBwM,EAAE,KAAKvM,CAAC,CAAC8R,IAA1B,IAAkCvF,EAAE,KAAKvM,CAAC,CAAC4C,IAA3C,IAAmD2J,EAAE,KAAKvM,CAAC,CAACyV,EAAhE,EAAoE;IAChE1R,eAAe,CAACoP,CAAD,EAAIxI,KAAJ,CAAf;EACH;AACJ;;AAED,SAAS5G,eAAT,CAAyBoP,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/BwI,CAAC,CAAClK,sBAAF;;EACAkK,CAAC,CAACzJ,aAAF,GAAkB3I,gBAAlB;;EACAoS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAASvG,kBAAT,CAA4B+O,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC8R,IAAb,EAAmB;IACtBqB,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAACvJ,WAAF,GAAgBuJ,CAAC,CAACrJ,YAAF,CAAewB,OAA/B;IACA6H,CAAC,CAACzJ,aAAF,GAAkB1I,YAAlB;EACH,CAJM,MAIA;IACHkD,eAAe,CAACiP,CAAD,EAAIxI,KAAJ,CAAf;EACH;AACJ;;AAED,SAAStG,gBAAT,CAA0B8O,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAAC8R,IAAT,IAAiBvF,EAAE,KAAKvM,CAAC,CAAC4C,IAA1B,IAAkC2J,EAAE,KAAKvM,CAAC,CAACD,IAA3C,IAAmDwM,EAAE,KAAKvM,CAAC,CAACyV,EAAhE,EAAoE;IAChEvR,eAAe,CAACiP,CAAD,EAAIxI,KAAJ,CAAf;EACH,CAFD,MAEO;IACHwI,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAAC6V,gCAAX;EACH;AACJ;;AAED,SAASxR,eAAT,CAAyBiP,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/BwI,CAAC,CAAC9E,kBAAF,CAAqBrO,CAAC,CAAC8R,IAAvB;;EACAqB,CAAC,CAACvJ,WAAF,GAAgBuJ,CAAC,CAACrJ,YAAF,CAAewB,OAA/B;EACA6H,CAAC,CAACzJ,aAAF,GAAkB1I,YAAlB;;EACAmS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAASnG,cAAT,CAAwB2O,CAAxB,EAA2BxI,KAA3B,EAAkC;EAC9B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2V,IAAT,IAAiBpJ,EAAE,KAAKvM,CAAC,CAAC4V,QAA1B,IAAsCrJ,EAAE,KAAKvM,CAAC,CAAC6V,OAA/C,IAA0DtJ,EAAE,KAAKvM,CAAC,CAAC8V,IAAnE,IAA2EvJ,EAAE,KAAKvM,CAAC,CAAC+V,IAAxF,EAA8F;IACjG5C,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACA4K,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;EACH,CAHM,MAGA,IAAI/D,EAAE,KAAKvM,CAAC,CAACwM,KAAb,EAAoB;IACvB2G,CAAC,CAACxH,oBAAF,CAAuBhB,KAAvB,EAA8BzL,SAAS,CAAC+M,IAAV,CAAeS,MAA7C;EACH,CAFM,MAEA,IAAIH,EAAE,KAAKvM,CAAC,CAACgN,QAAb,EAAuB;IAC1B,IAAImG,CAAC,CAACrL,OAAF,CAAUxH,gBAAd,EAAgC;MAC5B6S,CAAC,CAACxH,oBAAF,CAAuBhB,KAAvB,EAA8BzL,SAAS,CAAC+M,IAAV,CAAegB,OAA7C;IACH,CAFD,MAEO;MACHkG,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;MACAoT,CAAC,CAACzJ,aAAF,GAAkBzI,sBAAlB;IACH;EACJ,CAPM,MAOA,IAAIsL,EAAE,KAAKvM,CAAC,CAAC+M,QAAT,IAAqBR,EAAE,KAAKvM,CAAC,CAAC2M,KAAlC,EAAyC;IAC5CwG,CAAC,CAACxH,oBAAF,CAAuBhB,KAAvB,EAA8BzL,SAAS,CAAC+M,IAAV,CAAegB,OAA7C;EACH,CAFM,MAEA,IAAIV,EAAE,KAAKvM,CAAC,CAACkN,MAAb,EAAqB;IACxBiG,CAAC,CAACxH,oBAAF,CAAuBhB,KAAvB,EAA8BzL,SAAS,CAAC+M,IAAV,CAAekB,WAA7C;EACH,CAFM,MAEA,IAAIZ,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;IAC1BuK,CAAC,CAAC7E,eAAF,CAAkB3D,KAAlB,EAAyBzK,EAAE,CAACH,IAA5B;;IACAoT,CAAC,CAACpJ,wBAAF,CAA2BiM,YAA3B;IACA7C,CAAC,CAAC9I,UAAF,GAAe,KAAf;IACA8I,CAAC,CAACzJ,aAAF,GAAkB5H,gBAAlB;;IACAqR,CAAC,CAACpK,sBAAF,CAAyBjH,gBAAzB;EACH,CANM,MAMA,IAAIyK,EAAE,KAAKvM,CAAC,CAAC8R,IAAb,EAAmB;IACtBqB,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAACoW,+BAAX;EACH,CAFM,MAEA;IACH3R,WAAW,CAAC6O,CAAD,EAAIxI,KAAJ,CAAX;EACH;AACJ;;AAED,SAASlG,YAAT,CAAsB0O,CAAtB,EAAyBxI,KAAzB,EAAgC;EAC5B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAAC8R,IAAb,EAAmB;IACfqB,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACAc,CAAC,CAACzJ,aAAF,GAAkBxI,eAAlB;EACH,CAHD,MAGO,IAAIqL,EAAE,KAAKvM,CAAC,CAAC4C,IAAT,IAAiB2J,EAAE,KAAKvM,CAAC,CAACyV,EAA1B,IAAgClJ,EAAE,KAAKvM,CAAC,CAACD,IAA7C,EAAmD;IACtDuE,WAAW,CAAC6O,CAAD,EAAIxI,KAAJ,CAAX;EACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;IAC1B,IAAIuK,CAAC,CAACrJ,YAAF,CAAeoM,SAAf,GAA2B,CAA/B,EAAkC;MAC9B/C,CAAC,CAACrJ,YAAF,CAAeqM,gCAAf;;MAEA,IAAIhD,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAAC4I,QAAxC,EAAkD;QAC9CuK,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAACwW,qCAAX;MACH;;MAEDlD,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC4I,QAAvC;MACAuK,CAAC,CAACpJ,wBAAF,CAA2BuH,iBAA3B;;MACA6B,CAAC,CAACf,qBAAF;;MACAe,CAAC,CAACjK,mBAAF;IACH,CAXD,MAWO;MACHiK,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAAC6V,gCAAX;IACH;EACJ,CAfM,MAeA;IACHvC,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAAC6V,gCAAX;EACH;AACJ;;AAED,SAASpR,WAAT,CAAqB6O,CAArB,EAAwBxI,KAAxB,EAA+B;EAC3BwI,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACAc,CAAC,CAACzJ,aAAF,GAAkBxI,eAAlB;;EACAiS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAAShG,sBAAT,CAAgCwO,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IACH4B,EAAE,KAAKvM,CAAC,CAAC4V,QAAT,IACArJ,EAAE,KAAKvM,CAAC,CAAC6V,OADT,IAEAtJ,EAAE,KAAKvM,CAAC,CAAC8R,IAFT,IAGAvF,EAAE,KAAKvM,CAAC,CAAC8V,IAHT,IAIAvJ,EAAE,KAAKvM,CAAC,CAAC+V,IAJT,IAKAxJ,EAAE,KAAKvM,CAAC,CAAC+M,QALT,IAMAR,EAAE,KAAKvM,CAAC,CAAC2M,KAPN,EAQL;IACEnI,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAVM,MAUA,IAAI4B,EAAE,KAAKvM,CAAC,CAACgN,QAAb,EAAuB;IAC1BmG,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAACyW,oBAAX;EACH,CAFM,MAEA;IACH5R,mBAAmB,CAACyO,CAAD,EAAIxI,KAAJ,CAAnB;EACH;AACJ;;AAED,SAAS/F,oBAAT,CAA8BuO,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACgN,QAAb,EAAuB;IACnBmG,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACAc,CAAC,CAACzJ,aAAF,GAAkB1I,YAAlB;EACH,CAHD,MAGO,IAAIuL,EAAE,KAAKvM,CAAC,CAACyV,EAAb,EAAiB;IACpB/Q,mBAAmB,CAACyO,CAAD,EAAIxI,KAAJ,CAAnB;EACH,CAFM,MAEA;IACHwI,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAAC6V,gCAAX;EACH;AACJ;;AAED,SAAShR,mBAAT,CAA6ByO,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,MAAM4L,OAAO,GACT5L,KAAK,CAACE,IAAN,KAAe3L,SAAS,CAAC4E,SAAzB,GAAqCjE,GAAG,CAAC2W,wBAAzC,GAAoE3W,GAAG,CAAC4W,iCAD5E;;EAGAtD,CAAC,CAAC3I,IAAF,CAAO+L,OAAP;;EACApD,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACAc,CAAC,CAACzJ,aAAF,GAAkB1I,YAAlB;;EACAmS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAAS7F,iBAAT,CAA2BqO,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAb,EAAmB;IACtBuQ,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAAC9I,UAAF,GAAe,KAAf;IACA8I,CAAC,CAACzJ,aAAF,GAAkBvI,YAAlB;EACH,CAJM,MAIA,IAAIoL,EAAE,KAAKvM,CAAC,CAAC6C,QAAb,EAAuB;IAC1BsQ,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAACzJ,aAAF,GAAkB1H,gBAAlB;EACH,CAHM,MAGA,IACHuK,EAAE,KAAKvM,CAAC,CAAC2V,IAAT,IACApJ,EAAE,KAAKvM,CAAC,CAAC4V,QADT,IAEArJ,EAAE,KAAKvM,CAAC,CAAC6V,OAFT,IAGAtJ,EAAE,KAAKvM,CAAC,CAAC8V,IAHT,IAIAvJ,EAAE,KAAKvM,CAAC,CAAC+V,IAJT,IAKAxJ,EAAE,KAAKvM,CAAC,CAAC+M,QALT,IAMAR,EAAE,KAAKvM,CAAC,CAACkN,MANT,IAOAX,EAAE,KAAKvM,CAAC,CAAC2M,KAPT,IAQAJ,EAAE,KAAKvM,CAAC,CAAC4I,QART,IASA2D,EAAE,KAAKvM,CAAC,CAACwM,KAVN,EAWL;IACE2G,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAAC6W,yBAAX;;IACAvD,CAAC,CAACrJ,YAAF,CAAesE,IAAf,CAAoB+E,CAAC,CAACvJ,WAAtB;IACApF,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;IACAwI,CAAC,CAACrJ,YAAF,CAAeuK,MAAf,CAAsBlB,CAAC,CAACvJ,WAAxB;EACH,CAhBM,MAgBA,IAAI2C,EAAE,KAAKvM,CAAC,CAAC8R,IAAb,EAAmB;IACtBqB,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAACoW,+BAAX;EACH,CAFM,MAEA;IACHpR,cAAc,CAACsO,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAAS5F,eAAT,CAAyBoO,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAAC4C,IAAT,IAAiB2J,EAAE,KAAKvM,CAAC,CAACD,IAA1B,IAAkCwM,EAAE,KAAKvM,CAAC,CAACyV,EAA/C,EAAmD;IAC/C5Q,cAAc,CAACsO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;IAC1BnE,YAAY,CAAC0O,CAAD,EAAIxI,KAAJ,CAAZ;EACH,CAFM,MAEA;IACHwI,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAAC6V,gCAAX;EACH;AACJ;;AAED,SAAS7Q,cAAT,CAAwBsO,CAAxB,EAA2BxI,KAA3B,EAAkC;EAC9BwI,CAAC,CAAC9E,kBAAF,CAAqBrO,CAAC,CAAC4C,IAAvB;;EACAuQ,CAAC,CAACzJ,aAAF,GAAkBvI,YAAlB;;EACAgS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAAS1F,yBAAT,CAAmCkO,CAAnC,EAAsCxI,KAAtC,EAA6C;EACzCwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrE,iBAAF,CAAoBnE,KAApB;AACH;;AAED,SAAS3F,eAAT,CAAyBmO,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/BwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrE,iBAAF,CAAoBnE,KAApB;;EACAwI,CAAC,CAAC9I,UAAF,GAAe,KAAf;AACH;;AAED,SAASsM,kBAAT,CAA4BxD,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeoM,SAAf,KAA6B,CAAjC,EAAoC;IAChC/C,CAAC,CAAC1S,WAAF,CAAcmW,eAAd,CAA8BzD,CAAC,CAACrJ,YAAF,CAAe8H,KAAf,CAAqB,CAArB,CAA9B,EAAuDjH,KAAK,CAACwD,KAA7D;EACH;AACJ;;AAED,SAAS0I,kBAAT,CAA4B1D,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,MAAMmM,WAAW,GAAG3D,CAAC,CAACrJ,YAAF,CAAeiN,gCAAf,EAApB;;EAEA,IAAID,WAAW,IAAI3D,CAAC,CAACrJ,YAAF,CAAeoM,SAAf,KAA6B,CAAhD,EAAmD;IAC/C/C,CAAC,CAAC9I,UAAF,GAAe,KAAf;IACA8I,CAAC,CAAC1S,WAAF,CAAcmW,eAAd,CAA8BE,WAA9B,EAA2CnM,KAAK,CAACwD,KAAjD;EACH;AACJ;;AAED,SAAS6I,sBAAT,CAAgC7D,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtC,MAAMmM,WAAW,GAAG3D,CAAC,CAACrJ,YAAF,CAAeiN,gCAAf,EAApB;;EAEA,IAAI5D,CAAC,CAAC9I,UAAF,IAAgByM,WAApB,EAAiC;IAC7B3D,CAAC,CAAC1S,WAAF,CAAc2O,UAAd,CAAyB0H,WAAzB;IACA3D,CAAC,CAACrJ,YAAF,CAAemN,qBAAf;;IACA9D,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAACzJ,aAAF,GAAkB1H,gBAAlB;EACH;AACJ;;AAED,SAASkV,qBAAT,CAA+B/D,CAA/B,EAAkCxI,KAAlC,EAAyC;EACrC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH;;AAED,SAASqX,4BAAT,CAAsCjE,CAAtC,EAAyCxI,KAAzC,EAAgD;EAC5C,IAAIwI,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED,MAAMhF,EAAE,GAAG4G,CAAC,CAACrJ,YAAF,CAAesM,cAA1B;;EAEA,IAAI7J,EAAE,KAAKvM,CAAC,CAACqX,EAAT,IAAe9K,EAAE,KAAKvM,CAAC,CAACsX,EAAxB,IAA8B/K,EAAE,KAAKvM,CAAC,CAACuX,EAAvC,IAA6ChL,EAAE,KAAKvM,CAAC,CAACwX,EAAtD,IAA4DjL,EAAE,KAAKvM,CAAC,CAACyX,EAArE,IAA2ElL,EAAE,KAAKvM,CAAC,CAAC0X,EAAxF,EAA4F;IACxFvE,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACH;;EAEDc,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH;;AAED,SAAS4X,iBAAT,CAA2BxE,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B,EALiC,CAMjC;EACA;;;EACAoT,CAAC,CAAC7I,eAAF,GAAoB,IAApB;EACA6I,CAAC,CAAC9I,UAAF,GAAe,KAAf;AACH;;AAED,SAASuN,kBAAT,CAA4BzE,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,MAAMkN,UAAU,GAAG1E,CAAC,CAACrJ,YAAF,CAAeoM,SAAf,GAA2B,CAA9C;;EAEA,IAAI,CAAC/C,CAAC,CAACtJ,WAAH,IAAkBgO,UAAtB,EAAkC;IAC9B,IAAI1E,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;MACtC0B,CAAC,CAAC5B,cAAF;IACH;;IAED4B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IAEA,IAAI,CAAC8X,UAAL,EAAiB;MACb1E,CAAC,CAACtJ,WAAF,GAAgBsJ,CAAC,CAACrJ,YAAF,CAAewB,OAA/B;IACH;EACJ;AACJ;;AAED,SAASwM,sBAAT,CAAgC3E,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtCwI,CAAC,CAAC9I,UAAF,GAAe,KAAf;EAEA,MAAMkC,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,KAAK,IAAIgD,CAAC,GAAGiC,CAAC,CAACrJ,YAAF,CAAeqC,QAA5B,EAAsC+E,CAAC,IAAI,CAA3C,EAA8CA,CAAC,EAA/C,EAAmD;IAC/C,MAAMxD,OAAO,GAAGyF,CAAC,CAACrJ,YAAF,CAAe8H,KAAf,CAAqBV,CAArB,CAAhB;IACA,MAAM6G,SAAS,GAAG5E,CAAC,CAAC1S,WAAF,CAAcqI,UAAd,CAAyB4E,OAAzB,CAAlB;IACA,IAAIsK,OAAO,GAAG,IAAd;;IAEA,IAAIzL,EAAE,KAAKvM,CAAC,CAACiY,EAAT,IAAeF,SAAS,KAAK/X,CAAC,CAACiY,EAAnC,EAAuC;MACnCD,OAAO,GAAGhY,CAAC,CAACiY,EAAZ;IACH,CAFD,MAEO,IAAI,CAAC1L,EAAE,KAAKvM,CAAC,CAACkY,EAAT,IAAe3L,EAAE,KAAKvM,CAAC,CAACmY,EAAzB,MAAiCJ,SAAS,KAAK/X,CAAC,CAACkY,EAAhB,IAAsBH,SAAS,KAAK/X,CAAC,CAACmY,EAAvE,CAAJ,EAAgF;MACnFH,OAAO,GAAGD,SAAV;IACH;;IAED,IAAIC,OAAJ,EAAa;MACT7E,CAAC,CAACrJ,YAAF,CAAe0H,mCAAf,CAAmDwG,OAAnD;MACA7E,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqCsG,OAArC;MACA;IACH;;IAED,IAAID,SAAS,KAAK/X,CAAC,CAACoY,OAAhB,IAA2BL,SAAS,KAAK/X,CAAC,CAACqY,GAA3C,IAAkDN,SAAS,KAAK/X,CAAC,CAACyR,CAAlE,IAAuE0B,CAAC,CAACL,iBAAF,CAAoBpF,OAApB,CAA3E,EAAyG;MACrG;IACH;EACJ;;EAED,IAAIyF,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH;;AAED,SAASuY,uBAAT,CAAiCnF,CAAjC,EAAoCxI,KAApC,EAA2C;EACvC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAAC7K,SAAF,CAAYyD,KAAZ,GAAoB7M,SAAS,CAAC+M,IAAV,CAAeC,SAAnC;AACH;;AAED,SAASqM,oBAAT,CAA8BpF,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BvT,CAAC,CAACwY,MAA5B,CAAJ,EAAyC;IACrCrF,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;IACA+B,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAACwY,MAAvC;EACH;;EAEDrF,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAAC9I,UAAF,GAAe,KAAf;AACH;;AAED,SAASoO,eAAT,CAAyBtF,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/B,MAAM+N,kBAAkB,GAAGvF,CAAC,CAACpJ,wBAAF,CAA2BsJ,iCAA3B,CAA6DrT,CAAC,CAAC2Y,CAA/D,CAA3B;;EAEA,IAAID,kBAAJ,EAAwB;IACpB3D,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;IACAwI,CAAC,CAACrJ,YAAF,CAAeuK,MAAf,CAAsBqE,kBAAkB,CAAChL,OAAzC;IACAyF,CAAC,CAACpJ,wBAAF,CAA2BuJ,WAA3B,CAAuCoF,kBAAvC;EACH;;EAEDvF,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAACpJ,wBAAF,CAA2B6O,WAA3B,CAAuCzF,CAAC,CAACrJ,YAAF,CAAewB,OAAtD,EAA+DX,KAA/D;AACH;;AAED,SAASkO,eAAT,CAAyB1F,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/BwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAACpJ,wBAAF,CAA2B6O,WAA3B,CAAuCzF,CAAC,CAACrJ,YAAF,CAAewB,OAAtD,EAA+DX,KAA/D;AACH;;AAED,SAASmO,kBAAT,CAA4B3F,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClCwI,CAAC,CAACxC,oCAAF;;EAEA,IAAIwC,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BvT,CAAC,CAAC+Y,IAA5B,CAAJ,EAAuC;IACnChE,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;;IACAwI,CAAC,CAACxC,oCAAF;EACH;;EAEDwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAACpJ,wBAAF,CAA2B6O,WAA3B,CAAuCzF,CAAC,CAACrJ,YAAF,CAAewB,OAAtD,EAA+DX,KAA/D;AACH;;AAED,SAASqO,oBAAT,CAA8B7F,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpCwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAACpJ,wBAAF,CAA2BiM,YAA3B;EACA7C,CAAC,CAAC9I,UAAF,GAAe,KAAf;AACH;;AAED,SAAS4O,mBAAT,CAA6B9F,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,IACIwI,CAAC,CAAC1S,WAAF,CAAc0U,eAAd,CAA8BhC,CAAC,CAAChL,QAAhC,MAA8CpI,IAAI,CAACkV,aAAL,CAAmBC,MAAjE,IACA/B,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAFJ,EAGE;IACE0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAAC9I,UAAF,GAAe,KAAf;EACA8I,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;AACH;;AAED,SAAS6X,kBAAT,CAA4B/F,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClCwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAAC9I,UAAF,GAAe,KAAf;EACAM,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;AACH;;AAED,SAAS6I,mBAAT,CAA6BhG,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnCwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EAEA,MAAMqZ,SAAS,GAAGla,SAAS,CAACma,YAAV,CAAuB1O,KAAvB,EAA8BvK,KAAK,CAACkZ,IAApC,CAAlB;;EAEA,IAAI,CAACF,SAAD,IAAcA,SAAS,CAACG,WAAV,OAA4B7Y,iBAA9C,EAAiE;IAC7DyS,CAAC,CAAC9I,UAAF,GAAe,KAAf;EACH;;EAEDM,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;AACH;;AAED,SAASkJ,mBAAT,CAA6BrG,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnCwI,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACA4K,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;AACH;;AAED,SAASmJ,gBAAT,CAA0BtG,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAAC9I,UAAF,GAAe,KAAf;EACAM,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;AACH;;AAED,SAASoJ,mBAAT,CAA6BvG,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnCA,KAAK,CAACuD,OAAN,GAAgBlO,CAAC,CAAC2Z,GAAlB;EACAT,kBAAkB,CAAC/F,CAAD,EAAIxI,KAAJ,CAAlB;AACH;;AAED,SAASiP,sBAAT,CAAgCzG,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtCwI,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B,EADsC,CAEtC;EACA;;;EACAoT,CAAC,CAAC7I,eAAF,GAAoB,IAApB;EACA6I,CAAC,CAAC7K,SAAF,CAAYyD,KAAZ,GAAoB7M,SAAS,CAAC+M,IAAV,CAAeS,MAAnC;EACAyG,CAAC,CAACxJ,qBAAF,GAA0BwJ,CAAC,CAACzJ,aAA5B;EACAyJ,CAAC,CAAC9I,UAAF,GAAe,KAAf;EACA8I,CAAC,CAACzJ,aAAF,GAAkBtI,SAAlB;AACH;;AAED,SAASyY,iBAAT,CAA2B1G,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAAC9I,UAAF,GAAe,KAAf;;EACA8I,CAAC,CAACxH,oBAAF,CAAuBhB,KAAvB,EAA8BzL,SAAS,CAAC+M,IAAV,CAAegB,OAA7C;AACH;;AAED,SAAS6M,oBAAT,CAA8B3G,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpCwI,CAAC,CAAC9I,UAAF,GAAe,KAAf;;EACA8I,CAAC,CAACxH,oBAAF,CAAuBhB,KAAvB,EAA8BzL,SAAS,CAAC+M,IAAV,CAAegB,OAA7C;AACH,C,CAED;AACA;;;AACA,SAAS8M,qBAAT,CAA+B5G,CAA/B,EAAkCxI,KAAlC,EAAyC;EACrCwI,CAAC,CAACxH,oBAAF,CAAuBhB,KAAvB,EAA8BzL,SAAS,CAAC+M,IAAV,CAAegB,OAA7C;AACH;;AAED,SAAS+M,oBAAT,CAA8B7G,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpCwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAAC9I,UAAF,GAAe,KAAf;;EAEA,IACI8I,CAAC,CAACzJ,aAAF,KAAoBrI,aAApB,IACA8R,CAAC,CAACzJ,aAAF,KAAoBnI,eADpB,IAEA4R,CAAC,CAACzJ,aAAF,KAAoBjI,kBAFpB,IAGA0R,CAAC,CAACzJ,aAAF,KAAoBhI,WAHpB,IAIAyR,CAAC,CAACzJ,aAAF,KAAoB/H,YALxB,EAME;IACEwR,CAAC,CAACzJ,aAAF,GAAkB7H,uBAAlB;EACH,CARD,MAQO;IACHsR,CAAC,CAACzJ,aAAF,GAAkB9H,cAAlB;EACH;AACJ;;AAED,SAASqY,sBAAT,CAAgC9G,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtC,IAAIwI,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAACka,MAAxC,EAAgD;IAC5C/G,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACH;;EAEDc,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH;;AAED,SAASoa,gBAAT,CAA0BhH,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BvT,CAAC,CAACoa,IAA5B,CAAJ,EAAuC;IACnCjH,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;EACH;;EAED+B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH;;AAED,SAASsa,gBAAT,CAA0BlH,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BvT,CAAC,CAACoa,IAA5B,CAAJ,EAAuC;IACnCjH,CAAC,CAACrJ,YAAF,CAAe0H,mCAAf,CAAmDxR,CAAC,CAACsa,GAArD;EACH;;EAEDnH,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH;;AAED,SAASwa,kBAAT,CAA4BpH,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAJ,EAA0C;IACtC0B,CAAC,CAAC5B,cAAF;EACH;;EAED4B,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH;;AAED,SAASya,kBAAT,CAA4BrH,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClCwI,CAAC,CAACxC,oCAAF;;EAEA/Q,cAAc,CAAC6a,sBAAf,CAAsC9P,KAAtC;EACA/K,cAAc,CAAC8a,mBAAf,CAAmC/P,KAAnC;;EAEA,IAAIA,KAAK,CAAC0F,WAAV,EAAuB;IACnB8C,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACsP,MAA3B;EACH,CAFD,MAEO;IACH2D,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACsP,MAA3B;EACH;;EAED7E,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;AACH;;AAED,SAASqK,iBAAT,CAA2BxH,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjCwI,CAAC,CAACxC,oCAAF;;EAEA/Q,cAAc,CAACgb,mBAAf,CAAmCjQ,KAAnC;EACA/K,cAAc,CAAC8a,mBAAf,CAAmC/P,KAAnC;;EAEA,IAAIA,KAAK,CAAC0F,WAAV,EAAuB;IACnB8C,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACuP,GAA3B;EACH,CAFD,MAEO;IACH0D,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACuP,GAA3B;EACH;;EAED9E,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;AACH;;AAED,SAASuK,qBAAT,CAA+B1H,CAA/B,EAAkCxI,KAAlC,EAAyC;EACrCwI,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;AACH,C,CAED;AACA;;;AACA,SAASmF,cAAT,CAAwBiO,CAAxB,EAA2BxI,KAA3B,EAAkC;EAC9B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,QAAQ3B,EAAE,CAACvB,MAAX;IACI,KAAK,CAAL;MACI,IAAIuB,EAAE,KAAKvM,CAAC,CAAC8a,CAAT,IAAcvO,EAAE,KAAKvM,CAAC,CAAC+a,CAAvB,IAA4BxO,EAAE,KAAKvM,CAAC,CAACgb,CAArC,IAA0CzO,EAAE,KAAKvM,CAAC,CAACib,CAAvD,EAA0D;QACtDpC,eAAe,CAAC1F,CAAD,EAAIxI,KAAJ,CAAf;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACyR,CAAb,EAAgB;QACnByF,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2Y,CAAb,EAAgB;QACnBF,eAAe,CAACtF,CAAD,EAAIxI,KAAJ,CAAf;MACH,CAFM,MAEA;QACHkQ,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACkb,EAAT,IAAe3O,EAAE,KAAKvM,CAAC,CAACmb,EAAxB,IAA8B5O,EAAE,KAAKvM,CAAC,CAACob,EAA3C,EAA+C;QAC3ClE,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACqX,EAAT,IAAe9K,EAAE,KAAKvM,CAAC,CAACsX,EAAxB,IAA8B/K,EAAE,KAAKvM,CAAC,CAACuX,EAAvC,IAA6ChL,EAAE,KAAKvM,CAAC,CAACwX,EAAtD,IAA4DjL,EAAE,KAAKvM,CAAC,CAACyX,EAArE,IAA2ElL,EAAE,KAAKvM,CAAC,CAAC0X,EAAxF,EAA4F;QAC/FN,4BAA4B,CAACjE,CAAD,EAAIxI,KAAJ,CAA5B;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACiY,EAAT,IAAe1L,EAAE,KAAKvM,CAAC,CAACkY,EAAxB,IAA8B3L,EAAE,KAAKvM,CAAC,CAACmY,EAA3C,EAA+C;QAClDL,sBAAsB,CAAC3E,CAAD,EAAIxI,KAAJ,CAAtB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACqb,EAAT,IAAe9O,EAAE,KAAKvM,CAAC,CAACsb,EAA5B,EAAgC;QACnCzC,eAAe,CAAC1F,CAAD,EAAIxI,KAAJ,CAAf;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyV,EAAb,EAAiB;QACpByD,kBAAkB,CAAC/F,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACub,EAAb,EAAiB;QACpB9B,gBAAgB,CAACtG,CAAD,EAAIxI,KAAJ,CAAhB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACwb,EAAb,EAAiB;QACpBrB,gBAAgB,CAAChH,CAAD,EAAIxI,KAAJ,CAAhB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyb,EAAT,IAAelP,EAAE,KAAKvM,CAAC,CAAC0b,EAA5B,EAAgC;QACnCrB,gBAAgB,CAAClH,CAAD,EAAIxI,KAAJ,CAAhB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACiD,EAAT,IAAesJ,EAAE,KAAKvM,CAAC,CAACgD,EAAxB,IAA8BuJ,EAAE,KAAKvM,CAAC,CAACqC,EAA3C,EAA+C;QAClDwY,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACqY,GAAT,IAAgB9L,EAAE,KAAKvM,CAAC,CAAC2b,GAAzB,IAAgCpP,EAAE,KAAKvM,CAAC,CAAC4b,GAA7C,EAAkD;QAC9C1E,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC6b,GAAb,EAAkB;QACrBlE,iBAAiB,CAACxE,CAAD,EAAIxI,KAAJ,CAAjB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC8b,GAAb,EAAkB;QACrBjD,eAAe,CAAC1F,CAAD,EAAIxI,KAAJ,CAAf;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2Z,GAAT,IAAgBpN,EAAE,KAAKvM,CAAC,CAAC+b,GAA7B,EAAkC;QACrC7C,kBAAkB,CAAC/F,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4M,GAAb,EAAkB;QACrBiN,iBAAiB,CAAC1G,CAAD,EAAIxI,KAAJ,CAAjB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyP,GAAb,EAAkB;QACrBkL,iBAAiB,CAACxH,CAAD,EAAIxI,KAAJ,CAAjB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACsa,GAAb,EAAkB;QACrBH,gBAAgB,CAAChH,CAAD,EAAIxI,KAAJ,CAAhB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+C,GAAb,EAAkB;QACrB8X,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;QACf4W,kBAAkB,CAACxD,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2V,IAAT,IAAiBpJ,EAAE,KAAKvM,CAAC,CAAC8V,IAA1B,IAAkCvJ,EAAE,KAAKvM,CAAC,CAAC+V,IAA/C,EAAqD;QACxDvR,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAb,EAAmB;QACtBiU,kBAAkB,CAAC1D,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACgc,IAAT,IAAiBzP,EAAE,KAAKvM,CAAC,CAACic,IAA9B,EAAoC;QACvC/E,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACqM,IAAb,EAAmB;QACtBuL,kBAAkB,CAACzE,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACkc,IAAT,IAAiB3P,EAAE,KAAKvM,CAAC,CAACmc,IAA9B,EAAoC;QACvCtD,eAAe,CAAC1F,CAAD,EAAIxI,KAAJ,CAAf;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+Y,IAAb,EAAmB;QACtBD,kBAAkB,CAAC3F,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACoc,IAAb,EAAmB;QACtBlD,kBAAkB,CAAC/F,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACqc,IAAb,EAAmB;QACtB7B,kBAAkB,CAACrH,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACic,IAAb,EAAmB;QACtB1B,kBAAkB,CAACpH,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC8R,IAAb,EAAmB;QACtB+I,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2M,KAAT,IAAkBJ,EAAE,KAAKvM,CAAC,CAACwM,KAA/B,EAAsC;QAClChI,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACsc,KAAb,EAAoB;QACvBpF,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACuc,KAAb,EAAoB;QACvB1D,eAAe,CAAC1F,CAAD,EAAIxI,KAAJ,CAAf;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;QACvBsW,mBAAmB,CAAC9F,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACwc,KAAb,EAAoB;QACvBtD,kBAAkB,CAAC/F,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyc,KAAb,EAAoB;QACvBtD,mBAAmB,CAAChG,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC0c,KAAT,IAAkBnQ,EAAE,KAAKvM,CAAC,CAAC2c,KAA/B,EAAsC;QACzCnD,mBAAmB,CAACrG,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4c,KAAb,EAAoB;QACvBlD,mBAAmB,CAACvG,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC6c,KAAT,IAAkBtQ,EAAE,KAAKvM,CAAC,CAACsC,KAA3B,IAAoCiK,EAAE,KAAKvM,CAAC,CAACwC,KAA7C,IAAsD+J,EAAE,KAAKvM,CAAC,CAACuC,KAAnE,EAA0E;QAC7EsY,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACkN,MAAb,EAAqB;QACjB1I,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFD,MAEO,IACH4B,EAAE,KAAKvM,CAAC,CAAC8c,MAAT,IACAvQ,EAAE,KAAKvM,CAAC,CAAC+c,MADT,IAEAxQ,EAAE,KAAKvM,CAAC,CAACgd,MAFT,IAGAzQ,EAAE,KAAKvM,CAAC,CAACid,MAHT,IAIA1Q,EAAE,KAAKvM,CAAC,CAACkd,MAJT,IAKA3Q,EAAE,KAAKvM,CAAC,CAACmd,MANN,EAOL;QACEjG,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CATM,MASA,IAAI4B,EAAE,KAAKvM,CAAC,CAACwY,MAAb,EAAqB;QACxBD,oBAAoB,CAACpF,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACod,MAAT,IAAmB7Q,EAAE,KAAKvM,CAAC,CAACqd,MAAhC,EAAwC;QAC3CxE,eAAe,CAAC1F,CAAD,EAAIxI,KAAJ,CAAf;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACsd,MAAT,IAAmB/Q,EAAE,KAAKvM,CAAC,CAACud,MAAhC,EAAwC;QAC3CvE,oBAAoB,CAAC7F,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACwd,MAAb,EAAqB;QACxBtE,kBAAkB,CAAC/F,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyd,MAAb,EAAqB;QACxBjE,mBAAmB,CAACrG,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC6M,MAAb,EAAqB;QACxBiN,oBAAoB,CAAC3G,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+R,MAAb,EAAqB;QACxBiI,oBAAoB,CAAC7G,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACka,MAAb,EAAqB;QACxBD,sBAAsB,CAAC9G,CAAD,EAAIxI,KAAJ,CAAtB;MACH,CAFM,MAEA;QACHkQ,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC6V,OAAb,EAAsB;QAClBrR,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFD,MAEO,IACH4B,EAAE,KAAKvM,CAAC,CAAC0d,OAAT,IACAnR,EAAE,KAAKvM,CAAC,CAACoY,OADT,IAEA7L,EAAE,KAAKvM,CAAC,CAAC2d,OAFT,IAGApR,EAAE,KAAKvM,CAAC,CAAC4d,OAHT,IAIArR,EAAE,KAAKvM,CAAC,CAAC6d,OALN,EAML;QACE3G,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CARM,MAQA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC8d,OAAb,EAAsB;QACzBnG,iBAAiB,CAACxE,CAAD,EAAIxI,KAAJ,CAAjB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+d,OAAb,EAAsB;QACzB/E,oBAAoB,CAAC7F,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC8M,OAAb,EAAsB;QACzBiN,qBAAqB,CAAC5G,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyC,OAAb,EAAsB;QACzBoY,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4V,QAAb,EAAuB;QACnBpR,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC6C,QAAb,EAAuB;QAC1BmU,sBAAsB,CAAC7D,CAAD,EAAIxI,KAAJ,CAAtB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACge,QAAb,EAAuB;QAC1B9G,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyM,QAAb,EAAuB;QAC1BmN,sBAAsB,CAACzG,CAAD,EAAIxI,KAAJ,CAAtB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;QAC1BpE,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACgN,QAAb,EAAuB;QAC1B,IAAImG,CAAC,CAACrL,OAAF,CAAUxH,gBAAd,EAAgC;UAC5ByZ,qBAAqB,CAAC5G,CAAD,EAAIxI,KAAJ,CAArB;QACH,CAFD,MAEO;UACHkQ,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;QACH;MACJ,CANM,MAMA,IAAI4B,EAAE,KAAKvM,CAAC,CAACie,QAAb,EAAuB;QAC1BhE,sBAAsB,CAAC9G,CAAD,EAAIxI,KAAJ,CAAtB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC0C,QAAb,EAAuB;QAC1BmY,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACkM,SAAb,EAAwB;QACpBoM,uBAAuB,CAACnF,CAAD,EAAIxI,KAAJ,CAAvB;MACH,CAFD,MAEO;QACHkQ,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ,KAAK,EAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACke,UAAT,IAAuB3R,EAAE,KAAKvM,CAAC,CAACme,UAApC,EAAgD;QAC5CjH,qBAAqB,CAAC/D,CAAD,EAAIxI,KAAJ,CAArB;MACH,CAFD,MAEO;QACHkQ,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;MACH;;MAED;;IAEJ;MACIkQ,qBAAqB,CAAC1H,CAAD,EAAIxI,KAAJ,CAArB;EAjNR;AAmNH;;AAED,SAASyT,gBAAT,CAA0BjL,CAA1B,EAA6B;EACzB,IAAIA,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BvT,CAAC,CAAC4C,IAA5B,CAAJ,EAAuC;IACnCuQ,CAAC,CAACzJ,aAAF,GAAkB3H,eAAlB;EACH;AACJ;;AAED,SAASsc,gBAAT,CAA0BlL,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,IAAIwI,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BvT,CAAC,CAAC4C,IAA5B,CAAJ,EAAuC;IACnCuQ,CAAC,CAACzJ,aAAF,GAAkB3H,eAAlB;;IACAoR,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH;AACJ;;AAED,SAAS2T,mBAAT,CAA6BnL,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAIiF,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BhH,EAA1B,CAAJ,EAAmC;IAC/B4G,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;IACA+B,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqCnF,EAArC;EACH;AACJ;;AAED,SAASgS,gBAAT,CAA0BpL,CAA1B,EAA6B;EACzB,MAAM0E,UAAU,GAAG1E,CAAC,CAACrJ,YAAF,CAAeoM,SAAf,GAA2B,CAA9C;EACA,MAAMrM,WAAW,GAAGsJ,CAAC,CAACtJ,WAAtB;;EAEA,IAAI,CAACgO,UAAL,EAAiB;IACb1E,CAAC,CAACtJ,WAAF,GAAgB,IAAhB;EACH;;EAED,IAAI,CAACA,WAAW,IAAIgO,UAAhB,KAA+B1E,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BvT,CAAC,CAACqM,IAA5B,CAAnC,EAAsE;IAClE8G,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;;IAEA,IAAIyG,UAAJ,EAAgB;MACZ1E,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAACqM,IAAvC;IACH,CAFD,MAEO;MACH8G,CAAC,CAACrJ,YAAF,CAAeuK,MAAf,CAAsBxK,WAAtB;IACH;EACJ;AACJ;;AAED,SAAS2U,aAAT,CAAuBrL,CAAvB,EAA0B;EACtB,IAAI,CAACA,CAAC,CAACrJ,YAAF,CAAeqN,gBAAf,CAAgCnX,CAAC,CAACyR,CAAlC,CAAL,EAA2C;IACvC0B,CAAC,CAAC9E,kBAAF,CAAqBrO,CAAC,CAACyR,CAAvB;EACH;;EAED0B,CAAC,CAAC5B,cAAF;AACH;;AAED,SAASkN,cAAT,CAAwBtL,CAAxB,EAA2B;EACvB,IAAIA,CAAC,CAACrJ,YAAF,CAAe4U,kBAAf,CAAkC1e,CAAC,CAACiY,EAApC,CAAJ,EAA6C;IACzC9E,CAAC,CAACrJ,YAAF,CAAe0H,mCAAf,CAAmDxR,CAAC,CAACiY,EAArD;IACA9E,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAACiY,EAAvC;EACH;AACJ;;AAED,SAAS0G,cAAT,CAAwBxL,CAAxB,EAA2BxI,KAA3B,EAAkC;EAC9B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAIiF,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BhH,EAA1B,CAAJ,EAAmC;IAC/B4G,CAAC,CAACrJ,YAAF,CAAe0H,mCAAf,CAAmDjF,EAAnD;IACA4G,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqCnF,EAArC;EACH;AACJ;;AAED,SAASqS,0BAAT,CAAoCzL,CAApC,EAAuC;EACnC,IAAIA,CAAC,CAACrJ,YAAF,CAAe+U,wBAAf,EAAJ,EAA+C;IAC3C1L,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;IACA+B,CAAC,CAACrJ,YAAF,CAAegV,4BAAf;EACH;AACJ;;AAED,SAASC,kBAAT,CAA4B5L,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAIiF,CAAC,CAACrJ,YAAF,CAAeyJ,UAAf,CAA0BhH,EAA1B,CAAJ,EAAmC;IAC/B4G,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;IACA+B,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqCnF,EAArC;IACA4G,CAAC,CAACpJ,wBAAF,CAA2BuH,iBAA3B;EACH;AACJ;;AAED,SAAS0N,cAAT,CAAwB7L,CAAxB,EAA2B;EACvBA,CAAC,CAACxC,oCAAF;;EACAwC,CAAC,CAAC9E,kBAAF,CAAqBrO,CAAC,CAACyV,EAAvB;;EACAtC,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACAc,CAAC,CAAC9I,UAAF,GAAe,KAAf;AACH;;AAED,SAASmJ,mBAAT,CAA6BL,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,KAAK,IAAIgD,CAAC,GAAGiC,CAAC,CAACrJ,YAAF,CAAeqC,QAA5B,EAAsC+E,CAAC,GAAG,CAA1C,EAA6CA,CAAC,EAA9C,EAAkD;IAC9C,MAAMxD,OAAO,GAAGyF,CAAC,CAACrJ,YAAF,CAAe8H,KAAf,CAAqBV,CAArB,CAAhB;;IAEA,IAAIiC,CAAC,CAAC1S,WAAF,CAAcqI,UAAd,CAAyB4E,OAAzB,MAAsCnB,EAA1C,EAA8C;MAC1C4G,CAAC,CAACrJ,YAAF,CAAe0H,mCAAf,CAAmDjF,EAAnD;MACA4G,CAAC,CAACrJ,YAAF,CAAe6J,qBAAf,CAAqCjG,OAArC;MACA;IACH;;IAED,IAAIyF,CAAC,CAACL,iBAAF,CAAoBpF,OAApB,CAAJ,EAAkC;MAC9B;IACH;EACJ;AACJ,C,CAED;AACA;;;AACA,SAASvI,YAAT,CAAsBgO,CAAtB,EAAyBxI,KAAzB,EAAgC;EAC5B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,QAAQ3B,EAAE,CAACvB,MAAX;IACI,KAAK,CAAL;MACI,IAAIuB,EAAE,KAAKvM,CAAC,CAAC2Y,CAAT,IAAcpM,EAAE,KAAKvM,CAAC,CAACgb,CAAvB,IAA4BzO,EAAE,KAAKvM,CAAC,CAAC8a,CAArC,IAA0CvO,EAAE,KAAKvM,CAAC,CAAC+a,CAAnD,IAAwDxO,EAAE,KAAKvM,CAAC,CAACib,CAArE,EAAwE;QACpElG,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACyR,CAAb,EAAgB;QACnB+M,aAAa,CAACrL,CAAD,EAAIxI,KAAJ,CAAb;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACkb,EAAT,IAAe3O,EAAE,KAAKvM,CAAC,CAACob,EAAxB,IAA8B7O,EAAE,KAAKvM,CAAC,CAACmb,EAA3C,EAA+C;QAC3CmD,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACiY,EAAb,EAAiB;QACpBwG,cAAc,CAACtL,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACkY,EAAT,IAAe3L,EAAE,KAAKvM,CAAC,CAACmY,EAA5B,EAAgC;QACnCwG,cAAc,CAACxL,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACqX,EAAT,IAAe9K,EAAE,KAAKvM,CAAC,CAACsX,EAAxB,IAA8B/K,EAAE,KAAKvM,CAAC,CAACuX,EAAvC,IAA6ChL,EAAE,KAAKvM,CAAC,CAACwX,EAAtD,IAA4DjL,EAAE,KAAKvM,CAAC,CAACyX,EAArE,IAA2ElL,EAAE,KAAKvM,CAAC,CAAC0X,EAAxF,EAA4F;QAC/FkH,0BAA0B,CAACzL,CAAD,EAAIxI,KAAJ,CAA1B;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyV,EAAb,EAAiB;QACpBuJ,cAAc,CAAC7L,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACqb,EAAT,IAAe9O,EAAE,KAAKvM,CAAC,CAACsb,EAA5B,EAAgC;QACnCvG,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC8b,GAAb,EAAkB;QACd/G,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2b,GAAT,IAAgBpP,EAAE,KAAKvM,CAAC,CAACqY,GAAzB,IAAgC9L,EAAE,KAAKvM,CAAC,CAAC4b,GAAzC,IAAgDrP,EAAE,KAAKvM,CAAC,CAAC6b,GAA7D,EAAkE;QACrEyC,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAb,EAAmB;QACfwb,gBAAgB,CAACjL,CAAD,EAAIxI,KAAJ,CAAhB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;QACtBse,gBAAgB,CAAClL,CAAD,EAAIxI,KAAJ,CAAhB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACqM,IAAb,EAAmB;QACtBkS,gBAAgB,CAACpL,CAAD,EAAIxI,KAAJ,CAAhB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACkc,IAAT,IAAiB3P,EAAE,KAAKvM,CAAC,CAACmc,IAA1B,IAAkC5P,EAAE,KAAKvM,CAAC,CAAC+Y,IAA/C,EAAqD;QACxDhE,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACgc,IAAT,IAAiBzP,EAAE,KAAKvM,CAAC,CAACic,IAA9B,EAAoC;QACvCqC,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACsc,KAAb,EAAoB;QAChBgC,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACuc,KAAb,EAAoB;QACvBxH,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IACI4B,EAAE,KAAKvM,CAAC,CAAC8c,MAAT,IACAvQ,EAAE,KAAKvM,CAAC,CAAC+c,MADT,IAEAxQ,EAAE,KAAKvM,CAAC,CAACgd,MAFT,IAGAzQ,EAAE,KAAKvM,CAAC,CAACid,MAHT,IAIA1Q,EAAE,KAAKvM,CAAC,CAACkd,MAJT,IAKA3Q,EAAE,KAAKvM,CAAC,CAACmd,MANb,EAOE;QACEmB,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CATD,MASO,IAAI4B,EAAE,KAAKvM,CAAC,CAACsd,MAAT,IAAmB/Q,EAAE,KAAKvM,CAAC,CAACud,MAAhC,EAAwC;QAC3CwB,kBAAkB,CAAC5L,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACod,MAAT,IAAmB7Q,EAAE,KAAKvM,CAAC,CAACqd,MAAhC,EAAwC;QAC3CtI,kBAAkB,CAAC5B,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IACI4B,EAAE,KAAKvM,CAAC,CAACoY,OAAT,IACA7L,EAAE,KAAKvM,CAAC,CAAC2d,OADT,IAEApR,EAAE,KAAKvM,CAAC,CAAC0d,OAFT,IAGAnR,EAAE,KAAKvM,CAAC,CAAC4d,OAHT,IAIArR,EAAE,KAAKvM,CAAC,CAAC6d,OAJT,IAKAtR,EAAE,KAAKvM,CAAC,CAAC8d,OANb,EAOE;QACEQ,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CATD,MASO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+d,OAAb,EAAsB;QACzBgB,kBAAkB,CAAC5L,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACge,QAAb,EAAuB;QACnBM,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;QAC1BnE,YAAY,CAAC0O,CAAD,EAAIxI,KAAJ,CAAZ;MACH,CAFM,MAEA;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ,KAAK,EAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACke,UAAT,IAAuB3R,EAAE,KAAKvM,CAAC,CAACme,UAApC,EAAgD;QAC5CG,mBAAmB,CAACnL,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFD,MAEO;QACH6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;MACH;;MAED;;IAEJ;MACI6I,mBAAmB,CAACL,CAAD,EAAIxI,KAAJ,CAAnB;EAjIR;AAmIH;;AAED,SAASvF,SAAT,CAAmB+N,CAAnB,EAAsBxI,KAAtB,EAA6B;EACzB,IAAIwI,CAAC,CAAClJ,yBAAF,GAA8B,CAAC,CAAnC,EAAsC;IAClCnD,aAAa,CAACqM,CAAD,EAAIxI,KAAJ,CAAb;EACH,CAFD,MAEO;IACHwI,CAAC,CAAC1J,OAAF,GAAY,IAAZ;EACH;AACJ,C,CAED;AACA;;;AACA,SAASpE,YAAT,CAAsB8N,CAAtB,EAAyBxI,KAAzB,EAAgC;EAC5B,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAACkN,MAAxB,EAAgC;IAC5BiG,CAAC,CAACpL,aAAF,GAAkBoL,CAAC,CAACrJ,YAAF,CAAewB,OAAjC;EACH;;EAED6H,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACAc,CAAC,CAACzJ,aAAF,GAAkByJ,CAAC,CAACxJ,qBAApB;AACH;;AAED,SAASrE,SAAT,CAAmB6N,CAAnB,EAAsBxI,KAAtB,EAA6B;EACzBwI,CAAC,CAAC3I,IAAF,CAAO3K,GAAG,CAACof,kCAAX;;EACA9L,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACAc,CAAC,CAACzJ,aAAF,GAAkByJ,CAAC,CAACxJ,qBAApB;;EACAwJ,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAASpF,gBAAT,CAA0B4N,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,MAAMuU,KAAK,GAAG/L,CAAC,CAACrJ,YAAF,CAAesM,cAA7B;;EAEA,IAAI8I,KAAK,KAAKlf,CAAC,CAAC2C,KAAZ,IAAqBuc,KAAK,KAAKlf,CAAC,CAACsC,KAAjC,IAA0C4c,KAAK,KAAKlf,CAAC,CAACwC,KAAtD,IAA+D0c,KAAK,KAAKlf,CAAC,CAACuC,KAA3E,IAAoF2c,KAAK,KAAKlf,CAAC,CAACqC,EAApG,EAAwG;IACpG8Q,CAAC,CAAChJ,sBAAF,GAA2B,EAA3B;IACAgJ,CAAC,CAAC/I,qCAAF,GAA0C,KAA1C;IACA+I,CAAC,CAACxJ,qBAAF,GAA0BwJ,CAAC,CAACzJ,aAA5B;IACAyJ,CAAC,CAACzJ,aAAF,GAAkBpI,kBAAlB;;IACA6R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH,CAND,MAMO;IACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;EACH;AACJ;;AAED,SAASyU,sBAAT,CAAgCjM,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtCwI,CAAC,CAACrJ,YAAF,CAAeuV,uBAAf;EACAlM,CAAC,CAACpJ,wBAAF,CAA2BiM,YAA3B;;EACA7C,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAACzJ,aAAF,GAAkBnI,eAAlB;AACH;;AAED,SAAS+d,uBAAT,CAAiCnM,CAAjC,EAAoCxI,KAApC,EAA2C;EACvCwI,CAAC,CAACrJ,YAAF,CAAeuV,uBAAf;;EACAlM,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAACzJ,aAAF,GAAkBlI,oBAAlB;AACH;;AAED,SAAS+d,kBAAT,CAA4BpM,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClCwI,CAAC,CAACrJ,YAAF,CAAeuV,uBAAf;;EACAlM,CAAC,CAAC9E,kBAAF,CAAqBrO,CAAC,CAAC0C,QAAvB;;EACAyQ,CAAC,CAACzJ,aAAF,GAAkBlI,oBAAlB;;EACA2R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH;;AAED,SAAS6U,oBAAT,CAA8BrM,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpCwI,CAAC,CAACrJ,YAAF,CAAeuV,uBAAf;;EACAlM,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;EACAoT,CAAC,CAACzJ,aAAF,GAAkBjI,kBAAlB;AACH;;AAED,SAASge,iBAAT,CAA2BtM,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjCwI,CAAC,CAACrJ,YAAF,CAAeuV,uBAAf;;EACAlM,CAAC,CAAC9E,kBAAF,CAAqBrO,CAAC,CAACsC,KAAvB;;EACA6Q,CAAC,CAACzJ,aAAF,GAAkBjI,kBAAlB;;EACA0R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH;;AAED,SAAS+U,oBAAT,CAA8BvM,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpC,IAAIwI,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAAC2C,KAAjC,CAAJ,EAA6C;IACzCwQ,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC2C,KAAvC;;IACAwQ,CAAC,CAACjK,mBAAF;;IACAiK,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH;AACJ;;AAED,SAASiV,oBAAT,CAA8BzM,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpC,MAAMyO,SAAS,GAAGla,SAAS,CAACma,YAAV,CAAuB1O,KAAvB,EAA8BvK,KAAK,CAACkZ,IAApC,CAAlB;;EAEA,IAAIF,SAAS,IAAIA,SAAS,CAACG,WAAV,OAA4B7Y,iBAA7C,EAAgE;IAC5DyS,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;EACH,CAFD,MAEO;IACHof,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;EACH;;EAEDA,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;AACH;;AAED,SAASuP,mBAAT,CAA6B1M,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,IAAI,CAACwI,CAAC,CAACtJ,WAAH,IAAkBsJ,CAAC,CAACrJ,YAAF,CAAeoM,SAAf,KAA6B,CAAnD,EAAsD;IAClD/C,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAACtJ,WAAF,GAAgBsJ,CAAC,CAACrJ,YAAF,CAAewB,OAA/B;IACA6H,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;EACH;AACJ;;AAED,SAAS7M,eAAT,CAAyB2N,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,QAAQ3B,EAAE,CAACvB,MAAX;IACI,KAAK,CAAL;MACI,IAAIuB,EAAE,KAAKvM,CAAC,CAACgD,EAAT,IAAeuJ,EAAE,KAAKvM,CAAC,CAACiD,EAAxB,IAA8BsJ,EAAE,KAAKvM,CAAC,CAACqC,EAA3C,EAA+C;QAC3Cod,iBAAiB,CAACtM,CAAD,EAAIxI,KAAJ,CAAjB;MACH,CAFD,MAEO;QACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+C,GAAb,EAAkB;QACdwc,kBAAkB,CAACpM,CAAD,EAAIxI,KAAJ,CAAlB;MACH,CAFD,MAEO;QACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACqM,IAAb,EAAmB;QACfwT,mBAAmB,CAAC1M,CAAD,EAAIxI,KAAJ,CAAnB;MACH,CAFD,MAEO;QACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;QAChB+c,oBAAoB,CAACvM,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC2M,KAAb,EAAoB;QACvBnI,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACsC,KAAT,IAAkBiK,EAAE,KAAKvM,CAAC,CAACwC,KAA3B,IAAoC+J,EAAE,KAAKvM,CAAC,CAACuC,KAAjD,EAAwD;QAC3Did,oBAAoB,CAACrM,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAACyc,KAAb,EAAoB;QACvBmD,oBAAoB,CAACzM,CAAD,EAAIxI,KAAJ,CAApB;MACH,CAFM,MAEA;QACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACkN,MAAb,EAAqB;QACjB1I,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFD,MAEO;QACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAACyC,OAAb,EAAsB;QAClB2c,sBAAsB,CAACjM,CAAD,EAAIxI,KAAJ,CAAtB;MACH,CAFD,MAEO;QACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;MACH;;MAED;;IAEJ,KAAK,CAAL;MACI,IAAI4B,EAAE,KAAKvM,CAAC,CAAC0C,QAAb,EAAuB;QACnB4c,uBAAuB,CAACnM,CAAD,EAAIxI,KAAJ,CAAvB;MACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;QAC1BpE,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;MACH,CAFM,MAEA;QACHwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;MACH;;MAED;;IAEJ;MACIwU,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;EAzER;AA2EH;;AAED,SAASlF,aAAT,CAAuB0N,CAAvB,EAA0BxI,KAA1B,EAAiC;EAC7B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;IAChB,IAAIwQ,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAAC2C,KAAjC,CAAJ,EAA6C;MACzCwQ,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC2C,KAAvC;;MACAwQ,CAAC,CAACjK,mBAAF;IACH;EACJ,CALD,MAKO,IAAIqD,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;IAC1BnE,YAAY,CAAC0O,CAAD,EAAIxI,KAAJ,CAAZ;EACH,CAFM,MAEA,IACH4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAT,IACA2J,EAAE,KAAKvM,CAAC,CAACyC,OADT,IAEA8J,EAAE,KAAKvM,CAAC,CAAC+C,GAFT,IAGAwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAHT,IAIA6J,EAAE,KAAKvM,CAAC,CAACD,IAJT,IAKAwM,EAAE,KAAKvM,CAAC,CAACsC,KALT,IAMAiK,EAAE,KAAKvM,CAAC,CAACgD,EANT,IAOAuJ,EAAE,KAAKvM,CAAC,CAACwC,KAPT,IAQA+J,EAAE,KAAKvM,CAAC,CAACiD,EART,IASAsJ,EAAE,KAAKvM,CAAC,CAACuC,KATT,IAUAgK,EAAE,KAAKvM,CAAC,CAACqC,EAXN,EAYL;IACE8c,YAAY,CAAChM,CAAD,EAAIxI,KAAJ,CAAZ;EACH;AACJ;;AAED,SAASwU,YAAT,CAAsBhM,CAAtB,EAAyBxI,KAAzB,EAAgC;EAC5B,MAAMmV,yBAAyB,GAAG3M,CAAC,CAAC5I,sBAApC;EAEA4I,CAAC,CAAC5I,sBAAF,GAA2B,IAA3B;;EACA4I,CAAC,CAACpD,uBAAF,CAA0BpF,KAA1B;;EACAwI,CAAC,CAAC5I,sBAAF,GAA2BuV,yBAA3B;AACH,C,CAED;AACA;;;AACA,SAASna,8BAAT,CAAwCwN,CAAxC,EAA2CxI,KAA3C,EAAkD;EAC9CwI,CAAC,CAAChJ,sBAAF,CAAyBiE,IAAzB,CAA8BzD,KAA9B;AACH;;AAED,SAASjF,oBAAT,CAA8ByN,CAA9B,EAAiCxI,KAAjC,EAAwC;EACpCwI,CAAC,CAAChJ,sBAAF,CAAyBiE,IAAzB,CAA8BzD,KAA9B;EACAwI,CAAC,CAAC/I,qCAAF,GAA0C,IAA1C;AACH;;AAED,SAASxE,gBAAT,CAA0BuN,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,IAAIuG,CAAC,GAAG,CAAR;;EAEA,IAAIiC,CAAC,CAAC/I,qCAAN,EAA6C;IACzC,OAAO8G,CAAC,GAAGiC,CAAC,CAAChJ,sBAAF,CAAyBa,MAApC,EAA4CkG,CAAC,EAA7C,EAAiD;MAC7CiO,YAAY,CAAChM,CAAD,EAAIA,CAAC,CAAChJ,sBAAF,CAAyB+G,CAAzB,CAAJ,CAAZ;IACH;EACJ,CAJD,MAIO;IACH,OAAOA,CAAC,GAAGiC,CAAC,CAAChJ,sBAAF,CAAyBa,MAApC,EAA4CkG,CAAC,EAA7C,EAAiD;MAC7CiC,CAAC,CAACrE,iBAAF,CAAoBqE,CAAC,CAAChJ,sBAAF,CAAyB+G,CAAzB,CAApB;IACH;EACJ;;EAEDiC,CAAC,CAACzJ,aAAF,GAAkByJ,CAAC,CAACxJ,qBAApB;;EACAwJ,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAAS9E,iBAAT,CAA2BsN,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IACI3B,EAAE,KAAKvM,CAAC,CAACyC,OAAT,IACA8J,EAAE,KAAKvM,CAAC,CAAC+C,GADT,IAEAwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAFT,IAGA6J,EAAE,KAAKvM,CAAC,CAACsC,KAHT,IAIAiK,EAAE,KAAKvM,CAAC,CAACgD,EAJT,IAKAuJ,EAAE,KAAKvM,CAAC,CAACwC,KALT,IAMA+J,EAAE,KAAKvM,CAAC,CAACiD,EANT,IAOAsJ,EAAE,KAAKvM,CAAC,CAACuC,KAPT,IAQAgK,EAAE,KAAKvM,CAAC,CAACqC,EATb,EAUE;IACE,IAAI8Q,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACyC,OAAjC,CAAJ,EAA+C;MAC3C0Q,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;MACA+B,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAACyC,OAAvC;MACA0Q,CAAC,CAACpJ,wBAAF,CAA2BuH,iBAA3B;MACA6B,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;;MACA8R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAlBD,MAkBO;IACHzF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAAS7E,eAAT,CAAyBqN,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACyC,OAAT,IAAoB8J,EAAE,KAAKvM,CAAC,CAAC2C,KAAjC,EAAwC;IACpC,IAAIwQ,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACyC,OAAjC,CAAJ,EAA+C;MAC3C0Q,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;MACA+B,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAACyC,OAAvC;MACA0Q,CAAC,CAACpJ,wBAAF,CAA2BuH,iBAA3B;MACA6B,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;;MAEA,IAAIkL,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;QAChBwQ,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;MACH;IACJ;EACJ,CAXD,MAWO,IACH4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAT,IACA2J,EAAE,KAAKvM,CAAC,CAAC+C,GADT,IAEAwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAFT,IAGA6J,EAAE,KAAKvM,CAAC,CAACD,IAHT,IAIAwM,EAAE,KAAKvM,CAAC,CAACsC,KAJT,IAKAiK,EAAE,KAAKvM,CAAC,CAACgD,EALT,IAMAuJ,EAAE,KAAKvM,CAAC,CAACwC,KANT,IAOA+J,EAAE,KAAKvM,CAAC,CAACiD,EAPT,IAQAsJ,EAAE,KAAKvM,CAAC,CAACuC,KART,IASAgK,EAAE,KAAKvM,CAAC,CAACqC,EAVN,EAWL;IACE8C,YAAY,CAACgO,CAAD,EAAIxI,KAAJ,CAAZ;EACH;AACJ,C,CAED;AACA;;;AACA,SAAS3E,qBAAT,CAA+BmN,CAA/B,EAAkCxI,KAAlC,EAAyC;EACrC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+C,GAAb,EAAkB;IACrBoQ,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACA4K,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;EACH,CAHM,MAGA,IAAI/D,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;IAC1BpE,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFM,MAEA;IACH5E,kBAAkB,CAACoN,CAAD,EAAIxI,KAAJ,CAAlB;EACH;AACJ;;AAED,SAAS1E,mBAAT,CAA6BkN,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAAC0C,QAAb,EAAuB;IACnB,IAAIyQ,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAAC0C,QAAxC,EAAkD;MAC9CyQ,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;IACH;EACJ,CALD,MAKO,IAAIkL,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;IAC1BnE,YAAY,CAAC0O,CAAD,EAAIxI,KAAJ,CAAZ;EACH,CAFM,MAEA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+C,GAAb,EAAkB;IACrBgD,kBAAkB,CAACoN,CAAD,EAAIxI,KAAJ,CAAlB;EACH;AACJ;;AAED,SAAS5E,kBAAT,CAA4BoN,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,IAAIwI,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAAC0C,QAAxC,EAAkD;IAC9CyQ,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACAc,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;;IACA8R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH;AACJ,C,CAED;AACA;;;AACA,SAASzE,mBAAT,CAA6BiN,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACqC,EAAb,EAAiB;IACb8Q,CAAC,CAACrJ,YAAF,CAAeiW,2BAAf;;IACA5M,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAACzJ,aAAF,GAAkBhI,WAAlB;EACH,CAJD,MAIO,IAAI6K,EAAE,KAAKvM,CAAC,CAACiD,EAAT,IAAesJ,EAAE,KAAKvM,CAAC,CAACgD,EAA5B,EAAgC;IACnCmQ,CAAC,CAACrJ,YAAF,CAAeiW,2BAAf;;IACA5M,CAAC,CAAC9E,kBAAF,CAAqBrO,CAAC,CAACqC,EAAvB;;IACA8Q,CAAC,CAACzJ,aAAF,GAAkBhI,WAAlB;;IACAyR,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH,CALM,MAKA,IACH4B,EAAE,KAAKvM,CAAC,CAACyC,OAAT,IACA8J,EAAE,KAAKvM,CAAC,CAAC+C,GADT,IAEAwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAFT,IAGA6J,EAAE,KAAKvM,CAAC,CAACsC,KAHT,IAIAiK,EAAE,KAAKvM,CAAC,CAACwC,KAJT,IAKA+J,EAAE,KAAKvM,CAAC,CAACuC,KANN,EAOL;IACE,IAAI4Q,CAAC,CAACrJ,YAAF,CAAekW,+BAAf,EAAJ,EAAsD;MAClD7M,CAAC,CAACrJ,YAAF,CAAeiW,2BAAf;MACA5M,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;;MACA8R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAdM,MAcA;IACHnF,eAAe,CAAC2N,CAAD,EAAIxI,KAAJ,CAAf;EACH;AACJ;;AAED,SAASxE,iBAAT,CAA2BgN,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACsC,KAAT,IAAkBiK,EAAE,KAAKvM,CAAC,CAACwC,KAA3B,IAAoC+J,EAAE,KAAKvM,CAAC,CAACuC,KAAjD,EAAwD;IACpD,IAAI4Q,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+BpT,EAA/B,CAAJ,EAAwC;MACpC4G,CAAC,CAACrJ,YAAF,CAAeiW,2BAAf;MACA5M,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;IACH;EACJ,CAND,MAMO,IAAIkL,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;IACvB,IAAIwQ,CAAC,CAACrJ,YAAF,CAAekW,+BAAf,EAAJ,EAAsD;MAClD7M,CAAC,CAACrJ,YAAF,CAAeiW,2BAAf;MACA5M,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBrI,aAAlB;;MACA8R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAPM,MAOA,IACF4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAT,IAAiB2J,EAAE,KAAKvM,CAAC,CAACyC,OAA1B,IAAqC8J,EAAE,KAAKvM,CAAC,CAAC+C,GAA9C,IAAqDwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAA/D,IACC6J,EAAE,KAAKvM,CAAC,CAACD,IAAT,IAAiBwM,EAAE,KAAKvM,CAAC,CAACgD,EAA1B,IAAgCuJ,EAAE,KAAKvM,CAAC,CAACiD,EAAzC,IAA+CsJ,EAAE,KAAKvM,CAAC,CAACqC,EAFtD,EAGL;IACEoD,aAAa,CAAC0N,CAAD,EAAIxI,KAAJ,CAAb;EACH;AACJ,C,CAED;AACA;;;AACA,SAASvE,aAAT,CAAuB+M,CAAvB,EAA0BxI,KAA1B,EAAiC;EAC7B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACiD,EAAT,IAAesJ,EAAE,KAAKvM,CAAC,CAACgD,EAA5B,EAAgC;IAC5BmQ,CAAC,CAACrJ,YAAF,CAAemW,0BAAf;;IACA9M,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACAoT,CAAC,CAACzJ,aAAF,GAAkB/H,YAAlB;IACAwR,CAAC,CAACpJ,wBAAF,CAA2BiM,YAA3B;EACH,CALD,MAKO,IACHzJ,EAAE,KAAKvM,CAAC,CAACyC,OAAT,IACA8J,EAAE,KAAKvM,CAAC,CAAC+C,GADT,IAEAwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAFT,IAGA6J,EAAE,KAAKvM,CAAC,CAACsC,KAHT,IAIAiK,EAAE,KAAKvM,CAAC,CAACwC,KAJT,IAKA+J,EAAE,KAAKvM,CAAC,CAACuC,KALT,IAMAgK,EAAE,KAAKvM,CAAC,CAACqC,EAPN,EAQL;IACE,IAAI8Q,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACqC,EAAjC,CAAJ,EAA0C;MACtC8Q,CAAC,CAACrJ,YAAF,CAAemW,0BAAf;MACA9M,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBjI,kBAAlB;;MACA0R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAfM,MAeA;IACHnF,eAAe,CAAC2N,CAAD,EAAIxI,KAAJ,CAAf;EACH;AACJ;;AAED,SAAStE,WAAT,CAAqB8M,CAArB,EAAwBxI,KAAxB,EAA+B;EAC3B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACqC,EAAb,EAAiB;IACb,IAAI8Q,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACqC,EAAjC,CAAJ,EAA0C;MACtC8Q,CAAC,CAACrJ,YAAF,CAAemW,0BAAf;MACA9M,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBjI,kBAAlB;IACH;EACJ,CAND,MAMO,IAAI8K,EAAE,KAAKvM,CAAC,CAAC2C,KAAb,EAAoB;IACvB,IAAIwQ,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACqC,EAAjC,CAAJ,EAA0C;MACtC8Q,CAAC,CAACrJ,YAAF,CAAemW,0BAAf;MACA9M,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBjI,kBAAlB;;MACA0R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAPM,MAOA,IAAI4B,EAAE,KAAKvM,CAAC,CAACsC,KAAT,IAAkBiK,EAAE,KAAKvM,CAAC,CAACwC,KAA3B,IAAoC+J,EAAE,KAAKvM,CAAC,CAACuC,KAAjD,EAAwD;IAC3D,IAAI4Q,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+BpT,EAA/B,KAAsC4G,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACqC,EAAjC,CAA1C,EAAgF;MAC5E8Q,CAAC,CAACrJ,YAAF,CAAemW,0BAAf;MACA9M,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;MACAc,CAAC,CAACzJ,aAAF,GAAkBjI,kBAAlB;;MACA0R,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAPM,MAOA,IACF4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAT,IAAiB2J,EAAE,KAAKvM,CAAC,CAACyC,OAA1B,IAAqC8J,EAAE,KAAKvM,CAAC,CAAC+C,GAA9C,IAAqDwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAA/D,IACC6J,EAAE,KAAKvM,CAAC,CAACD,IAAT,IAAiBwM,EAAE,KAAKvM,CAAC,CAACgD,EAA1B,IAAgCuJ,EAAE,KAAKvM,CAAC,CAACiD,EAFvC,EAGL;IACEwC,aAAa,CAAC0N,CAAD,EAAIxI,KAAJ,CAAb;EACH;AACJ,C,CAED;AACA;;;AACA,SAASrE,cAAT,CAAwB6M,CAAxB,EAA2BxI,KAA3B,EAAkC;EAC9B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IACI3B,EAAE,KAAKvM,CAAC,CAACyC,OAAT,IACA8J,EAAE,KAAKvM,CAAC,CAAC+C,GADT,IAEAwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAFT,IAGA6J,EAAE,KAAKvM,CAAC,CAACsC,KAHT,IAIAiK,EAAE,KAAKvM,CAAC,CAACgD,EAJT,IAKAuJ,EAAE,KAAKvM,CAAC,CAACwC,KALT,IAMA+J,EAAE,KAAKvM,CAAC,CAACiD,EANT,IAOAsJ,EAAE,KAAKvM,CAAC,CAACuC,KAPT,IAQAgK,EAAE,KAAKvM,CAAC,CAACqC,EATb,EAUE;IACE,IAAI8Q,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACgD,EAAjC,KAAwCmQ,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+B3f,CAAC,CAACiD,EAAjC,CAA5C,EAAkF;MAC9EkQ,CAAC,CAAChC,eAAF;;MACAgC,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAfD,MAeO;IACHzF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAASpE,YAAT,CAAsB4M,CAAtB,EAAyBxI,KAAzB,EAAgC;EAC5B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACgD,EAAT,IAAeuJ,EAAE,KAAKvM,CAAC,CAACiD,EAA5B,EAAgC;IAC5B,IAAIkQ,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+BpT,EAA/B,CAAJ,EAAwC;MACpC4G,CAAC,CAACrJ,YAAF,CAAesH,sBAAf;MACA+B,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqCnF,EAArC;MACA4G,CAAC,CAACpJ,wBAAF,CAA2BuH,iBAA3B;MACA6B,CAAC,CAACzJ,aAAF,GAAkBhI,WAAlB;IACH;EACJ,CAPD,MAOO,IAAI6K,EAAE,KAAKvM,CAAC,CAAC2C,KAAT,IAAkB4J,EAAE,KAAKvM,CAAC,CAACsC,KAA3B,IAAoCiK,EAAE,KAAKvM,CAAC,CAACwC,KAA7C,IAAsD+J,EAAE,KAAKvM,CAAC,CAACuC,KAA/D,IAAwEgK,EAAE,KAAKvM,CAAC,CAACqC,EAArF,EAAyF;IAC5F,IAAI8Q,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+BpT,EAA/B,CAAJ,EAAwC;MACpC4G,CAAC,CAAChC,eAAF;;MACAgC,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CALM,MAKA,IAAI4B,EAAE,KAAKvM,CAAC,CAAC4C,IAAT,IAAiB2J,EAAE,KAAKvM,CAAC,CAACyC,OAA1B,IAAqC8J,EAAE,KAAKvM,CAAC,CAAC+C,GAA9C,IAAqDwJ,EAAE,KAAKvM,CAAC,CAAC0C,QAA9D,IAA0E6J,EAAE,KAAKvM,CAAC,CAACD,IAAvF,EAA6F;IAChGoF,YAAY,CAACgO,CAAD,EAAIxI,KAAJ,CAAZ;EACH;AACJ,C,CAED;AACA;;;AACA,SAASnE,gBAAT,CAA0B2M,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAACka,MAAb,EAAqB;IACxB,IAAI/G,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAACka,MAAxC,EAAgD;MAC5C/G,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACH;;IAEDc,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;EACH,CANM,MAMA,IAAIwM,EAAE,KAAKvM,CAAC,CAACie,QAAb,EAAuB;IAC1B,IAAI9K,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAACka,MAAxC,EAAgD;MAC5C/G,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACH;;IAED,IAAIc,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAACie,QAAxC,EAAkD;MAC9C9K,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACH;;IAEDc,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;EACH,CAVM,MAUA,IAAIwM,EAAE,KAAKvM,CAAC,CAACyc,KAAT,IAAkBlQ,EAAE,KAAKvM,CAAC,CAACwd,MAA3B,IAAqCjR,EAAE,KAAKvM,CAAC,CAACyM,QAA9C,IAA0DF,EAAE,KAAKvM,CAAC,CAAC+R,MAAvE,EAA+E;IAClF,IAAIoB,CAAC,CAACrJ,YAAF,CAAeoW,gBAAf,CAAgClgB,CAAC,CAAC+R,MAAlC,CAAJ,EAA+C;MAC3CoB,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC+R,MAAvC;;MACAoB,CAAC,CAACjK,mBAAF;;MAEA,IAAIqD,EAAE,KAAKvM,CAAC,CAAC+R,MAAb,EAAqB;QACjBoB,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;MACH;IACJ;EACJ,CATM,MASA,IAAI4B,EAAE,KAAKvM,CAAC,CAACkN,MAAT,IAAmBX,EAAE,KAAKvM,CAAC,CAAC4I,QAAhC,EAA0C;IAC7CpE,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAASlE,cAAT,CAAwB0M,CAAxB,EAA2BxI,KAA3B,EAAkC;EAC9B,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACie,QAAb,EAAuB;IACnB,MAAMkC,eAAe,GAAGhN,CAAC,CAACrJ,YAAF,CAAe8H,KAAf,CAAqBuB,CAAC,CAACrJ,YAAF,CAAeqC,QAAf,GAA0B,CAA/C,CAAxB;IACA,MAAMiU,iBAAiB,GAAGD,eAAe,IAAIhN,CAAC,CAAC1S,WAAF,CAAcqI,UAAd,CAAyBqX,eAAzB,CAA7C;;IAEA,IAAIhN,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAACka,MAApC,IAA8CkG,iBAAiB,KAAKpgB,CAAC,CAACie,QAA1E,EAAoF;MAChF9K,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACH;;IAED,IAAIc,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAACie,QAAxC,EAAkD;MAC9C9K,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACH;EACJ,CAXD,MAWO,IAAI9F,EAAE,KAAKvM,CAAC,CAACka,MAAb,EAAqB;IACxB,IAAI/G,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAACka,MAAxC,EAAgD;MAC5C/G,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACH;EACJ,CAJM,MAIA,IAAI9F,EAAE,KAAKvM,CAAC,CAAC+R,MAAT,IAAmBoB,CAAC,CAACrJ,YAAF,CAAeoW,gBAAf,CAAgClgB,CAAC,CAAC+R,MAAlC,CAAvB,EAAkE;IACrEoB,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC+R,MAAvC;;IACAoB,CAAC,CAACjK,mBAAF;EACH,CAHM,MAGA,IAAIqD,EAAE,KAAKvM,CAAC,CAAC4I,QAAb,EAAuB;IAC1BnE,YAAY,CAAC0O,CAAD,EAAIxI,KAAJ,CAAZ;EACH;AACJ,C,CAED;AACA;;;AACA,SAASjE,uBAAT,CAAiCyM,CAAjC,EAAoCxI,KAApC,EAA2C;EACvC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IACI3B,EAAE,KAAKvM,CAAC,CAACyC,OAAT,IACA8J,EAAE,KAAKvM,CAAC,CAAC2C,KADT,IAEA4J,EAAE,KAAKvM,CAAC,CAACsC,KAFT,IAGAiK,EAAE,KAAKvM,CAAC,CAACwC,KAHT,IAIA+J,EAAE,KAAKvM,CAAC,CAACuC,KAJT,IAKAgK,EAAE,KAAKvM,CAAC,CAACqC,EALT,IAMAkK,EAAE,KAAKvM,CAAC,CAACgD,EANT,IAOAuJ,EAAE,KAAKvM,CAAC,CAACiD,EARb,EASE;IACEkQ,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC+R,MAAvC;;IACAoB,CAAC,CAACjK,mBAAF;;IACAiK,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH,CAbD,MAaO;IACHnE,gBAAgB,CAAC2M,CAAD,EAAIxI,KAAJ,CAAhB;EACH;AACJ;;AAED,SAAShE,qBAAT,CAA+BwM,CAA/B,EAAkCxI,KAAlC,EAAyC;EACrC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IACI3B,EAAE,KAAKvM,CAAC,CAACyC,OAAT,IACA8J,EAAE,KAAKvM,CAAC,CAAC2C,KADT,IAEA4J,EAAE,KAAKvM,CAAC,CAACsC,KAFT,IAGAiK,EAAE,KAAKvM,CAAC,CAACwC,KAHT,IAIA+J,EAAE,KAAKvM,CAAC,CAACuC,KAJT,IAKAgK,EAAE,KAAKvM,CAAC,CAACqC,EALT,IAMAkK,EAAE,KAAKvM,CAAC,CAACgD,EANT,IAOAuJ,EAAE,KAAKvM,CAAC,CAACiD,EARb,EASE;IACE,IAAIkQ,CAAC,CAACrJ,YAAF,CAAe6V,eAAf,CAA+BpT,EAA/B,CAAJ,EAAwC;MACpC4G,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC+R,MAAvC;;MACAoB,CAAC,CAACjK,mBAAF;;MACAiK,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;IACH;EACJ,CAfD,MAeO;IACHlE,cAAc,CAAC0M,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ,C,CAED;AACA;;;AACA,SAAS/D,kBAAT,CAA4BuM,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IACI3B,EAAE,KAAKvM,CAAC,CAAC2V,IAAT,IACApJ,EAAE,KAAKvM,CAAC,CAAC4V,QADT,IAEArJ,EAAE,KAAKvM,CAAC,CAAC6V,OAFT,IAGAtJ,EAAE,KAAKvM,CAAC,CAAC8V,IAHT,IAIAvJ,EAAE,KAAKvM,CAAC,CAAC+V,IAJT,IAKAxJ,EAAE,KAAKvM,CAAC,CAAC+M,QALT,IAMAR,EAAE,KAAKvM,CAAC,CAACkN,MANT,IAOAX,EAAE,KAAKvM,CAAC,CAAC2M,KAPT,IAQAJ,EAAE,KAAKvM,CAAC,CAAC4I,QART,IASA2D,EAAE,KAAKvM,CAAC,CAACwM,KAVb,EAWE;IACEhI,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAbD,MAaO;IACH,MAAMkH,gBAAgB,GAAG/O,kCAAkC,CAACyJ,EAAD,CAAlC,IAA0CpL,YAAnE;;IAEAgS,CAAC,CAACf,qBAAF;;IACAe,CAAC,CAACpK,sBAAF,CAAyB8I,gBAAzB;;IACAsB,CAAC,CAACzJ,aAAF,GAAkBmI,gBAAlB;;IACAsB,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH;AACJ;;AAED,SAAS9D,gBAAT,CAA0BsM,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAAC4I,QAAxB,EAAkC;IAC9BnE,YAAY,CAAC0O,CAAD,EAAIxI,KAAJ,CAAZ;EACH;AACJ;;AAED,SAAS7D,aAAT,CAAuBqM,CAAvB,EAA0BxI,KAA1B,EAAiC;EAC7B,IAAIwI,CAAC,CAACrJ,YAAF,CAAeoM,SAAf,GAA2B,CAA/B,EAAkC;IAC9B/C,CAAC,CAACrJ,YAAF,CAAe4H,qBAAf,CAAqC1R,CAAC,CAAC4I,QAAvC;IACAuK,CAAC,CAACpJ,wBAAF,CAA2BuH,iBAA3B;;IACA6B,CAAC,CAACf,qBAAF;;IACAe,CAAC,CAACjK,mBAAF;;IACAiK,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH,CAND,MAMO;IACHwI,CAAC,CAAC1J,OAAF,GAAY,IAAZ;EACH;AACJ,C,CAED;AACA;;;AACA,SAASxC,iBAAT,CAA2BkM,CAA3B,EAA8BxI,KAA9B,EAAqC;EACjC,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAACD,IAAxB,EAA8B;IAC1BmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO;IACH5D,cAAc,CAACoM,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAASzD,eAAT,CAAyBiM,CAAzB,EAA4BxI,KAA5B,EAAmC;EAC/B,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAACD,IAAxB,EAA8B;IAC1B,IAAI,CAACoT,CAAC,CAACzK,eAAP,EAAwB;MACpByK,CAAC,CAACzJ,aAAF,GAAkBxH,qBAAlB;IACH;EACJ,CAJD,MAIO;IACH6E,cAAc,CAACoM,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAAS5D,cAAT,CAAwBoM,CAAxB,EAA2BxI,KAA3B,EAAkC;EAC9BwI,CAAC,CAACzJ,aAAF,GAAkBvI,YAAlB;;EACAgS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAASvD,kBAAT,CAA4B+L,CAA5B,EAA+BxI,KAA/B,EAAsC;EAClC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC6C,QAAb,EAAuB;IAC1BsQ,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;EACH,CAFM,MAEA,IAAIwM,EAAE,KAAKvM,CAAC,CAAC6c,KAAb,EAAoB;IACvB1J,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwBzK,EAAE,CAACH,IAA3B;;IACA4K,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;EACH,CAHM,MAGA,IAAI/D,EAAE,KAAKvM,CAAC,CAAC+M,QAAb,EAAuB;IAC1BvI,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAAStD,gBAAT,CAA0B8L,CAA1B,EAA6BxI,KAA7B,EAAoC;EAChC,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAAC6C,QAApB,IAAgC,CAACsQ,CAAC,CAACrJ,YAAF,CAAeuW,wBAAf,EAArC,EAAgF;IAC5ElN,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;;IAEA,IAAI,CAACc,CAAC,CAACzK,eAAH,IAAsByK,CAAC,CAACrJ,YAAF,CAAesM,cAAf,KAAkCpW,CAAC,CAAC6C,QAA9D,EAAwE;MACpEsQ,CAAC,CAACzJ,aAAF,GAAkBzH,mBAAlB;IACH;EACJ;AACJ,C,CAED;AACA;;;AACA,SAASqF,qBAAT,CAA+B6L,CAA/B,EAAkCxI,KAAlC,EAAyC;EACrC,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+M,QAAb,EAAuB;IAC1BvI,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ;;AAED,SAASpD,mBAAT,CAA6B4L,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnC,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAACD,IAAxB,EAA8B;IAC1BoT,CAAC,CAACzJ,aAAF,GAAkBvH,yBAAlB;EACH;AACJ,C,CAED;AACA;;;AACA,SAASuF,sBAAT,CAAgCyL,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtC,IAAIA,KAAK,CAACuD,OAAN,KAAkBlO,CAAC,CAACD,IAAxB,EAA8B;IAC1BmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO;IACHnD,mBAAmB,CAAC2L,CAAD,EAAIxI,KAAJ,CAAnB;EACH;AACJ;;AAED,SAASnD,mBAAT,CAA6B2L,CAA7B,EAAgCxI,KAAhC,EAAuC;EACnCwI,CAAC,CAACzJ,aAAF,GAAkBvI,YAAlB;;EACAgS,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;AACH,C,CAED;AACA;;;AACA,SAAShD,0BAAT,CAAoCwL,CAApC,EAAuCxI,KAAvC,EAA8C;EAC1C,MAAM4B,EAAE,GAAG5B,KAAK,CAACuD,OAAjB;;EAEA,IAAI3B,EAAE,KAAKvM,CAAC,CAACD,IAAb,EAAmB;IACfmF,cAAc,CAACiO,CAAD,EAAIxI,KAAJ,CAAd;EACH,CAFD,MAEO,IAAI4B,EAAE,KAAKvM,CAAC,CAAC+M,QAAb,EAAuB;IAC1BvI,cAAc,CAAC2O,CAAD,EAAIxI,KAAJ,CAAd;EACH;AACJ,C,CAED;AACA;;;AACA,SAASuF,6BAAT,CAAuCiD,CAAvC,EAA0CxI,KAA1C,EAAiD;EAC7CA,KAAK,CAACI,KAAN,GAAcjL,OAAO,CAACwgB,qBAAtB;;EACAnN,CAAC,CAACrE,iBAAF,CAAoBnE,KAApB;AACH;;AAED,SAASsF,yBAAT,CAAmCkD,CAAnC,EAAsCxI,KAAtC,EAA6C;EACzCwI,CAAC,CAACrE,iBAAF,CAAoBnE,KAApB;;EACAwI,CAAC,CAAC9I,UAAF,GAAe,KAAf;AACH;;AAED,SAAS8F,wBAAT,CAAkCgD,CAAlC,EAAqCxI,KAArC,EAA4C;EACxC,IAAI/K,cAAc,CAAC2gB,UAAf,CAA0B5V,KAA1B,KAAoC,CAACwI,CAAC,CAACzK,eAA3C,EAA4D;IACxD,OACIyK,CAAC,CAAC1S,WAAF,CAAcgL,eAAd,CAA8B0H,CAAC,CAACrJ,YAAF,CAAewB,OAA7C,MAA0DpL,EAAE,CAACH,IAA7D,IACA,CAACoT,CAAC,CAACzH,mBAAF,CAAsByH,CAAC,CAACrJ,YAAF,CAAewB,OAArC,CAFL,EAGE;MACE6H,CAAC,CAACrJ,YAAF,CAAeuI,GAAf;IACH;;IAEDc,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;EACH,CATD,MASO;IACH,MAAMW,OAAO,GAAG6H,CAAC,CAAC5H,0BAAF,EAAhB;;IACA,MAAMiV,SAAS,GAAGrN,CAAC,CAAC1S,WAAF,CAAcgL,eAAd,CAA8BH,OAA9B,CAAlB;;IAEA,IAAIkV,SAAS,KAAKtgB,EAAE,CAACsP,MAArB,EAA6B;MACzB5P,cAAc,CAAC6a,sBAAf,CAAsC9P,KAAtC;IACH,CAFD,MAEO,IAAI6V,SAAS,KAAKtgB,EAAE,CAACuP,GAArB,EAA0B;MAC7B7P,cAAc,CAAC6gB,qBAAf,CAAqC9V,KAArC;MACA/K,cAAc,CAACgb,mBAAf,CAAmCjQ,KAAnC;IACH;;IAED/K,cAAc,CAAC8a,mBAAf,CAAmC/P,KAAnC;;IAEA,IAAIA,KAAK,CAAC0F,WAAV,EAAuB;MACnB8C,CAAC,CAACnF,cAAF,CAAiBrD,KAAjB,EAAwB6V,SAAxB;IACH,CAFD,MAEO;MACHrN,CAAC,CAACrH,cAAF,CAAiBnB,KAAjB,EAAwB6V,SAAxB;IACH;;IAED7V,KAAK,CAAC2F,cAAN,GAAuB,IAAvB;EACH;AACJ;;AAED,SAASF,sBAAT,CAAgC+C,CAAhC,EAAmCxI,KAAnC,EAA0C;EACtC,KAAK,IAAIuG,CAAC,GAAGiC,CAAC,CAACrJ,YAAF,CAAeqC,QAA5B,EAAsC+E,CAAC,GAAG,CAA1C,EAA6CA,CAAC,EAA9C,EAAkD;IAC9C,MAAMxD,OAAO,GAAGyF,CAAC,CAACrJ,YAAF,CAAe8H,KAAf,CAAqBV,CAArB,CAAhB;;IAEA,IAAIiC,CAAC,CAAC1S,WAAF,CAAcgL,eAAd,CAA8BiC,OAA9B,MAA2CxN,EAAE,CAACH,IAAlD,EAAwD;MACpDoT,CAAC,CAACrD,aAAF,CAAgBnF,KAAhB;;MACA;IACH;;IAED,IAAIwI,CAAC,CAAC1S,WAAF,CAAcqI,UAAd,CAAyB4E,OAAzB,EAAkC6L,WAAlC,OAAoD5O,KAAK,CAACuD,OAA9D,EAAuE;MACnEiF,CAAC,CAACrJ,YAAF,CAAe6J,qBAAf,CAAqCjG,OAArC;MACA;IACH;EACJ;AACJ"},"metadata":{},"sourceType":"script"}