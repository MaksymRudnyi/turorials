{"ast":null,"code":"var makeMiddleware = require('./lib/make-middleware');\n\nvar diskStorage = require('./storage/disk');\n\nvar memoryStorage = require('./storage/memory');\n\nvar MulterError = require('./lib/multer-error');\n\nfunction allowAll(req, file, cb) {\n  cb(null, true);\n}\n\nfunction Multer(options) {\n  if (options.storage) {\n    this.storage = options.storage;\n  } else if (options.dest) {\n    this.storage = diskStorage({\n      destination: options.dest\n    });\n  } else {\n    this.storage = memoryStorage();\n  }\n\n  this.limits = options.limits;\n  this.preservePath = options.preservePath;\n  this.fileFilter = options.fileFilter || allowAll;\n}\n\nMulter.prototype._makeMiddleware = function (fields, fileStrategy) {\n  function setup() {\n    var fileFilter = this.fileFilter;\n    var filesLeft = Object.create(null);\n    fields.forEach(function (field) {\n      if (typeof field.maxCount === 'number') {\n        filesLeft[field.name] = field.maxCount;\n      } else {\n        filesLeft[field.name] = Infinity;\n      }\n    });\n\n    function wrappedFileFilter(req, file, cb) {\n      if ((filesLeft[file.fieldname] || 0) <= 0) {\n        return cb(new MulterError('LIMIT_UNEXPECTED_FILE', file.fieldname));\n      }\n\n      filesLeft[file.fieldname] -= 1;\n      fileFilter(req, file, cb);\n    }\n\n    return {\n      limits: this.limits,\n      preservePath: this.preservePath,\n      storage: this.storage,\n      fileFilter: wrappedFileFilter,\n      fileStrategy: fileStrategy\n    };\n  }\n\n  return makeMiddleware(setup.bind(this));\n};\n\nMulter.prototype.single = function (name) {\n  return this._makeMiddleware([{\n    name: name,\n    maxCount: 1\n  }], 'VALUE');\n};\n\nMulter.prototype.array = function (name, maxCount) {\n  return this._makeMiddleware([{\n    name: name,\n    maxCount: maxCount\n  }], 'ARRAY');\n};\n\nMulter.prototype.fields = function (fields) {\n  return this._makeMiddleware(fields, 'OBJECT');\n};\n\nMulter.prototype.none = function () {\n  return this._makeMiddleware([], 'NONE');\n};\n\nMulter.prototype.any = function () {\n  function setup() {\n    return {\n      limits: this.limits,\n      preservePath: this.preservePath,\n      storage: this.storage,\n      fileFilter: this.fileFilter,\n      fileStrategy: 'ARRAY'\n    };\n  }\n\n  return makeMiddleware(setup.bind(this));\n};\n\nfunction multer(options) {\n  if (options === undefined) {\n    return new Multer({});\n  }\n\n  if (typeof options === 'object' && options !== null) {\n    return new Multer(options);\n  }\n\n  throw new TypeError('Expected object for argument options');\n}\n\nmodule.exports = multer;\nmodule.exports.diskStorage = diskStorage;\nmodule.exports.memoryStorage = memoryStorage;\nmodule.exports.MulterError = MulterError;","map":{"version":3,"names":["makeMiddleware","require","diskStorage","memoryStorage","MulterError","allowAll","req","file","cb","Multer","options","storage","dest","destination","limits","preservePath","fileFilter","prototype","_makeMiddleware","fields","fileStrategy","setup","filesLeft","Object","create","forEach","field","maxCount","name","Infinity","wrappedFileFilter","fieldname","bind","single","array","none","any","multer","undefined","TypeError","module","exports"],"sources":["C:/Users/apinto2/Desktop/teswordtomd/12 setembro/UPLOAD 9/turorials/server/node_modules/multer/index.js"],"sourcesContent":["var makeMiddleware = require('./lib/make-middleware')\n\nvar diskStorage = require('./storage/disk')\nvar memoryStorage = require('./storage/memory')\nvar MulterError = require('./lib/multer-error')\n\nfunction allowAll (req, file, cb) {\n  cb(null, true)\n}\n\nfunction Multer (options) {\n  if (options.storage) {\n    this.storage = options.storage\n  } else if (options.dest) {\n    this.storage = diskStorage({ destination: options.dest })\n  } else {\n    this.storage = memoryStorage()\n  }\n\n  this.limits = options.limits\n  this.preservePath = options.preservePath\n  this.fileFilter = options.fileFilter || allowAll\n}\n\nMulter.prototype._makeMiddleware = function (fields, fileStrategy) {\n  function setup () {\n    var fileFilter = this.fileFilter\n    var filesLeft = Object.create(null)\n\n    fields.forEach(function (field) {\n      if (typeof field.maxCount === 'number') {\n        filesLeft[field.name] = field.maxCount\n      } else {\n        filesLeft[field.name] = Infinity\n      }\n    })\n\n    function wrappedFileFilter (req, file, cb) {\n      if ((filesLeft[file.fieldname] || 0) <= 0) {\n        return cb(new MulterError('LIMIT_UNEXPECTED_FILE', file.fieldname))\n      }\n\n      filesLeft[file.fieldname] -= 1\n      fileFilter(req, file, cb)\n    }\n\n    return {\n      limits: this.limits,\n      preservePath: this.preservePath,\n      storage: this.storage,\n      fileFilter: wrappedFileFilter,\n      fileStrategy: fileStrategy\n    }\n  }\n\n  return makeMiddleware(setup.bind(this))\n}\n\nMulter.prototype.single = function (name) {\n  return this._makeMiddleware([{ name: name, maxCount: 1 }], 'VALUE')\n}\n\nMulter.prototype.array = function (name, maxCount) {\n  return this._makeMiddleware([{ name: name, maxCount: maxCount }], 'ARRAY')\n}\n\nMulter.prototype.fields = function (fields) {\n  return this._makeMiddleware(fields, 'OBJECT')\n}\n\nMulter.prototype.none = function () {\n  return this._makeMiddleware([], 'NONE')\n}\n\nMulter.prototype.any = function () {\n  function setup () {\n    return {\n      limits: this.limits,\n      preservePath: this.preservePath,\n      storage: this.storage,\n      fileFilter: this.fileFilter,\n      fileStrategy: 'ARRAY'\n    }\n  }\n\n  return makeMiddleware(setup.bind(this))\n}\n\nfunction multer (options) {\n  if (options === undefined) {\n    return new Multer({})\n  }\n\n  if (typeof options === 'object' && options !== null) {\n    return new Multer(options)\n  }\n\n  throw new TypeError('Expected object for argument options')\n}\n\nmodule.exports = multer\nmodule.exports.diskStorage = diskStorage\nmodule.exports.memoryStorage = memoryStorage\nmodule.exports.MulterError = MulterError\n"],"mappings":"AAAA,IAAIA,cAAc,GAAGC,OAAO,CAAC,uBAAD,CAA5B;;AAEA,IAAIC,WAAW,GAAGD,OAAO,CAAC,gBAAD,CAAzB;;AACA,IAAIE,aAAa,GAAGF,OAAO,CAAC,kBAAD,CAA3B;;AACA,IAAIG,WAAW,GAAGH,OAAO,CAAC,oBAAD,CAAzB;;AAEA,SAASI,QAAT,CAAmBC,GAAnB,EAAwBC,IAAxB,EAA8BC,EAA9B,EAAkC;EAChCA,EAAE,CAAC,IAAD,EAAO,IAAP,CAAF;AACD;;AAED,SAASC,MAAT,CAAiBC,OAAjB,EAA0B;EACxB,IAAIA,OAAO,CAACC,OAAZ,EAAqB;IACnB,KAAKA,OAAL,GAAeD,OAAO,CAACC,OAAvB;EACD,CAFD,MAEO,IAAID,OAAO,CAACE,IAAZ,EAAkB;IACvB,KAAKD,OAAL,GAAeT,WAAW,CAAC;MAAEW,WAAW,EAAEH,OAAO,CAACE;IAAvB,CAAD,CAA1B;EACD,CAFM,MAEA;IACL,KAAKD,OAAL,GAAeR,aAAa,EAA5B;EACD;;EAED,KAAKW,MAAL,GAAcJ,OAAO,CAACI,MAAtB;EACA,KAAKC,YAAL,GAAoBL,OAAO,CAACK,YAA5B;EACA,KAAKC,UAAL,GAAkBN,OAAO,CAACM,UAAR,IAAsBX,QAAxC;AACD;;AAEDI,MAAM,CAACQ,SAAP,CAAiBC,eAAjB,GAAmC,UAAUC,MAAV,EAAkBC,YAAlB,EAAgC;EACjE,SAASC,KAAT,GAAkB;IAChB,IAAIL,UAAU,GAAG,KAAKA,UAAtB;IACA,IAAIM,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAc,IAAd,CAAhB;IAEAL,MAAM,CAACM,OAAP,CAAe,UAAUC,KAAV,EAAiB;MAC9B,IAAI,OAAOA,KAAK,CAACC,QAAb,KAA0B,QAA9B,EAAwC;QACtCL,SAAS,CAACI,KAAK,CAACE,IAAP,CAAT,GAAwBF,KAAK,CAACC,QAA9B;MACD,CAFD,MAEO;QACLL,SAAS,CAACI,KAAK,CAACE,IAAP,CAAT,GAAwBC,QAAxB;MACD;IACF,CAND;;IAQA,SAASC,iBAAT,CAA4BxB,GAA5B,EAAiCC,IAAjC,EAAuCC,EAAvC,EAA2C;MACzC,IAAI,CAACc,SAAS,CAACf,IAAI,CAACwB,SAAN,CAAT,IAA6B,CAA9B,KAAoC,CAAxC,EAA2C;QACzC,OAAOvB,EAAE,CAAC,IAAIJ,WAAJ,CAAgB,uBAAhB,EAAyCG,IAAI,CAACwB,SAA9C,CAAD,CAAT;MACD;;MAEDT,SAAS,CAACf,IAAI,CAACwB,SAAN,CAAT,IAA6B,CAA7B;MACAf,UAAU,CAACV,GAAD,EAAMC,IAAN,EAAYC,EAAZ,CAAV;IACD;;IAED,OAAO;MACLM,MAAM,EAAE,KAAKA,MADR;MAELC,YAAY,EAAE,KAAKA,YAFd;MAGLJ,OAAO,EAAE,KAAKA,OAHT;MAILK,UAAU,EAAEc,iBAJP;MAKLV,YAAY,EAAEA;IALT,CAAP;EAOD;;EAED,OAAOpB,cAAc,CAACqB,KAAK,CAACW,IAAN,CAAW,IAAX,CAAD,CAArB;AACD,CAhCD;;AAkCAvB,MAAM,CAACQ,SAAP,CAAiBgB,MAAjB,GAA0B,UAAUL,IAAV,EAAgB;EACxC,OAAO,KAAKV,eAAL,CAAqB,CAAC;IAAEU,IAAI,EAAEA,IAAR;IAAcD,QAAQ,EAAE;EAAxB,CAAD,CAArB,EAAoD,OAApD,CAAP;AACD,CAFD;;AAIAlB,MAAM,CAACQ,SAAP,CAAiBiB,KAAjB,GAAyB,UAAUN,IAAV,EAAgBD,QAAhB,EAA0B;EACjD,OAAO,KAAKT,eAAL,CAAqB,CAAC;IAAEU,IAAI,EAAEA,IAAR;IAAcD,QAAQ,EAAEA;EAAxB,CAAD,CAArB,EAA2D,OAA3D,CAAP;AACD,CAFD;;AAIAlB,MAAM,CAACQ,SAAP,CAAiBE,MAAjB,GAA0B,UAAUA,MAAV,EAAkB;EAC1C,OAAO,KAAKD,eAAL,CAAqBC,MAArB,EAA6B,QAA7B,CAAP;AACD,CAFD;;AAIAV,MAAM,CAACQ,SAAP,CAAiBkB,IAAjB,GAAwB,YAAY;EAClC,OAAO,KAAKjB,eAAL,CAAqB,EAArB,EAAyB,MAAzB,CAAP;AACD,CAFD;;AAIAT,MAAM,CAACQ,SAAP,CAAiBmB,GAAjB,GAAuB,YAAY;EACjC,SAASf,KAAT,GAAkB;IAChB,OAAO;MACLP,MAAM,EAAE,KAAKA,MADR;MAELC,YAAY,EAAE,KAAKA,YAFd;MAGLJ,OAAO,EAAE,KAAKA,OAHT;MAILK,UAAU,EAAE,KAAKA,UAJZ;MAKLI,YAAY,EAAE;IALT,CAAP;EAOD;;EAED,OAAOpB,cAAc,CAACqB,KAAK,CAACW,IAAN,CAAW,IAAX,CAAD,CAArB;AACD,CAZD;;AAcA,SAASK,MAAT,CAAiB3B,OAAjB,EAA0B;EACxB,IAAIA,OAAO,KAAK4B,SAAhB,EAA2B;IACzB,OAAO,IAAI7B,MAAJ,CAAW,EAAX,CAAP;EACD;;EAED,IAAI,OAAOC,OAAP,KAAmB,QAAnB,IAA+BA,OAAO,KAAK,IAA/C,EAAqD;IACnD,OAAO,IAAID,MAAJ,CAAWC,OAAX,CAAP;EACD;;EAED,MAAM,IAAI6B,SAAJ,CAAc,sCAAd,CAAN;AACD;;AAEDC,MAAM,CAACC,OAAP,GAAiBJ,MAAjB;AACAG,MAAM,CAACC,OAAP,CAAevC,WAAf,GAA6BA,WAA7B;AACAsC,MAAM,CAACC,OAAP,CAAetC,aAAf,GAA+BA,aAA/B;AACAqC,MAAM,CAACC,OAAP,CAAerC,WAAf,GAA6BA,WAA7B"},"metadata":{},"sourceType":"script"}