{"ast":null,"code":"var bn = require('bn.js');\n\nvar brorand = require('brorand');\n\nfunction MillerRabin(rand) {\n  this.rand = rand || new brorand.Rand();\n}\n\nmodule.exports = MillerRabin;\n\nMillerRabin.create = function create(rand) {\n  return new MillerRabin(rand);\n};\n\nMillerRabin.prototype._randbelow = function _randbelow(n) {\n  var len = n.bitLength();\n  var min_bytes = Math.ceil(len / 8); // Generage random bytes until a number less than n is found.\n  // This ensures that 0..n-1 have an equal probability of being selected.\n\n  do var a = new bn(this.rand.generate(min_bytes)); while (a.cmp(n) >= 0);\n\n  return a;\n};\n\nMillerRabin.prototype._randrange = function _randrange(start, stop) {\n  // Generate a random number greater than or equal to start and less than stop.\n  var size = stop.sub(start);\n  return start.add(this._randbelow(size));\n};\n\nMillerRabin.prototype.test = function test(n, k, cb) {\n  var len = n.bitLength();\n  var red = bn.mont(n);\n  var rone = new bn(1).toRed(red);\n  if (!k) k = Math.max(1, len / 48 | 0); // Find d and s, (n - 1) = (2 ^ s) * d;\n\n  var n1 = n.subn(1);\n\n  for (var s = 0; !n1.testn(s); s++) {}\n\n  var d = n.shrn(s);\n  var rn1 = n1.toRed(red);\n  var prime = true;\n\n  for (; k > 0; k--) {\n    var a = this._randrange(new bn(2), n1);\n\n    if (cb) cb(a);\n    var x = a.toRed(red).redPow(d);\n    if (x.cmp(rone) === 0 || x.cmp(rn1) === 0) continue;\n\n    for (var i = 1; i < s; i++) {\n      x = x.redSqr();\n      if (x.cmp(rone) === 0) return false;\n      if (x.cmp(rn1) === 0) break;\n    }\n\n    if (i === s) return false;\n  }\n\n  return prime;\n};\n\nMillerRabin.prototype.getDivisor = function getDivisor(n, k) {\n  var len = n.bitLength();\n  var red = bn.mont(n);\n  var rone = new bn(1).toRed(red);\n  if (!k) k = Math.max(1, len / 48 | 0); // Find d and s, (n - 1) = (2 ^ s) * d;\n\n  var n1 = n.subn(1);\n\n  for (var s = 0; !n1.testn(s); s++) {}\n\n  var d = n.shrn(s);\n  var rn1 = n1.toRed(red);\n\n  for (; k > 0; k--) {\n    var a = this._randrange(new bn(2), n1);\n\n    var g = n.gcd(a);\n    if (g.cmpn(1) !== 0) return g;\n    var x = a.toRed(red).redPow(d);\n    if (x.cmp(rone) === 0 || x.cmp(rn1) === 0) continue;\n\n    for (var i = 1; i < s; i++) {\n      x = x.redSqr();\n      if (x.cmp(rone) === 0) return x.fromRed().subn(1).gcd(n);\n      if (x.cmp(rn1) === 0) break;\n    }\n\n    if (i === s) {\n      x = x.redSqr();\n      return x.fromRed().subn(1).gcd(n);\n    }\n  }\n\n  return false;\n};","map":{"version":3,"names":["bn","require","brorand","MillerRabin","rand","Rand","module","exports","create","prototype","_randbelow","n","len","bitLength","min_bytes","Math","ceil","a","generate","cmp","_randrange","start","stop","size","sub","add","test","k","cb","red","mont","rone","toRed","max","n1","subn","s","testn","d","shrn","rn1","prime","x","redPow","i","redSqr","getDivisor","g","gcd","cmpn","fromRed"],"sources":["C:/Users/apinto2/Desktop/teswordtomd/12 setembro/UPLOAD 9/turorials/client/node_modules/miller-rabin/lib/mr.js"],"sourcesContent":["var bn = require('bn.js');\nvar brorand = require('brorand');\n\nfunction MillerRabin(rand) {\n  this.rand = rand || new brorand.Rand();\n}\nmodule.exports = MillerRabin;\n\nMillerRabin.create = function create(rand) {\n  return new MillerRabin(rand);\n};\n\nMillerRabin.prototype._randbelow = function _randbelow(n) {\n  var len = n.bitLength();\n  var min_bytes = Math.ceil(len / 8);\n\n  // Generage random bytes until a number less than n is found.\n  // This ensures that 0..n-1 have an equal probability of being selected.\n  do\n    var a = new bn(this.rand.generate(min_bytes));\n  while (a.cmp(n) >= 0);\n\n  return a;\n};\n\nMillerRabin.prototype._randrange = function _randrange(start, stop) {\n  // Generate a random number greater than or equal to start and less than stop.\n  var size = stop.sub(start);\n  return start.add(this._randbelow(size));\n};\n\nMillerRabin.prototype.test = function test(n, k, cb) {\n  var len = n.bitLength();\n  var red = bn.mont(n);\n  var rone = new bn(1).toRed(red);\n\n  if (!k)\n    k = Math.max(1, (len / 48) | 0);\n\n  // Find d and s, (n - 1) = (2 ^ s) * d;\n  var n1 = n.subn(1);\n  for (var s = 0; !n1.testn(s); s++) {}\n  var d = n.shrn(s);\n\n  var rn1 = n1.toRed(red);\n\n  var prime = true;\n  for (; k > 0; k--) {\n    var a = this._randrange(new bn(2), n1);\n    if (cb)\n      cb(a);\n\n    var x = a.toRed(red).redPow(d);\n    if (x.cmp(rone) === 0 || x.cmp(rn1) === 0)\n      continue;\n\n    for (var i = 1; i < s; i++) {\n      x = x.redSqr();\n\n      if (x.cmp(rone) === 0)\n        return false;\n      if (x.cmp(rn1) === 0)\n        break;\n    }\n\n    if (i === s)\n      return false;\n  }\n\n  return prime;\n};\n\nMillerRabin.prototype.getDivisor = function getDivisor(n, k) {\n  var len = n.bitLength();\n  var red = bn.mont(n);\n  var rone = new bn(1).toRed(red);\n\n  if (!k)\n    k = Math.max(1, (len / 48) | 0);\n\n  // Find d and s, (n - 1) = (2 ^ s) * d;\n  var n1 = n.subn(1);\n  for (var s = 0; !n1.testn(s); s++) {}\n  var d = n.shrn(s);\n\n  var rn1 = n1.toRed(red);\n\n  for (; k > 0; k--) {\n    var a = this._randrange(new bn(2), n1);\n\n    var g = n.gcd(a);\n    if (g.cmpn(1) !== 0)\n      return g;\n\n    var x = a.toRed(red).redPow(d);\n    if (x.cmp(rone) === 0 || x.cmp(rn1) === 0)\n      continue;\n\n    for (var i = 1; i < s; i++) {\n      x = x.redSqr();\n\n      if (x.cmp(rone) === 0)\n        return x.fromRed().subn(1).gcd(n);\n      if (x.cmp(rn1) === 0)\n        break;\n    }\n\n    if (i === s) {\n      x = x.redSqr();\n      return x.fromRed().subn(1).gcd(n);\n    }\n  }\n\n  return false;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}